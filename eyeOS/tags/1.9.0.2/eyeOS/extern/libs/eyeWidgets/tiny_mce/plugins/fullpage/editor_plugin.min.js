(function(){tinymce.create("tinymce.plugins.FullPagePlugin",{init:function(a,c){var b=this;b.editor=a;a.addCommand("mceFullPageProperties",function(){a.windowManager.open({file:c+"/fullpage.htm",width:430+parseInt(a.getLang("fullpage.delta_width",0)),height:495+parseInt(a.getLang("fullpage.delta_height",0)),inline:1},{plugin_url:c,head_html:b.head})});a.addButton("fullpage",{title:"fullpage.desc",cmd:"mceFullPageProperties"});a.onBeforeSetContent.add(b._setContent,b);a.onSetContent.add(b._setBodyAttribs,
b);a.onGetContent.add(b._getContent,b)},getInfo:function(){return{longname:"Fullpage",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/fullpage",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_setBodyAttribs:function(a){var c,b,e,d,f;if((c=this.head.match(/body(.*?)>/i))&&c[1])if(c=c[1].match(/\s*(\w+\s*=\s*".*?"|\w+\s*=\s*'.*?'|\w+\s*=\s*\w+|\w+)\s*/g)){b=0;for(e=c.length;b<e;b++){d=c[b].split("=");f=d[0].replace(/\s/,
"");if(d=d[1]){d=d.replace(/^\s+/,"").replace(/\s+$/,"");if(f=d.match(/^["'](.*)["']$/))d=f[1]}else d=f;a.dom.setAttrib(a.getBody(),"style",d)}}},_createSerializer:function(){return new tinymce.dom.Serializer({dom:this.editor.dom,apply_source_formatting:true})},_setContent:function(a,c){var b=this,e,d=c.content,f="";if(!(c.source_view&&a.getParam("fullpage_hide_in_source_view"))){d=d.replace(/<(\/?)BODY/gi,"<$1body");e=d.indexOf("<body");if(e!=-1){e=d.indexOf(">",e);b.head=d.substring(0,e+1);a=d.indexOf("</body",
e);if(a==-1)a=d.indexOf("</body",a);c.content=d.substring(e+1,a);b.foot=d.substring(a);function g(h){return h.replace(/<\/?[A-Z]+/g,function(i){return i.toLowerCase()})}b.head=g(b.head);b.foot=g(b.foot)}else{b.head="";if(a.getParam("fullpage_default_xml_pi"))b.head+='<?xml version="1.0" encoding="'+a.getParam("fullpage_default_encoding","ISO-8859-1")+'" ?>\n';b.head+=a.getParam("fullpage_default_doctype",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');
b.head+="\n<html>\n<head>\n<title>"+a.getParam("fullpage_default_title","Untitled document")+"</title>\n";if(c=a.getParam("fullpage_default_encoding"))b.head+='<meta http-equiv="Content-Type" content="'+c+'" />\n';if(c=a.getParam("fullpage_default_font_family"))f+="font-family: "+c+";";if(c=a.getParam("fullpage_default_font_size"))f+="font-size: "+c+";";if(c=a.getParam("fullpage_default_text_color"))f+="color: "+c+";";b.head+="</head>\n<body"+(f?' style="'+f+'"':"")+">\n";b.foot="\n</body>\n</html>"}}},
_getContent:function(a,c){var b=this;if(!c.source_view||!a.getParam("fullpage_hide_in_source_view"))c.content=tinymce.trim(b.head)+"\n"+tinymce.trim(c.content)+"\n"+tinymce.trim(b.foot)}});tinymce.PluginManager.add("fullpage",tinymce.plugins.FullPagePlugin)})();
