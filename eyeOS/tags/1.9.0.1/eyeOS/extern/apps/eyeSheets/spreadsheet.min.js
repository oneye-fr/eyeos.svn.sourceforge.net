var myPid=$myPid,myChecknum=$checknum,EXTERN_CACHE_VERSION=$EXTERN_CACHE_VERSION,agent=navigator.userAgent.toLowerCase();if(agent.indexOf("konqueror")!=-1)agent="konqueror";else if(agent.indexOf("safari")!=-1)agent="safari";else if(agent.indexOf("opera")!=-1)agent="opera";else if(agent.indexOf("firefox")!=-1)agent="firefox";else if(agent.indexOf("msie")!=-1)agent="msie";window.onerror=handleErr;if(agent=="msie"||agent=="safari")document.onkeydown=keypress;else document.onkeypress=keypress;
var init_data="",auto_recalc=true,cols=13,rows=30,row0=0,col0=0,col_min_width="90px",cells=[],marks=[],view="values",currRow=0,currCol=0,multiRange=[],clipboard_row=0,clipboard_col=0,clipboard_range=[],clipboard_mode="",active="",showColumnGroups=false,allowPaging=true,registerFuncs="",isMouseDown=0,isShiftDown=0,sgs_folder=0,sgs_view="",saveMethod="save('js')",closeMethod="",isWriteable=true,tab=String.fromCharCode(9),printstyle="index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=css/apps/eyeSheets/print.css";
function trans(a){return strings[a]?strings[a]:"["+a+"]"}
function keypress(a){if(!getObj("value")||active=="code")return true;a=a?a:window.event;var b=getmykey(a),c=true;if(active=="position"){if(b==13){gotoCell(getObj("field").value);active="content";c=false}return c}if(active=="dimensions"){if(b==13){rows=parseInt(getObj("rows").value);cols=parseInt(getObj("cols").value);active="content";display();c=false}return c}if(getObj("styling").disabled){getObj("focus").focus();active="content";var d=a.shiftKey,e=a.altKey;if((a=a.ctrlKey)&&(b==88||b==120)||d&&
b==46){cutcopy("cut","#FFDDDD");c=false}else if(a&&(b==67||b==99)||a&&b==45){cutcopy("copy","#DDDDFF");c=false}else if((a&&(b==86||b==118)||d&&b==45)&&clipboard_mode!=""){paste();c=false}if(d&&!isShiftDown){highlightRange(multiRange,"cell");multiRange=new Array(currRow,currCol,currRow,currCol);isShiftDown=1}else if(!e&&!a&&!d&&multiRange.length>0&&b!=46){highlightRange(multiRange,"cell");multiRange=[];isMouseDown=isShiftDown=0}if(!e&&!a&&b!=0)if(b==33){if(currRow-10<=row0&&currRow>10){row0-=rows;
display();mouseoverCell(currRow-10,currCol);scrollDown()}else{mouseoverCell(currRow>=10?currRow-10:0,currCol);scrollUp()}c=false}else if(b==34){if(currRow+10>=row0+rows){row0+=rows;display();mouseoverCell(currRow+10,currCol);scrollUp()}else{mouseoverCell(currRow+10,currCol);scrollDown()}c=false}else if(b==36){if(currCol!=col0)mouseoverCell(currRow,col0);else if(currCol+1>=cols){col0-=cols;display();mouseoverCell(currRow,currCol-cols)}else if(currRow>row0)mouseoverCell(row0,currCol);else if(currRow+
1>rows){row0-=rows;display();mouseoverCell(currRow-rows,currCol)}scrollLeft();c=false}else if(b==35){if(currCol!=col0+cols-1)mouseoverCell(currRow,col0+cols-1);else{col0+=cols;display();mouseoverCell(currRow,currCol+cols)}scrollRight();c=false}else if(b==39||b==9){goRight();c=false}else if(b==40){goDown();c=false}else if(b==38&&currRow>-2){goUp();c=false}else if(b==37&&currCol>-1){goLeft();c=false}else if(!d&&b==46&&isWriteable&&confirm(trans("Really empty cell(s) ?"))){removeSelectedCell();c=false}else if((b<
33||b>40)&&b!=46&&b!=45&&b!=16&&b!=17&&b!=18){editCell(currRow,currCol,b);if(b==13)c=false}if(isShiftDown){highlightRange(multiRange,"cell");multiRange[2]=currRow;multiRange[3]=currCol;highlightRange(multiRange,"cell_highlight_over")}}else if(b==13){saveCell();c=false}else if(b==27){cancelCell();c=false}return c}function goLeft(){if(currCol<=col0&&currCol>0){col0-=cols;display();mouseoverCell(currRow,currCol-1);scrollRight()}else{mouseoverCell(currRow,currCol-1);scrollLeft()}}
function goUp(){if(currRow<=row0&&currRow>0){row0-=rows;display();mouseoverCell(currRow-1,currCol);scrollDown()}else{mouseoverCell(currRow-1,currCol);scrollUp()}}function goRight(){if(currCol+1>=col0+cols){col0+=cols;display();mouseoverCell(currRow,currCol+1);scrollLeft()}else{mouseoverCell(currRow,currCol+1);scrollRight()}}function goDown(){if(currRow+1>=row0+rows){row0+=rows;display();mouseoverCell(currRow+1,currCol);scrollUp()}else{mouseoverCell(currRow+1,currCol);scrollDown()}}
function display(){marks=[];var a=isMouseDown=0,b=0;if(getObj("content")){a=getObj("content").scrollLeft;b=getObj("content").scrollTop}var c="";if(isWriteable){c+='<div class="blockbar">';c+='<div class="blockbarItem" onclick="load(init_data); resetPath();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filenew.png" /><div class="blockbarText">'+trans("New")+"</div></div>";c+='<div class="blockbarItem" onclick="loadCode();" ><img class="blockbarImg" src="index.php?version='+
EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/fileopen.png" /><div class="blockbarText">'+trans("Open")+"</div></div>";c+='<div class="blockbarItem" onclick="saveCode();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filesave.png" /><div class="blockbarText">'+trans("Save")+"</div></div>";c+='<div class="blockbarItem" onclick="saveAs();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filesaveas.png" /><div class="blockbarText">'+
trans("Save As")+"</div></div>";c+='<span class="blockbarline" /></span>';c+='<div class="blockbarItem" onclick="insertRow();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/newrow.png" /><div class="blockbarText">'+trans("Ins. Row")+"</div></div>";c+='<div class="blockbarItem" onclick="insertColumn();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/newcolumn.png" /><div class="blockbarText">'+
trans("Ins. Column")+"</div></div>";c+='<div class="blockbarItem" onclick="deleteRow();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/deleterow.png" /><div class="blockbarText">'+trans("Del. Row")+"</div></div>";c+='<div class="blockbarItem" onclick="deleteColumn();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/deletecolumn.png" /><div class="blockbarText">'+trans("Del. Column")+"</div></div>";
c+='<span class="blockbarline" /></span>';c+='<div class="blockbarItem" onclick="print();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/agt_print.png" /><div class="blockbarText">'+trans("Print")+"</div></div>";c+='<div class="blockbarItem_right" onclick="help();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/help.png" /><div class="blockbarText">'+trans("Help")+"</div></div>";c+='<div class="blockbarItem_right" onclick="fullScreen();" ><img class="blockbarImg" src="index.php?version='+
EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/fullScreen.png" /><div class="blockbarText">'+trans("Full Screen")+"</div></div>";c+="</div>"}c+="<textarea id='focus' onfocus='this.blur();'></textarea><div id='header' class='header'><table cellpadding='0' cellspacing='0' style='width:100%;'><tr><td nowrap>";c+="<input type='text' value='' title='"+trans("Position")+"' id='field' style='width:30px; text-align:center;' onfocus='active=\"position\";' onblur='active=\"content\";' accesskey='g'> &nbsp;";
c+="</td><td nowrap style='width:100%;'>";c+="<iframe src='about:blank' id='multiline'></iframe>";c+="<input type='text' value='' title='"+trans("Formula")+"' id='value' style='width:100%;' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ";c+="<input type='hidden' title='"+trans("Style")+"' value='' id='styling' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ";c+="</td><td nowrap>";if(isWriteable){c+="&nbsp; <input type='button' value='"+trans("Save")+"' id='save' onclick='saveCell();' disabled>&nbsp;";
c+="<input type='button' value='"+trans("X")+"' id='cancel' onclick='cancelCell();' disabled>"}c+="</td></tr></table></div>";var d="";if(agent=="msie")d="style='height:expression((document.body.clientHeight-40)+\"px\");'";c+="<div id='content' "+d+"><table id='table' cellspacing='0'>";c+="<tr>";if(showColumnGroups){c+="<th id='-2_-1' ondblclick='editCell(-2,-1);' onclick='mouseoverCell(-2,-1);'>"+htmlEscape(showCell(-2,-1,0),true)+"</th>";for(var e=col0;e<cols+col0;e++)if((d=showCell(-2,e,0))&&(!marks[-2]||
!marks[-2][e])){var f=getCellStyle(-2,e,"colspan");if(f){marks[-2]||(marks[-2]=[]);for(var h=e+1;h<e+f;h++)marks[-2][h]=new Array(-2,e)}c+="<th id='-2_"+e+"' ondblclick='editCell(-2,"+e+",0);' onclick='mouseoverCell(-2,"+e+");' colspan='"+f+"'><div style='"+htmlEscape(formatStyle(getCells(-2,e,1),"_"),false)+"'>"+htmlEscape(d,true)+"</div></th>"}else if(!marks[-2]||!marks[-2][e])c+="<th id='-2_"+e+"' ondblclick='editCell(-2,"+e+",0);' onclick='mouseoverCell(-2,"+e+");'>&nbsp;</th>"}c+="</tr>";c+=
"<tr><th id='-1_-1' ondblclick='editCell(-1,-1,0);' onclick='mouseoverCell(-1,-1);'>"+htmlEscape(showCell(-1,-1,0),true)+"</th>";for(e=col0;e<cols+col0;e++){f=showCell(-1,e,0);c+="<th id='-1_"+e+"' ondblclick='editCell(-1,"+e+",0);' onclick='mouseoverCell(-1,"+e+");'><div style='"+htmlEscape(formatStyle(getCells(-1,e,1),"_"),false)+"'>"+(f?htmlEscape(f,true)+" - ":"")+buildColName(e)+"</div></th>"}c+="</tr>";for(e=row0;e<rows+row0;e++){c+="<tr>";f=showCell(e,-1,0);c+="<th id='"+e+"_-1' ondblclick='editCell("+
e+",-1,0);' onclick='mouseoverCell("+e+",-1);'><div style='"+htmlEscape(formatStyle(getCells(e,-1,1),"_"),false)+"'>"+(f?htmlEscape(f,true)+"<br>":"")+(e+1)+"</div></th>";for(var g=col0;g<cols+col0;g++)if(view=="values"){if(!marks[e]||!marks[e][g]){d=getCells(e,g,1);var j=showCell(e,g,0);if(f=getCellStyle(e,g,"colspan")){marks[e]||(marks[e]=[]);for(h=g+1;h<g+f;h++)marks[e][h]=new Array(e,g)}var k=getCellStyle(e,g,"rowspan");if(k)for(h=e+1;h<e+k;h++){marks[h]||(marks[h]=[]);marks[h][g]=new Array(e,
g)}j=formatValue(j,d);d=htmlEscape(formatStyle(d,j),false);c+="<td "+(k?"rowspan='"+k+"'":"")+" "+(f?"colspan='"+f+"'":"")+" id='"+e+"_"+g+"' onmousedown='mousedown("+e+","+g+");' onmouseup='mouseup();' onmouseover='buildStatus("+e+","+g+");' onclick='mouseoverCell("+e+","+g+");' onclick='mouseoverCell("+e+","+g+");' ondblclick='editCell("+e+","+g+",0);'><div style='"+d+"'>"+htmlEscape(j,true)+"</div></td>"}}else c+=view=="formulas"?"<td id='"+e+"_"+g+"' onmouseover='buildStatus("+e+","+g+");' onclick='mouseoverCell("+
e+","+g+");' onclick='mouseoverCell("+e+","+g+");' ondblclick='editCell("+e+","+g+",0);'>"+htmlEscape(getCells(e,g,0),true)+"</td>":"<td id='"+e+"_"+g+"' onmouseover='buildStatus("+e+","+g+");' onclick='mouseoverCell("+e+","+g+");' onclick='mouseoverCell("+e+","+g+");' ondblclick='editCell("+e+","+g+",0);'>"+htmlEscape(getCells(e,g,1),true)+"</td>";c+="</tr>"}c+="<tr id='spacer'><th class='empty'></th>";for(e=col0;e<cols+col0;e++)c+="<th class='empty'><img src='' style='width:"+col_min_width+"; height:0px;'></th>";
c+="</tr>";c+="</table></div>";c+="<div class='footer' id='footer' onmouseover='getObj(\"status\").innerHTML=\"\";'>&nbsp;";if(allowPaging){c+=col0-cols>=0?"<a href='#' onclick='col0 -= cols; currCol -= cols; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/back.png'></a> ":"<img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/back.png'> ";c+="<a href='#' onclick='col0 += cols; currCol += cols; display(); return false;'><img border='0' src='index.php?version="+
EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/forward.png'></a> ";c+=row0-rows>=0?"<a href='#' onclick='row0 -= rows; currRow -= rows; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/restore.png'></a> ":" <img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/restore.png'> ";c+="<a href='#' onclick='row0 += rows; currRow += rows; display(); return false;'><img border='0' src='index.php?version="+
EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/download.png'></a> "}c+="</div>";c+="<div class='statusText'> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "+trans("Sheet Size")+": <input type='text' value='"+cols+"' style='width:28px; text-align:center;' id='cols' onfocus='active=\"dimensions\";' onblur='active=\"content\";'> x <input type='text' value='"+rows+"' style='width:28px; text-align:center;' id='rows' onfocus='active=\"dimensions\";' onblur='active=\"content\";'></div>";c+="<div id='status' class='status'></div>";
getObj("data").innerHTML=c;getObj("content").scrollLeft=a;getObj("content").scrollTop=b;mouseoverCell(currRow,currCol);if(clipboard_mode!=""){a="#DDDDFF";if(clipboard_mode=="cut")a="#FFDDDD";if(clipboard_range.length>0)highlightRange(clipboard_range,"",a);else if(b=resolveCell(clipboard_row,clipboard_col))b.style.backgroundColor=a}getObj("focus").focus()}
function showHeaderFooter(a){if(!isWriteable)if(a){getObj("content").style.top="23px";getObj("content").style.bottom="18px";getObj("header").style.display="";getObj("footer").style.display="";getObj("status").style.display=""}else{getObj("content").style.top="0px";getObj("content").style.bottom="0px";getObj("header").style.display="none";getObj("footer").style.display="none";getObj("status").style.display="none"}}
function previewValue(){var a=getObj("value").value;if(!getObj("value").disabled&&(a.length>25||a.indexOf("\\n")!=-1||a.indexOf("html:")==0)){getObj("multiline").style.display="inline";getObj("multiline").contentWindow.update&&getObj("multiline").contentWindow.update()}previewField()}
function previewField(){var a=resolveCell(currRow,currCol);value=previewCell(getObj("value").value,0);value=formatValue(value,getObj("styling").value);var b=htmlEscape(formatStyle(getObj("styling").value,value),false);if(currRow==-1){if(value!="")value+=" - ";value+=buildColName(currCol)}else if(currCol==-1){if(value!="")value+="\\n";value+=currRow+1}value=htmlEscape(value,true);b="<div "+(b?"style='"+b+"'":"")+">"+value+"</div>";a.innerHTML=b;if(b.indexOf("<img")!=-1)a.style.height=a.offsetHeight+
"px";if(currRow==-1||currCol==-1)highlightCellHeader(currRow,currCol)}function previewMultiline(a){getObj("value").value=a.replace(/\n/g,"\\n").replace(/\r/g,"");previewField()}function log(a){if(!getObj("tconsole")){var b=document.createElement("textarea");b.id="tconsole";document.body.appendChild(b)}getObj("tconsole").value+=getObj("tconsole").value.split("\n").length+": "+a+"\n"}
function manual(){window.open("manual.html","manual","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600")}function isWritable(a){if(a.indexOf("readonly:true")==-1&&isWriteable)return true;return false}function getCells(a,b,c){if(cells[a]&&cells[a][b]&&cells[a][b].length==4)return cells[a][b][c];return""}function getCellsR(a,b,c){a=resolveCellArray(a,b);return getCells(a[0],a[1],c)}
function getCells2(a,b,c,d){a=colstrToColnum(a);b=showCell(b-1,a,d+1);d=parseFloat(b);return d==b?d:b}function getCells3(a,b,c,d,e,f){e=[];a=colstrToColnum(a);c=colstrToColnum(c);if(a>c||b>d)return new Array("error");for(b=b;b<=d;b++)for(var h=a;h<=c;h++){var g=showCell(b-1,h,f+1),j=parseFloat(g);e[e.length]=j==g?j:g}return e}function getCellStyle(a,b,c){a=getCells(a,b,1);return a=(p=(new RegExp(c+":(.*?);","i")).exec(a))?parseInt(p[1]):0}
function setCells(a,b,c,d){cells[a]||(cells[a]=[]);cells[a][b]||(cells[a][b]=new Array("","","",""));if(cells[a][b][c]!=d){cells[a][b][c]=d;return true}else return false}function setCellsR(a,b,c,d){a=resolveCellArray(a,b);return setCells(a[0],a[1],c,d)}function loadScriptFile(a){var b=document.createElement("script");b.type="text/javascript";b.src=a;document.getElementsByTagName("head").item(0).appendChild(b)}
function loadStyleFile(a){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a;document.getElementsByTagName("head").item(0).appendChild(b)}
function load(a){if(a.indexOf("dbCells")==-1){cells=a.indexOf(tab)==-1?loadCSV(a):loadTSV(a);if(!cells)return}else{try{eval(a)}catch(b){return}if(window.registerFuncs=registerFuncs)for(var c=0;c<registerFuncs.length;c++)window[registerFuncs[c]]=eval(registerFuncs[c]);cells=[];try{for(c=0;c<dbCells.length;c++)if(dbCells[c]){cells[dbCells[c][1]]||(cells[dbCells[c][1]]=[]);cells[dbCells[c][1]][dbCells[c][0]]=new Array(dbCells[c][2],dbCells[c][3],dbCells[c][4],"")}}catch(d){return}}showColumnGroups=typeof cells[-2]!=
"undefined"?true:false;active="content";getObj("source").style.display="none";getObj("data").style.display="inline";display()}function cancelLoad(){active="content";getObj("source").style.display="none";getObj("data").style.display="inline";display()}
function loadCSV(a){a=a.replace(/([^,])""([^,])/g,"$1#quot#$2").replace(/\r/g,"");a=a.replace(/(".*?")/g,function(c){return c.replace(/,/g,"#comm#")});a=a.replace(/([^,])""([^,])/g,"$1#quot#$2");a=a.split("\n");for(var b=0;b<a.length;b++){a[b]='["'+a[b].replace(/^"|"\s*$/g,"").replace(/"?,"?/g,'","')+'"]';if(b!=a.length-1)a[b]+=","}a="dbCells = [\n"+a.join("\n")+"\n];\n";a=a.replace(/#comm#/g,",").replace(/#quot#/g,'\\"');return loadDbCells(a)}
function loadTSV(a){a=a.replace(/^\/\/.*?\n/g,"").replace(/\r/g,"").split("\n");for(var b=0;b<a.length;b++){a[b]='["'+a[b].replace(/"/g,'\\"').replace(/\t/g,'","')+'"]';if(b!=a.length-1)a[b]+=","}a="dbCells = [\n"+a.join("\n")+"\n];\n";a=a.replace(/\[""\],\n/g,"");return loadDbCells(a)}
function loadDbCells(a){try{eval(a)}catch(b){return false}cells=[];try{for(a=0;a<dbCells.length;a++)for(var c=0;c<dbCells[a].length;c++)if(dbCells[a][c]){cells[a-1]||(cells[a-1]=[]);cells[a-1][c]=new Array(dbCells[a][c]+"","","","")}}catch(d){return false}return cells}function save(a){active="code";var b=getObj("status").innerHTML="";b=a=="csv"?cellsToCSV():a=="tsv"?cellsToTSV():cellsToJS();getObj("data").style.display="none";getObj("source").style.display="inline";getObj("code").value=b}
function cellsToJS(){var a="";a+="dbCells = [\n";for(var b=-2;b<cells.length;b++)if(cells[b]){for(var c=-1;c<cells[b].length;c++)if(cells[b][c])if(!(cells[b][c][0]==""&&cells[b][c][1]=="")){a+="  ["+c+","+b+',"'+strescape(cells[b][c][0])+'","'+strescape(cells[b][c][1])+'"';if(cells[b][c][2]&&isNaN(cells[b][c][2]))a+=',"'+strescape(cells[b][c][2])+'"';else if(cells[b][c][2])a+=","+cells[b][c][2];a+="], // "+buildColName(c)+(b+1)+"\n"}a+="\n"}if(cells.length>0)a=a.substring(0,a.length-2)+"\n];\n";else a+=
"];\n";if(registerFuncs){a+="\nvar registerFuncs = [";for(b=0;b<registerFuncs.length;b++)a+='"'+registerFuncs[b]+'",';a=a.substring(0,a.length-1)+"];\n\n";for(b=0;b<registerFuncs.length;b++)a+=eval(registerFuncs[b])+"\n\n";a=a.substring(0,a.length-2)}return a}
function cellsToCSV(){for(var a="",b=-1;b<cells.length;b++)if(cells[b]){for(var c=0;c<cells[b].length;c++)if(cells[b][c]&&cells[b][c][0])if(b==-1&&cells[b][c][2])a+='"'+cells[b][c][2].replace(/\\/g,"\\\\").replace(/"/g,'""')+'",';else{var d=showCell(b,c);a+=isNaN(d)?'"'+d.replace(/\\/g,"\\\\").replace(/"/g,'""')+'",':d+","}else a+=",";a=a.substring(0,a.length-1)+"\n"}else a+=",\n";return a}
function cellsToTSV(){for(var a="// "+trans("Copy / paste this code to other spreadsheet applications (e.g. Excel)")+":\n\n",b=-1;b<cells.length;b++)if(cells[b]){for(var c=0;c<cells[b].length;c++)a+=cells[b][c]&&cells[b][c][0]?b==-1&&cells[b][c][2]?cells[b][c][2]+tab:showCell(b,c)+tab:tab;a=a.substring(0,a.length-1)+"\n"}else if(b==-1)a+=tab+"\n";return a}
function addHiddenParam(a,b,c){param=document.createElement("input");a.appendChild(param);param.setAttribute("type","hidden");param.setAttribute("name",b);param.setAttribute("value",c)}
function saveSGS(){var a="index.php?view="+escape(sgs_view)+"&folder="+escape(sgs_folder);a+=sgs_view=="edit"?"&form_submit_edit=checked":"&form_submit_create=checked";var b="";b=0;for(var c=document.createElement("form"),d=0;d<cells.length;d++)if(cells[d]){var e=d;if(cells[-1][0][2]=="id"&&cells[d][0]&&cells[d][0][3]!="")e=cells[d][0][3];addHiddenParam(c,"form_fields[]",e);addHiddenParam(c,"form_"+e+"_folder",escape(sgs_folder));b++;for(var f=0;f<cells[-1].length;f++){var h="";if(cells[-1]&&cells[-1][f])h=
cells[-1][f][2]?cells[-1][f][2]:cells[-1][f][0];h&&addHiddenParam(c,"form_"+e+"_"+h,showCell(d,f))}}c.action=a+"&limit="+b;c.method="POST";c.style.display="none";document.body.appendChild(c);c.submit()}
function loadSheetFromUrl(a){var b=document.createElement("script");b.type="text/javascript";if(window.addEventListener)window.addEventListener("load",function(){load("// dbCells")},false);else b.onreadystatechange=function(){this.readyState=="loaded"&&load("// dbCells")};b.src=a;document.getElementsByTagName("head").item(0).appendChild(b)}function resetPath(){window.parent.sendMsg($checknum,"resetPath","")}
function saveCode(){window.parent.sendMsg($checknum,"saveFile","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveCodeClose(){window.parent.sendMsg($checknum,"yDelete","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveAs(){window.parent.sendMsg($checknum,"saveAs","")}function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function help(){window.parent.sendMsg($checknum,"help","")}function fullScreen(){window.parent.sendMsg($checknum,"fullScreen","")}
function print(){var a=document.getElementById("content").innerHTML;a=a.replace(/(<\/tr>|<\/table>)/g,"$1\n");var b=window.open("","print","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600");b.document.write("<html><head><link media='all' href='"+printstyle+"' rel='stylesheet' type='text/css'/></head>\n");b.document.write("<body>\n"+a+"\n</body></html>");b.document.close();b.window.print()}
function insertRow(){for(var a=cells.length-1;a>=currRow;a--)if(cells[a])for(var b=0;b<cells[a].length;b++)if(cells[a][b]){cells[a+1]||(cells[a+1]=[]);cells[a+1][b]=cells[a][b];cells[a][b]=""}display()}
function deleteRow(){var a=currRow,b=currRow;if(multiRange.length>0){b=getMultiRange(multiRange);a=b[0];b=b[2]}for(var c=a;c<=b;c++)for(var d=a;d<cells.length;d++)if(cells[d])for(var e=0;e<cells[d].length;e++){cells[d+1]||(cells[d+1]=[]);if(!cells[d+1][e]&&cells[d][e])cells[d][e]="";if(cells[d+1][e]||cells[d][e]){cells[d][e]=cells[d+1][e];cells[d+1][e]=""}}display()}
function insertColumn(){for(var a=0;a<cells.length;a++)if(cells[a])for(var b=cells[a].length-1;b>=currCol;b--)if(cells[a][b]){cells[a][b+1]=cells[a][b];cells[a][b]=""}display()}
function deleteColumn(){var a=currCol,b=currCol;if(multiRange.length>0){b=getMultiRange(multiRange);a=b[1];b=b[3]}for(var c=a;c<=b;c++)for(var d=0;d<cells.length;d++)if(cells[d])for(var e=a;e<cells[d].length;e++){if(!cells[d][e+1]&&cells[d][e])cells[d][e]="";if(cells[d][e+1]||cells[d][e]){cells[d][e]=cells[d][e+1];cells[d][e+1]=""}}display()}function scroll(){scrollDown();scrollUp();scrollRight();scrollLeft()}
function scrollUp(){var a=resolveCell(currRow,currCol),b=findPosY(a);if(b<getObj("content").scrollTop+100&&getObj("content").scrollTop>b-100)getObj("content").scrollTop=b-100;a=findPosX(a);if(a<getObj("content").scrollLeft+200&&getObj("content").scrollLeft>a-150)getObj("content").scrollLeft=a-150}
function scrollDown(){var a=resolveCell(currRow,currCol),b=findPosY(a),c=return_height();if(a&&b+a.offsetHeight+100>c){b=b+a.offsetHeight+100-c;if(b>getObj("content").scrollTop)getObj("content").scrollTop=b}b=findPosX(a);c=return_width();if(a&&b+a.offsetWidth+100>c){a=b+a.offsetWidth+100-c;if(a>getObj("content").scrollLeft)getObj("content").scrollLeft=a}}function scrollLeft(){scrollUp()}function scrollRight(){scrollDown()}
function removeSelectedCell(){if(multiRange.length>0)for(var a=getMultiRange(multiRange),b=a[0];b<=a[2];b++)for(var c=a[1];c<=a[3];c++){if(isWritable(getCellsR(b,c,1))){setCellsR(b,c,0,"");setCellsR(b,c,1,"");if(!auto_recalc){var d=resolveCell(b,c);d.innerHTML="<div>&nbsp;</div>"}}}else{removeCell(currRow,currCol);if(!auto_recalc&&isWritable(getCellsR(currRow,currCol,1))){d=resolveCell(currRow,currCol);d.innerHTML="<div>&nbsp;</div>"}}auto_recalc&&display()}
function cutcopy(a,b){if(isWriteable){if(clipboard_range.length>0)highlightRange(clipboard_range,"","");else if(clipboard_mode){var c=resolveCell(clipboard_row,clipboard_col);if(c)c.style.backgroundColor=""}clipboard_mode=a;clipboard_row=currRow;clipboard_col=currCol;clipboard_range=getMultiRange(multiRange);if(multiRange.length>0)highlightRange(multiRange,"",b);else if(c=resolveCell(currRow,currCol))c.style.backgroundColor=b}}
function paste(){if(clipboard_range.length>0){var a=getMultiRange(clipboard_range),b=new Array(currRow,currCol,currRow+a[2]-a[0],currCol+a[3]-a[1]);if(multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3]))b=getMultiRange(multiRange);var c=0,d=0;if(b[0]>=a[0]&&b[1]>=a[1]||b[0]>a[0]&&b[1]<a[1])for(var e=b[2];e>=b[0];e--){c=(e-b[0])%(a[2]-a[0]+1);for(var f=b[3];f>=b[1];f--){d=(f-b[1])%(a[3]-a[1]+1);copyCell(a[0]+c,a[1]+d,e,f);if(d=resolveCell(a[0]+c,a[1]+d))d.style.backgroundColor=
""}}else for(e=b[0];e<=b[2];e++){c=(e-b[0])%(a[2]-a[0]+1);for(f=b[1];f<=b[3];f++){d=(f-b[1])%(a[3]-a[1]+1);copyCell(a[0]+c,a[1]+d,e,f);if(d=resolveCell(a[0]+c,a[1]+d))d.style.backgroundColor=""}}if(clipboard_mode=="cut"){for(e=a[0];e<=a[2];e++)for(f=a[1];f<=a[3];f++)if(e<b[0]||e>b[2]||f<b[1]||f>b[3])removeCell(e,f);clipboard_mode=""}}else{if(multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3])){b=getMultiRange(multiRange);for(e=b[2];e>=b[0];e--)for(f=b[3];f>=b[1];f--)copyCell(clipboard_row,
clipboard_col,e,f);if(clipboard_mode=="cut"&&(clipboard_row<b[0]||clipboard_row>b[2]||clipboard_col<b[1]||clipboard_col>b[3]))removeCell(clipboard_row,clipboard_col)}else{copyCell(clipboard_row,clipboard_col,currRow,currCol);if(clipboard_mode=="cut"&&(clipboard_row!=currRow||clipboard_col!=currCol))removeCell(clipboard_row,clipboard_col)}if(clipboard_mode=="cut")clipboard_mode=""}display()}function sortNum(a){if(isNaN(a))return a.charAt(0).toLowerCase().charCodeAt(0);return parseFloat(a)}
function sortCells(a,b){if(a[currCol]&&b[currCol]){if(a[currCol][3]=="")return 1;if(b[currCol][3]=="")return-1;a=sortNum(a[currCol][3]);b=sortNum(b[currCol][3]);return a-b}return a[currCol]?1:-1}
function sort(a){if(multiRange.length>0){for(var b=getMultiRange(multiRange),c=[],d=b[0];d<=b[2];d++)for(var e=b[1];e<=b[3];e++){c[d]||(c[d]=[]);if(cells[d]&&cells[d][e])c[d][e]=cells[d][e]}c=a?c.sort(sortCells):c.sort(sortCells).reverse();for(d=b[0];d<=b[2];d++)for(e=b[1];e<=b[3];e++){cells[d]||(cells[d]=[]);cells[d][e]=c[d][e]}}else cells=a?cells.sort(sortCells):cells.sort(sortCells).reverse();display()}
function buildStatus(a,b){var c="",d=getCellsR(-1,b,0),e=getCellsR(-2,b,0),f=getCellsR(a,b,2);if(f&&a!=-1)c+=f+" - ";if(d){f=getCellsR(-1,b,2);if(e)c+=e+": ";c+=(f?f:d)+" - "}else if(e)c+=e+" - ";if(d=getCellsR(a,-1,0)){e=getCellsR(a,-1,2);c+=(e?e:d)+" - "}getObj("status").innerHTML=c+buildColName(b)+(a+1);if(isMouseDown){markCell(a,b);highlightRange(multiRange,"cell");multiRange[2]=a;multiRange[3]=b;highlightRange(multiRange,"cell_highlight_over")}}
function highlightRange(a,b,c){if(a.length==0)return false;a=getMultiRange(a);for(var d=a[0];d<=a[2];d++)for(var e=a[1];e<=a[3];e++)if((obj=resolveCell(d,e))&&b)obj.className=b;else if(!b&&obj)obj.style.backgroundColor=c}function getMultiRange(a){if(a.length==0)return[];return new Array(a[0]>a[2]?a[2]:a[0],a[1]>a[3]?a[3]:a[1],a[0]>a[2]?a[0]:a[2],a[1]>a[3]?a[1]:a[3])}
function mousedown(a,b){if(getObj("styling").disabled){document.onmousedown=new Function("return false;");document.onselectstart=new Function("return false;");isMouseDown=1;highlightRange(multiRange,"cell");multiRange=new Array(a,b,a,b);highlightRange(multiRange,"cell_highlight_over")}}function mouseup(){if(getObj("styling").disabled){document.onmousedown="";document.onselectstart="";isMouseDown=0}}
function markCell(a,b){highlightCell(a,b,"cell_highlight_over");highlightCellHeader(a,b);currRow=a;currCol=b;getObj("value").value=getCellsR(a,b,0);getObj("styling").value=getCellsR(a,b,1);getObj("field").value=buildColName(b)+(a+1)}
function mouseoverCell(a,b){if(getObj("styling").disabled)if(a==currRow&&b==currCol&&getObj("field").value)editCell(a,b,0);else{markCell(a,b);buildStatus(a,b)}else if(!getObj("value").disabled){var c=getObj("value");a=buildColName(b)+(a+1);if(c.selectionStart){b=c.selectionStart;c.value=c.value.substring(0,c.selectionStart)+a+c.value.substring(c.selectionStart);c.selectionStart=b+a.length;c.selectionEnd=b+a.length;c.focus()}else if(document.selection)c.value+=a;previewValue()}}
function highlightCell(a,b,c){var d=resolveCell(currRow,currCol);if(d)d.className="cell";if(d=resolveCell(a,b))d.className=c}function highlightCellHeader(a,b){var c=resolveCell(-1,currCol);if(c)c.className="border";if(c=resolveCell(currRow,-1))c.className="border";c=-1;if(a<-1)c=-2;if(c=resolveCell(c,b))c.className="border_highlight";if(a>=-1)if(c=resolveCell(a,-1))c.className="border_highlight"}
function showCell(a,b,c){if(typeof c=="undefined")c=0;value=getCells(a,b,0);if(c>25)value="undefined";else if(value!=""&&value.charAt(0)=="="){for(var d="",e="",f="",h="",g=0;g<value.length;g++){e=value.charAt(g);h+=e;if((e=="'"||e=='"')&&f==""||g==value.length-1){if(f==""){h=h.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(c+1)+")");h=h.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(c+1)+")")}f=e;d+=h;h=""}else if(e==f&&value.charAt(g-1)!="\\"){f="";d+=h;h=""}}try{eval("value"+
d)}catch(j){}}if(cells[a]&&cells[a][b])cells[a][b][3]=value;return value}
function previewCell(a,b){if(a==""||a.charAt(0)!="=")return a;if(b>25)return"undefined";for(var c="",d="",e="",f="",h=0;h<a.length;h++){d=a.charAt(h);f+=d;if((d=="'"||d=='"')&&e==""||h==a.length-1){if(e==""){f=f.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(b+1)+")");f=f.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(b+1)+")")}e=d;c+=f;f=""}else if(d==e&&a.charAt(h-1)!="\\"){e="";c+=f;f=""}}try{eval("nvalue"+c)}catch(g){}return a}
function gotoCell(a){if(p=(new RegExp("([@A-Z]+)([0-9]+)","g")).exec(a)){a=colstrToColnum(p[1]);var b=p[2]-1;if(a>=-1&&b>=0){getObj("focus").focus();if(a!=currCol||b!=currRow){if(a>=cols||b<=rows){col0=a-a%cols;row0=b-b%rows;display()}mouseoverCell(b,a);scroll()}}}}
function editCell(a,b,c){active="content";if(isWriteable){getObj("styling").disabled||cancelCell();highlightCell(a,b,"cell_highlight");highlightCellHeader(a,b);currRow=a;currCol=b;if(isWritable(getCellsR(a,b,1)))getObj("value").disabled=false;getObj("styling").disabled=false;getObj("save").disabled=false;getObj("cancel").disabled=false;if(getObj("cols"))getObj("cols").disabled=true;if(getObj("rows"))getObj("rows").disabled=true;getObj("field").disabled=true;getObj("styling").value=getCellsR(a,b,1);
if(c>32&&agent=="firefox"&&!getObj("value").disabled)getObj("value").value=String.fromCharCode(c);else getObj("value").value=getCellsR(a,b,0);getObj("value").disabled?getObj("styling").focus():getObj("value").focus()}}function copyCell(a,b,c,d){if(isWritable(getCellsR(c,d,1)))if(a!=c||b!=d){setCells(c,d,0,getCellsR(a,b,0));setCells(c,d,1,getCellsR(a,b,1))}}
function saveCell(){var a=setCellsR(currRow,currCol,0,getObj("value").value),b=setCellsR(currRow,currCol,1,getObj("styling").value);if(a||b)if(auto_recalc)display();else{disableEdit();previewValue()}else cancelCell()}
function disableEdit(){getObj("value").blur();highlightCell(currRow,currCol,"cell_highlight_over");getObj("value").disabled=true;getObj("styling").disabled=true;getObj("save").disabled=true;getObj("cancel").disabled=true;if(getObj("cols"))getObj("cols").disabled=false;if(getObj("rows"))getObj("rows").disabled=false;getObj("field").disabled=false;getObj("multiline").style.display="none";getObj("content").style.overflow="auto"}
function cancelCell(){disableEdit();getObj("value").value=getCellsR(currRow,currCol,0);getObj("styling").value=getCellsR(currRow,currCol,1);previewValue()}function removeCell(a,b){if(isWritable(getCellsR(a,b,1))){setCellsR(a,b,0,"");setCellsR(a,b,1,"")}}function resolveCell(a,b){var c=getObj(a+"_"+b);if(!c&&marks[a]&&marks[a][b])c=getObj(marks[a][b][0]+"_"+marks[a][b][1]);return c}
function resolveCellArray(a,b){if(!getObj(a+"_"+b)&&marks[a]&&marks[a][b]){b=marks[a][b];a=b[0];b=b[1]}return new Array(a,b)}
function getSize(a){var b=0,c=0;if(typeof window.innerWidth=="number"){b=window.innerWidth;c=window.innerHeight}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=window.document.documentElement.clientWidth;c=window.document.documentElement.clientHeight}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;c=document.body.clientHeight}else if(self.screen.height&&self.screen.width){b=
self.screen.width;c=self.screen.height}return a?b:c}function return_height(){return getSize(0)}function return_width(){return getSize(1)}function getObj(a){return document.getElementById(a)}function getmykey(a){if(typeof a=="undefined")return window.event.keyCode;if(a.keyCode==0&&a.charCode!=0)return a.charCode;if(a.keyCode==0)return a.which;return a.keyCode}
function findPosY(a){if(!a)return 0;var b=0;if(a.offsetParent)for(;a.offsetParent;){b+=a.offsetTop;a=a.offsetParent}else if(a.y)b+=a.y;return b}function findPosX(a){if(!a)return 0;var b=0;if(a.offsetParent)for(;a.offsetParent;){b+=a.offsetLeft;a=a.offsetParent}else if(a.x)b+=a.x;return b}function strescape(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}
function htmlEscape(a,b){if(a==null||a.length==0)return b?"&nbsp;":"";a=new String(a);if(a.indexOf("html:")==0)a=a.substring(5);else{a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");a=a.replace(/'/g,"&#039;").replace(/"/g,"&quot;");a=a.replace(/([^\s$]+@[^\s$]+)/g,"<a href='$1'>$1</a>");a=a.replace(/img:((http[s]?:\/\/[^\s$]+\.(gif|jpg|png))|(graphs\.php\?.*?$))/g,"<img src='$1'>");a=a.replace(/(^|[^'])(http[s]?:\/\/[^\s$]+)/g,"$1<a target='_blank' href='$2'>$2</a>");a=a.replace(/\\n/g,"<br>")}return a}
function handleErr(){return true}function buildColName(a){var b="",c="";if(a>=702){b=(Math.floor(a/676)-1)%26;c+=String.fromCharCode(b+65)}if(a>=26){b=(Math.floor(a/26)-1)%26;c+=String.fromCharCode(b+65)}c+=String.fromCharCode(a%26+65);return c}function colstrToColnum(a){for(var b=0,c=0;c<a.length;c++)b+=26*(a.length-c-1)+(a.charCodeAt(c)-65);return b}
function formatStyle(a,b){if(a.indexOf("text-align:")==-1&&b.length>0&&!isNaN((b+"").replace(/[$%,]/g,"").replace("&euro;",""))){a+="; text-align:right; white-space:nowrap;";if(b<0&&a.indexOf("color:")==-1)a+="color:#FF0000;"}return a.replace(/(format|readonly|colspan|rowspan):.*?;/ig,"")}
function formatValue(a,b){if(b.indexOf("format:")!=-1)if(b.indexOf("format:euro")!=-1)a=formatNumber(a)+" &euro;";else if(b.indexOf("format:dollar")!=-1)a="$"+formatNumber(a);else if(b.indexOf("format:percent")!=-1)a=(a*100).toFixed(2)+"%";else if(b.indexOf("format:number")!=-1)a=formatNumber(a);else if(b.indexOf("format:datefulltime")!=-1)a=formatDateFullTime(a);else if(b.indexOf("format:datetime")!=-1)a=formatDateTime(a);else if(b.indexOf("format:datefull")!=-1)a=formatDateFull(a);else if(b.indexOf("format:date")!=
-1)a=formatDate(a);else{if(b.indexOf("format:time")!=-1)a=formatTime(a)}else if(!isNaN(a)&&a!=0)a=formatNumber(a).replace(/\.00$/,"");return a}function formatDate(a){if(isNaN((new Date(a)).getHours()))a=a.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3");a=new Date(a);return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()}
function formatDateFull(a){if(isNaN((new Date(a)).getHours()))a=a.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3");a=new Date(a);var b=new Array(trans("January"),trans("February"),trans("March"),trans("April"),trans("May"),trans("June"),trans("July"),trans("August"),trans("September"),trans("October"),trans("November"),trans("December"));return(new Array(trans("Sunday"),trans("Monday"),trans("Tuesday"),trans("Wednesday"),trans("Thursday"),trans("Friday"),trans("Sunday")))[a.getDay()]+", "+b[a.getMonth()]+
" "+a.getDate()+" "+a.getFullYear()}function formatTime(a){if(isNaN((new Date(a)).getHours())){a=a.replace(/\d+\.\d+\.\d+/,"$2/$1/$3");if(a.length<12)a="01/01/01 "+a}a=new Date(a);hour=a.getHours();var b="am";if(hour>11)b="pm";if(hour>12)hour-=12;if(hour==0)hour=12;return hour+":"+a.getMinutes()+":"+a.getSeconds()+" "+b}function formatDateTime(a){return formatDate(a)+" "+formatTime(a)}function formatDateFullTime(a){return formatDateFull(a)+", "+formatTime(a)}
function formatNumber(a){var b="",c="";if(a<0){c="-";a*=-1}number=Math.floor((a-0).toFixed(2))+"";if(number.length>3){var d=number.length%3;b=d==0?"":number.substring(0,d);for(i=0;i<Math.floor(number.length/3);i++)b+=d==0&&i==0?number.substring(d+3*i,d+3*i+3):","+number.substring(d+3*i,d+3*i+3)}else b+=number;if(a-number!=0)b+=Math.abs(a-number).toFixed(2).replace("0.",".");return c+b}function param(a){if(a.join)a=a.join(",");if(a.replace)return escape(a);return a}
function graph(a,b,c,d,e,f,h,g){a="img:graphs.php?type="+param(a)+"&title="+param(b);a+="&data="+param(c)+"&keys="+param(d);if(typeof e!="undefined")a+="&xtitle="+param(e);if(typeof f!="undefined")a+="&ytitle="+param(f);if(typeof h!="undefined")a+="&width="+h;if(typeof g!="undefined")a+="&height="+g;return a}
function graph2(a,b,c,d,e,f,h,g,j){a="img:graphs.php?type="+param(a)+"&title="+param(b);a+="&data="+param(c)+"&data2="+param(d)+"&keys="+param(e);if(typeof f!="undefined")a+="&xtitle="+param(f);if(typeof h!="undefined")a+="&ytitle="+param(h);if(typeof g!="undefined")a+="&width="+g;if(typeof j!="undefined")a+="&height="+j;return a}function sum(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b}function min(a){var b=0;if(a.length>0)b=a[0];for(var c=0;c<a.length;c++)if(a[c]<b)b=a[c];return b}
function max(a){var b=0;if(a.length>0)b=a[0];for(var c=0;c<a.length;c++)if(a[c]>b)b=a[c];return b}function avg(a){var b=0;if(a.length==0)return 0;for(var c=0;c<a.length;c++)b+=a[c];return Math.round(1E3*(b/a.length))/1E3}function count(a){var b=0;return a.length}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",c,d,e,f,h,g,j=0;for(a=Base64._utf8_encode(a);j<a.length;){c=a.charCodeAt(j++);d=a.charCodeAt(j++);e=a.charCodeAt(j++);f=c>>2;c=(c&3)<<4|d>>4;h=(d&15)<<2|e>>6;g=e&63;if(isNaN(d))h=g=64;else if(isNaN(e))g=64;b=b+this._keyStr.charAt(f)+this._keyStr.charAt(c)+this._keyStr.charAt(h)+this._keyStr.charAt(g)}return b},decode:function(a){var b="",c,d,e,f,h,g=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,
"");g<a.length;){c=this._keyStr.indexOf(a.charAt(g++));d=this._keyStr.indexOf(a.charAt(g++));f=this._keyStr.indexOf(a.charAt(g++));h=this._keyStr.indexOf(a.charAt(g++));c=c<<2|d>>4;d=(d&15)<<4|f>>2;e=(f&3)<<6|h;b+=String.fromCharCode(c);if(f!=64)b+=String.fromCharCode(d);if(h!=64)b+=String.fromCharCode(e)}return b=Base64._utf8_decode(b)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);if(d<128)b+=String.fromCharCode(d);else{if(d>127&&d<2048)b+=
String.fromCharCode(d>>6|192);else{b+=String.fromCharCode(d>>12|224);b+=String.fromCharCode(d>>6&63|128)}b+=String.fromCharCode(d&63|128)}}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;){d=a.charCodeAt(c);if(d<128){b+=String.fromCharCode(d);c++}else if(d>191&&d<224){c2=a.charCodeAt(c+1);b+=String.fromCharCode((d&31)<<6|c2&63);c+=2}else{c2=a.charCodeAt(c+1);c3=a.charCodeAt(c+2);b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63);c+=3}}return b}};
