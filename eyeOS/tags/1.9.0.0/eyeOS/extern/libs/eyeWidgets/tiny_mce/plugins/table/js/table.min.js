tinyMCEPopup.requireLangPack();var action,orgTableWidth,orgTableHeight,dom=tinyMCEPopup.editor.dom;function insertTable(){var i=document.forms[0];var e=tinyMCEPopup.editor,u=e.dom;var m=2,k=2,s=0,v=-1,b=-1,t,q,p,d,w,o,l;var n="",r,f;var z,A,c;tinyMCEPopup.restoreSelection();if(!AutoValidator.validate(i)){tinyMCEPopup.alert(e.getLang("invalid_data"));return false}f=u.getParent(e.selection.getNode(),"table");m=i.elements.cols.value;k=i.elements.rows.value;s=i.elements.border.value!=""?i.elements.border.value:0;v=i.elements.cellpadding.value!=""?i.elements.cellpadding.value:"";b=i.elements.cellspacing.value!=""?i.elements.cellspacing.value:"";t=getSelectValue(i,"align");o=getSelectValue(i,"tframe");l=getSelectValue(i,"rules");q=i.elements.width.value;p=i.elements.height.value;bordercolor=i.elements.bordercolor.value;bgcolor=i.elements.bgcolor.value;d=getSelectValue(i,"class");id=i.elements.id.value;summary=i.elements.summary.value;style=i.elements.style.value;dir=i.elements.dir.value;lang=i.elements.lang.value;background=i.elements.backgroundimage.value;w=i.elements.caption.checked;z=tinyMCEPopup.getParam("table_cell_limit",false);A=tinyMCEPopup.getParam("table_row_limit",false);c=tinyMCEPopup.getParam("table_col_limit",false);if(c&&m>c){tinyMCEPopup.alert(e.getLang("table_dlg.col_limit").replace(/\{\$cols\}/g,c));return false}else{if(A&&k>A){tinyMCEPopup.alert(e.getLang("table_dlg.row_limit").replace(/\{\$rows\}/g,A));return false}else{if(z&&m*k>z){tinyMCEPopup.alert(e.getLang("table_dlg.cell_limit").replace(/\{\$cells\}/g,z));return false}}}if(action=="update"){e.execCommand("mceBeginUndoLevel");u.setAttrib(f,"cellPadding",v,true);u.setAttrib(f,"cellSpacing",b,true);u.setAttrib(f,"border",s);u.setAttrib(f,"align",t);u.setAttrib(f,"frame",o);u.setAttrib(f,"rules",l);u.setAttrib(f,"class",d);u.setAttrib(f,"style",style);u.setAttrib(f,"id",id);u.setAttrib(f,"summary",summary);u.setAttrib(f,"dir",dir);u.setAttrib(f,"lang",lang);r=e.dom.select("caption",f)[0];if(r&&!w){r.parentNode.removeChild(r)}if(!r&&w){r=f.ownerDocument.createElement("caption");if(!tinymce.isIE){r.innerHTML='<br mce_bogus="1"/>'}f.insertBefore(r,f.firstChild)}if(q&&e.settings.inline_styles){u.setStyle(f,"width",q);u.setAttrib(f,"width","")}else{u.setAttrib(f,"width",q,true);u.setStyle(f,"width","")}u.setAttrib(f,"borderColor","");u.setAttrib(f,"bgColor","");u.setAttrib(f,"background","");if(p&&e.settings.inline_styles){u.setStyle(f,"height",p);u.setAttrib(f,"height","")}else{u.setAttrib(f,"height",p,true);u.setStyle(f,"height","")}if(background!=""){f.style.backgroundImage="url('"+background+"')"}else{f.style.backgroundImage=""}if(bordercolor!=""){f.style.borderColor=bordercolor;f.style.borderStyle=f.style.borderStyle==""?"solid":f.style.borderStyle;f.style.borderWidth=s==""?"1px":s}else{f.style.borderColor=""}f.style.backgroundColor=bgcolor;f.style.height=getCSSSize(p);e.addVisual();e.nodeChanged();e.execCommand("mceEndUndoLevel");if(i.width.value!=orgTableWidth||i.height.value!=orgTableHeight){e.execCommand("mceRepaint")}tinyMCEPopup.close();return true}n+="<table";n+=makeAttrib("id",id);n+=makeAttrib("border",s);n+=makeAttrib("cellpadding",v);n+=makeAttrib("cellspacing",b);if(q&&e.settings.inline_styles){if(style){style+="; "}if(/^[0-9\.]+$/.test(q)){q+="px"}style+="width: "+q}else{n+=makeAttrib("width",q)}n+=makeAttrib("align",t);n+=makeAttrib("frame",o);n+=makeAttrib("rules",l);n+=makeAttrib("class",d);n+=makeAttrib("style",style);n+=makeAttrib("summary",summary);n+=makeAttrib("dir",dir);n+=makeAttrib("lang",lang);n+=">";if(w){if(!tinymce.isIE){n+='<caption><br mce_bogus="1"/></caption>'}else{n+="<caption></caption>"}}for(var h=0;h<k;h++){n+="<tr>";for(var j=0;j<m;j++){if(!tinymce.isIE){n+='<td><br mce_bogus="1"/></td>'}else{n+="<td></td>"}}n+="</tr>"}n+="</table>";e.execCommand("mceBeginUndoLevel");if(e.settings.fix_table_elements){var a=e.selection.getBookmark(),g="";e.execCommand("mceInsertContent",false,'<br class="_mce_marker" />');tinymce.each("h1,h2,h3,h4,h5,h6,p".split(","),function(x){if(g){g+=","}g+=x+" ._mce_marker"});tinymce.each(e.dom.select(g),function(x){e.dom.split(e.dom.getParent(x,"h1,h2,h3,h4,h5,h6,p"),x)});u.setOuterHTML(u.select("._mce_marker")[0],n);e.selection.moveToBookmark(a)}else{e.execCommand("mceInsertContent",false,n)}e.addVisual();e.execCommand("mceEndUndoLevel");tinyMCEPopup.close()}function makeAttrib(d,c){var b=document.forms[0];var a=b.elements[d];if(typeof(c)=="undefined"||c==null){c="";if(a){c=a.value}}if(c==""){return""}c=c.replace(/&/g,"&amp;");c=c.replace(/\"/g,"&quot;");c=c.replace(/</g,"&lt;");c=c.replace(/>/g,"&gt;");return" "+d+'="'+c+'"'}function init(){tinyMCEPopup.resizeToInnerSize();document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table");document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table");document.getElementById("bordercolor_pickcontainer").innerHTML=getColorPickerHTML("bordercolor_pick","bordercolor");document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");var k=2,j=2,r=tinyMCEPopup.getParam("table_default_border","0"),y=tinyMCEPopup.getParam("table_default_cellpadding",""),b=tinyMCEPopup.getParam("table_default_cellspacing","");var s="",q="",n="",v="",a="",c="";var o="",f="",w="",p="",z="",x="",a="",v="",h,m;var d=tinyMCEPopup.editor,u=d.dom;var g=document.forms[0];var e=u.getParent(d.selection.getNode(),"table");action=tinyMCEPopup.getWindowArg("action");if(!action){action=e?"update":"insert"}if(e&&action!="insert"){var l=e.rows;var k=0;for(var t=0;t<l.length;t++){if(l[t].cells.length>k){k=l[t].cells.length}}k=k;j=l.length;st=u.parseStyle(u.getAttrib(e,"style"));r=trimSize(getStyle(e,"border","borderWidth"));y=u.getAttrib(e,"cellpadding","");b=u.getAttrib(e,"cellspacing","");q=trimSize(getStyle(e,"width","width"));n=trimSize(getStyle(e,"height","height"));v=convertRGBToHex(getStyle(e,"bordercolor","borderLeftColor"));a=convertRGBToHex(getStyle(e,"bgcolor","backgroundColor"));s=u.getAttrib(e,"align",s);m=u.getAttrib(e,"frame");h=u.getAttrib(e,"rules");c=tinymce.trim(u.getAttrib(e,"class").replace(/mceItem.+/g,""));o=u.getAttrib(e,"id");f=u.getAttrib(e,"summary");w=u.serializeStyle(st);p=u.getAttrib(e,"dir");z=u.getAttrib(e,"lang");x=getStyle(e,"background","backgroundImage").replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1");g.caption.checked=e.getElementsByTagName("caption").length>0;orgTableWidth=q;orgTableHeight=n;action="update";g.insert.value=d.getLang("update")}addClassesToList("class","table_styles");TinyMCE_EditableSelects.init();selectByValue(g,"align",s);selectByValue(g,"tframe",m);selectByValue(g,"rules",h);selectByValue(g,"class",c,true,true);g.cols.value=k;g.rows.value=j;g.border.value=r;g.cellpadding.value=y;g.cellspacing.value=b;g.width.value=q;g.height.value=n;g.bordercolor.value=v;g.bgcolor.value=a;g.id.value=o;g.summary.value=f;g.style.value=w;g.dir.value=p;g.lang.value=z;g.backgroundimage.value=x;updateColor("bordercolor_pick","bordercolor");updateColor("bgcolor_pick","bgcolor");if(isVisible("backgroundimagebrowser")){document.getElementById("backgroundimage").style.width="180px"}if(action=="update"){g.cols.disabled=true;g.rows.disabled=true}}function changedSize(){var b=document.forms[0];var c=dom.parseStyle(b.style.value);var a=b.height.value;if(a!=""){c.height=getCSSSize(a)}else{c.height=""}b.style.value=dom.serializeStyle(c)}function changedBackgroundImage(){var a=document.forms[0];var b=dom.parseStyle(a.style.value);b["background-image"]="url('"+a.backgroundimage.value+"')";a.style.value=dom.serializeStyle(b)}function changedBorder(){var a=document.forms[0];var b=dom.parseStyle(a.style.value);if(a.border.value!=""&&a.bordercolor.value!=""){b["border-width"]=a.border.value+"px"}a.style.value=dom.serializeStyle(b)}function changedColor(){var a=document.forms[0];var b=dom.parseStyle(a.style.value);b["background-color"]=a.bgcolor.value;if(a.bordercolor.value!=""){b["border-color"]=a.bordercolor.value;if(!b["border-width"]){b["border-width"]=a.border.value==""?"1px":a.border.value+"px"}}a.style.value=dom.serializeStyle(b)}function changedStyle(){var a=document.forms[0];var b=dom.parseStyle(a.style.value);if(b["background-image"]){a.backgroundimage.value=b["background-image"].replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1")}else{a.backgroundimage.value=""}if(b.width){a.width.value=trimSize(b.width)}if(b.height){a.height.value=trimSize(b.height)}if(b["background-color"]){a.bgcolor.value=b["background-color"];updateColor("bgcolor_pick","bgcolor")}if(b["border-color"]){a.bordercolor.value=b["border-color"];updateColor("bordercolor_pick","bordercolor")}}tinyMCEPopup.onInit.add(init);