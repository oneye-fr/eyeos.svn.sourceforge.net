CodePress={scrolling:false,autocomplete:true,initialize:function(){if(typeof(editor)=="undefined"&&!arguments[0]){return}chars="|32|46|62|";cc="\u2009";editor=document.getElementsByTagName("pre")[0];editor.contentEditable="true";document.getElementsByTagName("body")[0].onfocus=function(){editor.focus()};document.attachEvent("onkeydown",this.metaHandler);document.attachEvent("onkeypress",this.keyHandler);window.attachEvent("onscroll",function(){if(!CodePress.scrolling){setTimeout(function(){CodePress.syntaxHighlight("scroll")},1)}});completeChars=this.getCompleteChars();completeEndingChars=this.getCompleteEndingChars();setTimeout(function(){window.scroll(0,0)},50)},keyHandler:function(a){charCode=a.keyCode;fromChar=String.fromCharCode(charCode);if((completeEndingChars.indexOf("|"+fromChar+"|")!=-1||completeChars.indexOf("|"+fromChar+"|")!=-1)&&CodePress.autocomplete){if(!CodePress.completeEnding(fromChar)){CodePress.complete(fromChar)}}else{if(chars.indexOf("|"+charCode+"|")!=-1||charCode==13){CodePress.syntaxHighlight("generic")}}},metaHandler:function(a){keyCode=a.keyCode;if(keyCode==9||a.tabKey){CodePress.snippets()}else{if((keyCode==122||keyCode==121||keyCode==90)&&a.ctrlKey){(keyCode==121||a.shiftKey)?CodePress.actions.redo():CodePress.actions.undo();a.returnValue=false}else{if(keyCode==34||keyCode==33){self.scrollBy(0,(keyCode==34)?200:-200);a.returnValue=false}else{if(keyCode==46||keyCode==8){CodePress.actions.history[CodePress.actions.next()]=editor.innerHTML}else{if((a.ctrlKey||a.metaKey)&&a.shiftKey&&keyCode!=90){CodePress.shortcuts(keyCode);a.returnValue=false}else{if(keyCode==86&&a.ctrlKey){window.clipboardData.setData("Text",window.clipboardData.getData("Text").replace(/\t/g,"\u2008"));top.setTimeout(function(){CodePress.syntaxHighlight("paste")},10)}else{if(keyCode==67&&a.ctrlKey){}}}}}}}},findString:function(){range=self.document.body.createTextRange();if(range.findText(cc)){range.select();range.text=""}},split:function(b,a){if(a=="scroll"){this.scrolling=true;return b}else{this.scrolling=false;mid=b.indexOf(cc);if(mid-2000<0){ini=0;end=4000}else{if(mid+2000>b.length){ini=b.length-4000;end=b.length}else{ini=mid-2000;end=mid+2000}}b=b.substring(ini,end);return b.substring(b.indexOf("<P>"),b.lastIndexOf("</P>")+4)}},syntaxHighlight:function(a){if(a!="init"){document.selection.createRange().text=cc}o=editor.innerHTML;if(a=="paste"){o=o.replace(/<BR>/g,"\r\n");o=o.replace(/\u2008/g,"\t")}o=o.replace(/<P>/g,"\n");o=o.replace(/<\/P>/g,"\r");o=o.replace(/<.*?>/g,"");o=o.replace(/&nbsp;/g,"");o="<PRE><P>"+o+"</P></PRE>";o=o.replace(/\n\r/g,"<P></P>");o=o.replace(/\n/g,"<P>");o=o.replace(/\r/g,"</P>");o=o.replace(/<P>(<P>)+/,"<P>");o=o.replace(/<\/P>(<\/P>)+/,"</P>");o=o.replace(/<P><\/P>/g,"<P><BR/></P>");x=z=this.split(o,a);if(arguments[1]&&arguments[2]){x=x.replace(arguments[1],arguments[2])}for(i=0;i<Language.syntax.length;i++){x=x.replace(Language.syntax[i].input,Language.syntax[i].output)}editor.innerHTML=this.actions.history[this.actions.next()]=(a=="scroll")?x:o.replace(z,x);if(a!="init"){this.findString()}},snippets:function(a){var d=Language.snippets;var b=this.getLastWord();for(var c=0;c<d.length;c++){if(d[c].input==b){var e=d[c].output.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");if(e.indexOf("$0")<0){e+=cc}else{e=e.replace(/\$0/,cc)}e=e.replace(/\n/g,"</P><P>");var f=new RegExp(b+cc,"gi");this.syntaxHighlight("snippets",f,e)}}},readOnly:function(){editor.contentEditable=(arguments[0])?"false":"true"},complete:function(b){var a=Language.complete;for(var c=0;c<a.length;c++){if(a[c].input==b){var e=new RegExp("\\"+b+cc);var d=a[c].output.replace(/\$0/g,cc);setTimeout(function(){CodePress.syntaxHighlight("complete",e,d)},0)}}},getCompleteChars:function(){var a="";for(var b=0;b<Language.complete.length;b++){a+="|"+Language.complete[b].input}return a+"|"},getCompleteEndingChars:function(){var a="";for(var b=0;b<Language.complete.length;b++){a+="|"+Language.complete[b].output.charAt(Language.complete[b].output.length-1)}return a+"|"},completeEnding:function(b){var a=document.selection.createRange();try{a.moveEnd("character",1)}catch(c){return false}var d=a.text;a.moveEnd("character",-1);if(d!=b){return false}else{a.moveEnd("character",1);a.text="";return true}},shortcuts:function(){var a=arguments[0];if(a==13){a="[enter]"}else{if(a==32){a="[space]"}else{a="["+String.fromCharCode(keyCode).toLowerCase()+"]"}}for(var b=0;b<Language.shortcuts.length;b++){if(Language.shortcuts[b].input==a){this.insertCode(Language.shortcuts[b].output,false)}}},getLastWord:function(){var a=CodePress.getRangeAndCaret();words=a[0].substring(a[1]-40,a[1]);words=words.replace(/[\s\n\r\);\W]/g,"\n").split("\n");return words[words.length-1].replace(/[\W]/gi,"").toLowerCase()},getRangeAndCaret:function(){var a=document.selection.createRange();var b=Math.abs(a.moveStart("character",-1000000)+1);a=this.getCode();a=a.replace(/\n\r/gi,"  ");a=a.replace(/\n/gi,"");return[a.toString(),b]},insertCode:function(e,d){var c="";var b="";if(d){b=e}else{c=e}if(typeof document.selection!="undefined"){var a=document.selection.createRange();a.text=c+b;a=document.selection.createRange();a.move("character",-b.length);a.select()}},getCode:function(){var a=editor.innerHTML;a=a.replace(/<br>/g,"\n");a=a.replace(/<\/p>/gi,"\r");a=a.replace(/<p>/i,"");a=a.replace(/<p>/gi,"\n");a=a.replace(/&nbsp;/gi,"");a=a.replace(/\u2009/g,"");a=a.replace(/<.*?>/g,"");a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&amp;/gi,"&");return a},setCode:function(){var a=arguments[0];a=a.replace(/\u2009/gi,"");a=a.replace(/&/gi,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");editor.innerHTML="<pre>"+a+"</pre>"},actions:{pos:-1,history:[],undo:function(){if(editor.innerHTML.indexOf(cc)==-1){document.selection.createRange().text=cc;this.history[this.pos]=editor.innerHTML}this.pos--;if(typeof(this.history[this.pos])=="undefined"){this.pos++}editor.innerHTML=this.history[this.pos];CodePress.findString()},redo:function(){this.pos++;if(typeof(this.history[this.pos])=="undefined"){this.pos--}editor.innerHTML=this.history[this.pos];CodePress.findString()},next:function(){if(this.pos>20){this.history[this.pos-21]=undefined}return ++this.pos}}};Language={};window.attachEvent("onload",function(){CodePress.initialize("new")});