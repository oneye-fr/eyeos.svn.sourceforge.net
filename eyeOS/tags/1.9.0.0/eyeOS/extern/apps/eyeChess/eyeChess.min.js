var windowd=document.getElementById("$myPid_eyeChess_Window_Content");M=I=P=N=q=K=J=Btime=0;Bt=1999;Al=-Bt;Ds=[10,-10];BE=120;Rh=[];G=[];R=[];KL=[3,3];j=[0,1,5,3,3,9,63,0];MV=[0,0,[1,10],[21,19,12,8],[11,9],[1,10,11,9],[1,10,11,9],0];for(z=0;z<8;){j[z+8]=j[z]<<=4;m=MV[z++];if(m){s=m.length;for(x=0;x<s;){m[s+x]=-m[x++]}}}x="g00000000g";y="gggggggggg";b=y+y+"g23456432gg11111111g"+x+x+x+x+"g99999999ggABCDECBAg"+y+y;w=x+x+x+"000111100000123321000123553210";a="000012346900";Y=[];PY=[];bY=[];for(y=0;y<12;y++){for(x=0;x<10;x++){z=(y*10)+x;PY[z]=parseInt(a.charAt(y));bY[z]=parseInt(w.charAt((z<60)?z:119-z),35)&7;R[z]=parseInt(b.charAt(z),35)}}R[BE]=0;d=document;A=E=d.all;if(!E){event=0}DM=d.getElementsByTagName||null;if(DM||E){windowd.innerHTML+='<img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" id="PI" name="PI" width="47" height="48" />';A=(E||d.getElementsByTagName("img"));Ic=A.PI.style}cp=new Function("a","b","return b[0]-a[0]");function Z(aj,l,W,T,ah,ab,aa,v){var D=-1,W=-W,f=8-l,ak=Al,X=R,o,Q=X[ah],ag,ai;if(W<-400){return[W,T,ah]}X[ah]=o=X[T];X[T]=0;if(o){G[f][G[f].length]=[o,ah]}if(o-l==1&&X[ah+Ds[l>>3]]>15){X[ah]+=4}if(o-l==6&&(T-ah==2||ah-T==2)){ag=T-4+(T<ah)*7;ai=(T+ah)>>1;X[ag]=0;X[ai]=l+2}var u=Pz(l,v,W),p=u.length,ac;if(p){if(aj){u.sort(cp);aj--;var af=u[0],ae=af[1],ad=af[2],F;ak=-Z(aj,f,af[0],ae,ad,-aa,-ab,af[3])[0];for(D=1;D<p;D++){if(ak>ab){ab=ak}ac=u[D];F=-Z(aj,f,ac[0],ac[1],ac[2],-ab-1,-ab,ac[3])[0];if((F>ab)&&(F<aa)){F=-Z(aj,f,ac[0],ac[1],ac[2],-aa,-F,ac[3])[0]}if(F>ak){ak=F;ae=ac[1];ad=ac[2];if(F>ab){ab=F}if(ak>aa){break}}}}else{ak=Al;while(--p&&aa>ak){if(u[p][0]>ak){ak=u[p][0]}}}}else{fy(0)}if(ag){X[ag]=l+2;X[ai]=0}X[T]=o;X[ah]=Q;G[f].length--;return[ak,ae,ad]}function Sf(o,g,k,n,f){var l=R[n],i=R[n]=R[k];R[k]=0;H();g=Z(o,g,0,BE,BE,Al,Bt,f);R[k]=i;R[n]=l;return g[0]}function mv(aa,C,Q){var X=R[C],r=R[aa],U=r&7,V=M>>3,L=0,W=0,F=0,i;if(M==P){H();i=Pz(M,K,0);for(;F<i.length;F++){W=W||(aa==i[F][1]&&C==i[F][2])}if(!W){return 0}if(Sf(0,8-M,aa,C,K)>400){return 0}}if(Sf(0,M,aa,C,K)>400){L=1}var T=aa%10,v=C-aa,f=Ds[V],W=C%10,k=1+(N>>1),o="abcdefgh";Df((M?"     ":(k<10?" ":"")+k+".  ")+o.charAt(T-1)+((aa-T)/10-1)+(X?"x":"-")+o.charAt(W-1)+((C-W)/10-1)+(L?"+":" "));if(Sf(1,8-M,aa,C,K)<-400){fy(L)}if((X&7)==6){fy(1);return 0}Rh[N]=[R.toString(),KL.toString(),K];K=0;if(U==1){if(R[C+f]>15){R[aa]+=4-Q}if(v==2*f&&(R[C-1]&1||R[C+1]&1)){K=aa+f}if(!X&&v%10){Sh(C,C-f)}}if(aa==21+V*70||aa==28+V*70){KL[V]&=(T<5)+1}if(C==21+V*70||C==28+V*70){KL[!V]&=(T<5)+1}if(U==6){if(v*v==4){Sh(aa-4+(aa<C)*7,aa+v/2)}KL[V]=0}Sh(aa,C);H();N++;M=8-M;return 1}function fy(e){Df(e?"checkmate!":"stalemate!");J=e++}function H(){var e=99,c;s0=(N<32)?4-(N>>3):(N>64);G[0]=[];G[8]=[];kY=[];pY=[[],[]];for(;e>20;e--){a=R[e];if(a&7){G[a&8][G[a&8].length]=[a,e]}Y[e]=bY[e]*s0;kY[e]=(N>40)||(10-2*bY[e])*s0;c=pY[1][119-e]=pY[0][e]=PY[e];if(N<7&&e>40){pY[0][e]=pY[1][119-e]=c+(Math.random()*Y[e])|1;Y[24]=Y[94]=29}}}function Pz(r,F,ap){var l,i,aj,ac,aq,aa,ag,ai=-1,ab=r>>3,o=r^8,ad=Ds[ab],S=[],ah,t,af=pY[ab],Q,an=KL[ab],C,ao,ak,am=G[r],al=am.length,ae=R,L=j;for(C=0;C<al;C++){l=am[C][1];aq=ae[l];if(am[C][0]==aq){aq&=7;if(aq>1){ao=aq==6;Q=ao?kY:Y;t=ap-Q[l];ag=MV[aq];if(aq==3||ao){for(aa=0;aa<8;){i=l+ag[aa++];ac=ae[i];if(!ac||(ac&24)==o){S[++ai]=[t+L[ac]+Q[i],l,i]}}if(ao&&an){if(an&1&&!(ae[l-1]+ae[l-2]+ae[l-3])&&CH(l-2,o,ad,-1)){S[++ai]=[t+11,l,l-2]}if(an&2&&!(ae[l+1]+ae[l+2])&&CH(l,o,ad,1)){S[++ai]=[t+12,l,l+2]}}}else{ak=ag.length;for(aa=0;aa<ak;){ac=0;ah=ag[aa++];i=l;while(!ac){i+=ah;ac=ae[i];if(!ac||(ac&24)==o){S[++ai]=[t+L[ac]+Q[i],l,i]}}}}}else{t=ap-af[l];i=l+ad;if(!ae[i]){S[++ai]=[t+af[i],l,i];if(!af[l]&&(!ae[i+ad])){S[++ai]=[t+af[i+ad],l,i+ad,i]}}if(F&&(F==i+1||F==i-1)){S[++ai]=[t+af[i],l,F]}for(aj=i-1;aj<i+2;aj+=2){ac=ae[aj]+r;if(ac&7&&ac&8){S[++ai]=[t+L[ac]+af[aj],l,aj]}}}}}return S}function CH(g,i,c,o){var f,u,t,l,p=g+3,r=c+2,n=MV[3],e=R;for(;g<p;g++){for(l=c-2;++l<r;){u=e[g+l];if(u&&(u&8)==i&&((u&8)==1||(u&7)==6)){return 0}u=0;f=g;while(!u){f+=l;u=e[f];if((u==i+2+(l!=c)*2)||u==i+5){return 0}}}for(z=0;z<8;){if(e[g+n[z++]]-i==3){return 0}}}u=0;g-=3;while(!u){g-=o;u=e[g];if(u==i+2||u==i+5){return 0}}return 1}function B(f){var c=R[f],g="PI";if(J){return}if(q==f&&I){O(g,0);O(q,I,1);I=0;return}if(c&&M==(c&8)){if(I){O(q,I,1)}I=c;q=f;O(q,0,1);O(g,c);if(E){dr()}d.onmousemove=dr;return}if(I){if(mv(q,f,d.FF.h.selectedIndex,y)){O(g,0);d.onmousemove=null;if(A){Ic.top=Ic.left="0px"}I=0;if(!J){var e=Z((d.FF.i.selectedIndex+1),M,0,BE,BE,Al,Bt,K);mv(e[1],e[2],0)}}}}function Sh(f,g){var c=R[f];R[g]=c;R[f]=0;O(f,0,1);O(g,c,1)}function Df(c){d.FF.b.value+="\n "+c}function Rf(c){P=c;for(var e=0;e<BE;e++){if(R[e]<16){O(e,R[e],1)}}if(P!=M){Tt=Z((d.FF.i.selectedIndex+1),M,0,BE,BE,Al,Bt,K);mv(Tt[1],Tt[2],0)}}function Gb(){if(!N){return}N-=2;var b=Rh[N];R=eval("["+b[0]+"]");KL=eval("["+b[1]+"]");Df(" --undo--");K=b[2];M=N%2;Rf(M);H()}function dr(c){c=c||event;Ic.left=(c.clientX+1)+"px";Ic.top=(c.clientY-4)+"px"}function O(c,f,e){if((A||c!="PI")&&e){c="i"+(P?119-c:c)}d.images[c].src="index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=$imagesDir/"+f+".png"}h='<table cellpadding="4" class="eyeChess_t">';for(y=90;y>10;y-=10){h+="<tr>";for(x=0;x<10;x++){z=y+x;if(x&&x<9){h+=('<td class="'+(x+(y/10)&1?"eyeChess_b":"eyeChess_w")+'"><span onclick="B(P?119-'+z+":"+z+');" style="cursor: pointer;"><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="0" height="48" border="0"><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="47" height="48" name="i'+z+'" border="0" /><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="0" height="48" border="0" /></span></td>\n')}}h+="</tr>\n"}h+="</table>";windowd.innerHTML+=h;Rf(0);windowd.innerHTML+='<form name="FF"><div style="text-align: center;"><table class="eyeChess_Table" border="0"><tr><td></td><td><textarea name="b" style="margin-top:5px;margin-left:5px;height:457px;" cols="12" rows="24" class="eyeTextarea">$lang:Movements:</textarea></td></tr></table><input type="button" class="eyeButtonClass" value="$lang:Undo" class="eyeButton" style="margin-top: 6px; position:absolute; top:475px; left:400px;" onclick="Gb();" /><div class="eyeChess_Text" style="margin-top: 15px;">$lang:Next pawn becomes: <select name="h" class="eyeSelect"><option selected="selected">$lang:Queen</option><option>$lang:Bishop</option><option>$lang:Knight</option><option>$lang:Rook</option></select> &nbsp; $lang:Computer level: <select class="eyeSelect" name="i"><option>$lang:Easy</option><option selected="selected">$lang:Middling</option><option>$lang:Slow</option></select></div></div></form>';H();