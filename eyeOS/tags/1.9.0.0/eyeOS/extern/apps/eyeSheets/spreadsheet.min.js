var myPid=$myPid;var myChecknum=$checknum;var EXTERN_CACHE_VERSION=$EXTERN_CACHE_VERSION;var agent=navigator.userAgent.toLowerCase();if(agent.indexOf("konqueror")!=-1){agent="konqueror"}else{if(agent.indexOf("safari")!=-1){agent="safari"}else{if(agent.indexOf("opera")!=-1){agent="opera"}else{if(agent.indexOf("firefox")!=-1){agent="firefox"}else{if(agent.indexOf("msie")!=-1){agent="msie"}}}}}window.onerror=handleErr;if(agent=="msie"||agent=="safari"){document.onkeydown=keypress}else{document.onkeypress=keypress}var init_data="";var auto_recalc=true;var cols=13;var rows=30;var row0=0;var col0=0;var col_min_width="90px";var cells=new Array();var marks=new Array();var view="values";var currRow=0;var currCol=0;var multiRange=new Array();var clipboard_row=0;var clipboard_col=0;var clipboard_range=new Array();var clipboard_mode="";var active="";var showColumnGroups=false;var allowPaging=true;var registerFuncs="";var isMouseDown=0;var isShiftDown=0;var sgs_folder=0;var sgs_view="";var saveMethod="save('js')";var closeMethod="";var isWriteable=true;var tab=String.fromCharCode(9);var printstyle="index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=css/apps/eyeSheets/print.css";function trans(a){if(strings[a]){return strings[a]}else{return"["+a+"]"}}function keypress(c){if(!getObj("value")||active=="code"){return true}var c=(c)?c:window.event;var f=getmykey(c);var b=true;if(active=="position"){if(f==13){gotoCell(getObj("field").value);active="content";b=false}return b}if(active=="dimensions"){if(f==13){rows=parseInt(getObj("rows").value);cols=parseInt(getObj("cols").value);active="content";display();b=false}return b}if(getObj("styling").disabled){getObj("focus").focus();active="content";var a=c.shiftKey;var e=c.altKey;var d=c.ctrlKey;if((d&&(f==88||f==120))||(a&&f==46)){cutcopy("cut","#FFDDDD");b=false}else{if((d&&(f==67||f==99))||d&&f==45){cutcopy("copy","#DDDDFF");b=false}else{if(((d&&(f==86||f==118))||(a&&f==45))&&clipboard_mode!=""){paste();b=false}}}if(a&&!isShiftDown){highlightRange(multiRange,"cell");multiRange=new Array(currRow,currCol,currRow,currCol);isShiftDown=1}else{if(!e&&!d&&!a&&multiRange.length>0&&f!=46){highlightRange(multiRange,"cell");multiRange=new Array();isShiftDown=0;isMouseDown=0}}if(!e&&!d&&f!=0){if(f==33){if(currRow-10<=row0&&currRow>10){row0-=rows;display();mouseoverCell(currRow-10,currCol);scrollDown()}else{mouseoverCell(currRow>=10?currRow-10:0,currCol);scrollUp()}b=false}else{if(f==34){if(currRow+10>=row0+rows){row0+=rows;display();mouseoverCell(currRow+10,currCol);scrollUp()}else{mouseoverCell(currRow+10,currCol);scrollDown()}b=false}else{if(f==36){if(currCol!=col0){mouseoverCell(currRow,col0)}else{if(currCol+1>=cols){col0-=cols;display();mouseoverCell(currRow,currCol-cols)}else{if(currRow>row0){mouseoverCell(row0,currCol)}else{if(currRow+1>rows){row0-=rows;display();mouseoverCell(currRow-rows,currCol)}}}}scrollLeft();b=false}else{if(f==35){if(currCol!=(col0+cols-1)){mouseoverCell(currRow,col0+cols-1)}else{col0+=cols;display();mouseoverCell(currRow,currCol+cols)}scrollRight();b=false}else{if(f==39||f==9){goRight();b=false}else{if(f==40){goDown();b=false}else{if(f==38&&currRow>-2){goUp();b=false}else{if(f==37&&currCol>-1){goLeft();b=false}else{if(!a&&f==46&&isWriteable&&confirm(trans("Really empty cell(s) ?"))){removeSelectedCell();b=false}else{if((f<33||f>40)&&f!=46&&f!=45&&f!=16&&f!=17&&f!=18){editCell(currRow,currCol,f);if(f==13){b=false}}}}}}}}}}}}if(isShiftDown){highlightRange(multiRange,"cell");multiRange[2]=currRow;multiRange[3]=currCol;highlightRange(multiRange,"cell_highlight_over")}}else{if(f==13){saveCell();b=false}else{if(f==27){cancelCell();b=false}}}return b}function goLeft(){if(currCol<=col0&&currCol>0){col0-=cols;display();mouseoverCell(currRow,currCol-1);scrollRight()}else{mouseoverCell(currRow,currCol-1);scrollLeft()}}function goUp(){if(currRow<=row0&&currRow>0){row0-=rows;display();mouseoverCell(currRow-1,currCol);scrollDown()}else{mouseoverCell(currRow-1,currCol);scrollUp()}}function goRight(){if(currCol+1>=col0+cols){col0+=cols;display();mouseoverCell(currRow,currCol+1);scrollLeft()}else{mouseoverCell(currRow,currCol+1);scrollRight()}}function goDown(){if(currRow+1>=row0+rows){row0+=rows;display();mouseoverCell(currRow+1,currCol);scrollUp()}else{mouseoverCell(currRow+1,currCol);scrollDown()}}function display(){marks=new Array();isMouseDown=0;var n=0;var l=0;if(getObj("content")){n=getObj("content").scrollLeft;l=getObj("content").scrollTop}var r="";if(isWriteable){r+='<div class="blockbar">';r+='<div class="blockbarItem" onclick="load(init_data); resetPath();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filenew.png" /><div class="blockbarText">'+trans("New")+"</div></div>";r+='<div class="blockbarItem" onclick="loadCode();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/fileopen.png" /><div class="blockbarText">'+trans("Open")+"</div></div>";r+='<div class="blockbarItem" onclick="saveCode();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filesave.png" /><div class="blockbarText">'+trans("Save")+"</div></div>";r+='<div class="blockbarItem" onclick="saveAs();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/filesaveas.png" /><div class="blockbarText">'+trans("Save As")+"</div></div>";r+='<span class="blockbarline" /></span>';r+='<div class="blockbarItem" onclick="insertRow();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/newrow.png" /><div class="blockbarText">'+trans("Ins. Row")+"</div></div>";r+='<div class="blockbarItem" onclick="insertColumn();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/newcolumn.png" /><div class="blockbarText">'+trans("Ins. Column")+"</div></div>";r+='<div class="blockbarItem" onclick="deleteRow();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/deleterow.png" /><div class="blockbarText">'+trans("Del. Row")+"</div></div>";r+='<div class="blockbarItem" onclick="deleteColumn();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/deletecolumn.png" /><div class="blockbarText">'+trans("Del. Column")+"</div></div>";r+='<span class="blockbarline" /></span>';r+='<div class="blockbarItem" onclick="print();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/agt_print.png" /><div class="blockbarText">'+trans("Print")+"</div></div>";r+='<div class="blockbarItem_right" onclick="help();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/help.png" /><div class="blockbarText">'+trans("Help")+"</div></div>";r+='<div class="blockbarItem_right" onclick="fullScreen();" ><img class="blockbarImg" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/22x22/fullScreen.png" /><div class="blockbarText">'+trans("Full Screen")+"</div></div>";r+="</div>"}r+="<textarea id='focus' onfocus='this.blur();'></textarea><div id='header' class='header'><table cellpadding='0' cellspacing='0' style='width:100%;'><tr><td nowrap>";r+="<input type='text' value='' title='"+trans("Position")+"' id='field' style='width:30px; text-align:center;' onfocus='active=\"position\";' onblur='active=\"content\";' accesskey='g'> &nbsp;";r+="</td><td nowrap style='width:100%;'>";r+="<iframe src='about:blank' id='multiline'></iframe>";r+="<input type='text' value='' title='"+trans("Formula")+"' id='value' style='width:100%;' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ";r+="<input type='hidden' title='"+trans("Style")+"' value='' id='styling' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ";r+="</td><td nowrap>";if(isWriteable){r+="&nbsp; <input type='button' value='"+trans("Save")+"' id='save' onclick='saveCell();' disabled>&nbsp;";r+="<input type='button' value='"+trans("X")+"' id='cancel' onclick='cancelCell();' disabled>"}r+="</td></tr></table></div>";var t="";if(agent=="msie"){t="style='height:expression((document.body.clientHeight-40)+\"px\");'"}r+="<div id='content' "+t+"><table id='table' cellspacing='0'>";r+="<tr>";if(showColumnGroups){r+="<th id='-2_-1' ondblclick='editCell(-2,-1);' onclick='mouseoverCell(-2,-1);'>"+htmlEscape(showCell(-2,-1,0),true)+"</th>";for(var q=col0;q<cols+col0;q++){var k=showCell(-2,q,0);if(k&&(!marks[-2]||!marks[-2][q])){var f=getCellStyle(-2,q,"colspan");if(f){if(!marks[-2]){marks[-2]=new Array()}for(var j=q+1;j<q+f;j++){marks[-2][j]=new Array(-2,q)}}r+="<th id='-2_"+q+"' ondblclick='editCell(-2,"+q+",0);' onclick='mouseoverCell(-2,"+q+");' colspan='"+f+"'><div style='"+htmlEscape(formatStyle(getCells(-2,q,1),"_"),false)+"'>"+htmlEscape(k,true)+"</div></th>"}else{if((!marks[-2]||!marks[-2][q])){r+="<th id='-2_"+q+"' ondblclick='editCell(-2,"+q+",0);' onclick='mouseoverCell(-2,"+q+");'>&nbsp;</th>"}}}}r+="</tr>";r+="<tr><th id='-1_-1' ondblclick='editCell(-1,-1,0);' onclick='mouseoverCell(-1,-1);'>"+htmlEscape(showCell(-1,-1,0),true)+"</th>";for(var q=col0;q<cols+col0;q++){var d=showCell(-1,q,0);r+="<th id='-1_"+q+"' ondblclick='editCell(-1,"+q+",0);' onclick='mouseoverCell(-1,"+q+");'><div style='"+htmlEscape(formatStyle(getCells(-1,q,1),"_"),false)+"'>"+(d?htmlEscape(d,true)+" - ":"")+buildColName(q)+"</div></th>"}r+="</tr>";var u=-1;var g=false;for(var e=row0;e<rows+row0;e++){r+="<tr>";var a=showCell(e,-1,0);r+="<th id='"+e+"_-1' ondblclick='editCell("+e+",-1,0);' onclick='mouseoverCell("+e+",-1);'><div style='"+htmlEscape(formatStyle(getCells(e,-1,1),"_"),false)+"'>"+(a?htmlEscape(a,true)+"<br>":"")+(e+1)+"</div></th>";for(var c=col0;c<cols+col0;c++){if(view=="values"){if(!marks[e]||!marks[e][c]){var t=getCells(e,c,1);var m=showCell(e,c,0);var f=getCellStyle(e,c,"colspan");if(f){if(!marks[e]){marks[e]=new Array()}for(var j=c+1;j<c+f;j++){marks[e][j]=new Array(e,c)}}var b=getCellStyle(e,c,"rowspan");if(b){for(var j=e+1;j<e+b;j++){if(!marks[j]){marks[j]=new Array()}marks[j][c]=new Array(e,c)}}m=formatValue(m,t);t=htmlEscape(formatStyle(t,m),false);r+="<td "+(b?"rowspan='"+b+"'":"")+" "+(f?"colspan='"+f+"'":"")+" id='"+e+"_"+c+"' onmousedown='mousedown("+e+","+c+");' onmouseup='mouseup();' onmouseover='buildStatus("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' ondblclick='editCell("+e+","+c+",0);'><div style='"+t+"'>"+htmlEscape(m,true)+"</div></td>"}}else{if(view=="formulas"){r+="<td id='"+e+"_"+c+"' onmouseover='buildStatus("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' ondblclick='editCell("+e+","+c+",0);'>"+htmlEscape(getCells(e,c,0),true)+"</td>"}else{r+="<td id='"+e+"_"+c+"' onmouseover='buildStatus("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' onclick='mouseoverCell("+e+","+c+");' ondblclick='editCell("+e+","+c+",0);'>"+htmlEscape(getCells(e,c,1),true)+"</td>"}}}r+="</tr>"}r+="<tr id='spacer'><th class='empty'></th>";for(var q=col0;q<cols+col0;q++){r+="<th class='empty'><img src='' style='width:"+col_min_width+"; height:0px;'></th>"}r+="</tr>";r+="</table></div>";r+="<div class='footer' id='footer' onmouseover='getObj(\"status\").innerHTML=\"\";'>&nbsp;";if(allowPaging){if(col0-cols>=0){r+="<a href='#' onclick='col0 -= cols; currCol -= cols; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/back.png'></a> "}else{r+="<img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/back.png'> "}r+="<a href='#' onclick='col0 += cols; currCol += cols; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/forward.png'></a> ";if(row0-rows>=0){r+="<a href='#' onclick='row0 -= rows; currRow -= rows; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/restore.png'></a> "}else{r+=" <img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/restore.png'> "}r+="<a href='#' onclick='row0 += rows; currRow += rows; display(); return false;'><img border='0' src='index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=icons/16x16/download.png'></a> "}r+="</div>";r+="<div class='statusText'> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "+trans("Sheet Size")+": <input type='text' value='"+cols+"' style='width:28px; text-align:center;' id='cols' onfocus='active=\"dimensions\";' onblur='active=\"content\";'> x <input type='text' value='"+rows+"' style='width:28px; text-align:center;' id='rows' onfocus='active=\"dimensions\";' onblur='active=\"content\";'></div>";r+="<div id='status' class='status'></div>";getObj("data").innerHTML=r;getObj("content").scrollLeft=n;getObj("content").scrollTop=l;mouseoverCell(currRow,currCol);if(clipboard_mode!=""){var o="#DDDDFF";if(clipboard_mode=="cut"){o="#FFDDDD"}if(clipboard_range.length>0){highlightRange(clipboard_range,"",o)}else{var h=resolveCell(clipboard_row,clipboard_col);if(h){h.style.backgroundColor=o}}}getObj("focus").focus()}function showHeaderFooter(a){if(isWriteable){return}if(a){getObj("content").style.top="23px";getObj("content").style.bottom="18px";getObj("header").style.display="";getObj("footer").style.display="";getObj("status").style.display=""}else{getObj("content").style.top="0px";getObj("content").style.bottom="0px";getObj("header").style.display="none";getObj("footer").style.display="none";getObj("status").style.display="none"}}function previewValue(){var a=getObj("value").value;if(!getObj("value").disabled&&(a.length>25||a.indexOf("\\n")!=-1||a.indexOf("html:")==0)){getObj("multiline").style.display="inline";if(getObj("multiline").contentWindow.update){getObj("multiline").contentWindow.update()}}previewField()}function previewField(){var b=resolveCell(currRow,currCol);value=previewCell(getObj("value").value,0);value=formatValue(value,getObj("styling").value);var a=htmlEscape(formatStyle(getObj("styling").value,value),false);if(currRow==-1){if(value!=""){value+=" - "}value+=buildColName(currCol)}else{if(currCol==-1){if(value!=""){value+="\\n"}value+=currRow+1}}value=htmlEscape(value,true);var c="<div "+(a?"style='"+a+"'":"")+">"+value+"</div>";b.innerHTML=c;if(c.indexOf("<img")!=-1){b.style.height=b.offsetHeight+"px"}if(currRow==-1||currCol==-1){highlightCellHeader(currRow,currCol)}}function previewMultiline(a){getObj("value").value=a.replace(/\n/g,"\\n").replace(/\r/g,"");previewField()}function log(b){if(!getObj("tconsole")){var a=document.createElement("textarea");a.id="tconsole";document.body.appendChild(a)}getObj("tconsole").value+=(getObj("tconsole").value.split("\n").length)+": "+b+"\n"}function manual(){window.open("manual.html","manual","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600")}function isWritable(a){if(a.indexOf("readonly:true")==-1&&isWriteable){return true}return false}function getCells(c,a,b){if(cells[c]&&cells[c][a]&&cells[c][a].length==4){return cells[c][a][b]}return""}function getCellsR(d,b,c){var a=resolveCellArray(d,b);return getCells(a[0],a[1],c)}function getCells2(b,g,c,a){var f=colstrToColnum(b);var d=showCell(g-1,f,a+1);var e=parseFloat(d);if(e==d){return e}else{return d}}function getCells3(e,l,f,h,k,m){var n=new Array();var b=colstrToColnum(e);var j=colstrToColnum(f);if(b>j||l>h){return new Array("error")}for(var a=l;a<=h;a++){for(var d=b;d<=j;d++){var g=showCell(a-1,d,m+1);var c=parseFloat(g);if(c==g){n[n.length]=c}else{n[n.length]=g}}}return n}function getCellStyle(e,a,d){var c=getCells(e,a,1);var b=new RegExp(d+":(.*?);","i");if(p=b.exec(c)){c=parseInt(p[1])}else{c=0}return c}function setCells(d,a,b,c){if(!cells[d]){cells[d]=new Array()}if(!cells[d][a]){cells[d][a]=new Array("","","","")}if(cells[d][a][b]!=c){cells[d][a][b]=c;return true}else{return false}}function setCellsR(e,b,c,d){var a=resolveCellArray(e,b);return setCells(a[0],a[1],c,d)}function loadScriptFile(a){var b=document.createElement("script");b.type="text/javascript";b.src=a;document.getElementsByTagName("head").item(0).appendChild(b)}function loadStyleFile(a){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a;document.getElementsByTagName("head").item(0).appendChild(b)}function load(code){if(code.indexOf("dbCells")==-1){if(code.indexOf(tab)==-1){cells=loadCSV(code)}else{cells=loadTSV(code)}if(!cells){return}}else{try{eval(code)}catch(err){return}window.registerFuncs=registerFuncs;if(registerFuncs){for(var i=0;i<registerFuncs.length;i++){window[registerFuncs[i]]=eval(registerFuncs[i])}}cells=new Array();try{for(var i=0;i<dbCells.length;i++){if(!dbCells[i]){continue}if(!cells[dbCells[i][1]]){cells[dbCells[i][1]]=new Array()}cells[dbCells[i][1]][dbCells[i][0]]=new Array(dbCells[i][2],dbCells[i][3],dbCells[i][4],"")}}catch(err){return}}if(typeof cells[-2]!="undefined"){showColumnGroups=true}else{showColumnGroups=false}active="content";getObj("source").style.display="none";getObj("data").style.display="inline";display()}function cancelLoad(){active="content";getObj("source").style.display="none";getObj("data").style.display="inline";display()}function loadCSV(b){b=b.replace(/([^,])""([^,])/g,"$1#quot#$2").replace(/\r/g,"");b=b.replace(/(".*?")/g,function(c){return c.replace(/,/g,"#comm#")});b=b.replace(/([^,])""([^,])/g,"$1#quot#$2");b=b.split("\n");for(var a=0;a<b.length;a++){b[a]='["'+b[a].replace(/^"|"\s*$/g,"").replace(/"?,"?/g,'","')+'"]';if(a!=b.length-1){b[a]+=","}}b="dbCells = [\n"+b.join("\n")+"\n];\n";b=b.replace(/#comm#/g,",").replace(/#quot#/g,'\\"');return loadDbCells(b)}function loadTSV(b){b=b.replace(/^\/\/.*?\n/g,"").replace(/\r/g,"").split("\n");for(var a=0;a<b.length;a++){b[a]='["'+b[a].replace(/"/g,'\\"').replace(/	/g,'","')+'"]';if(a!=b.length-1){b[a]+=","}}b="dbCells = [\n"+b.join("\n")+"\n];\n";b=b.replace(/\[""\],\n/g,"");return loadDbCells(b)}function loadDbCells(code){try{eval(code)}catch(err){return false}cells=new Array();try{for(var i=0;i<dbCells.length;i++){for(var i2=0;i2<dbCells[i].length;i2++){if(dbCells[i][i2]){if(!cells[i-1]){cells[i-1]=new Array()}cells[i-1][i2]=new Array(dbCells[i][i2]+"","","","")}}}}catch(err){return false}return cells}function save(b){active="code";getObj("status").innerHTML="";var a="";if(b=="csv"){a=cellsToCSV()}else{if(b=="tsv"){a=cellsToTSV()}else{a=cellsToJS()}}getObj("data").style.display="none";getObj("source").style.display="inline";getObj("code").value=a}function cellsToJS(){var out="";out+="dbCells = [\n";for(var i=-2;i<cells.length;i++){if(cells[i]){for(var i2=-1;i2<cells[i].length;i2++){if(!cells[i][i2]){continue}if(cells[i][i2][0]==""&&cells[i][i2][1]==""){continue}out+="  ["+i2+","+i+',"'+strescape(cells[i][i2][0])+'","'+strescape(cells[i][i2][1])+'"';if(cells[i][i2][2]&&isNaN(cells[i][i2][2])){out+=',"'+strescape(cells[i][i2][2])+'"'}else{if(cells[i][i2][2]){out+=","+cells[i][i2][2]}}out+="], // "+buildColName(i2)+(i+1)+"\n"}out+="\n"}}if(cells.length>0){out=out.substring(0,out.length-2)+"\n];\n"}else{out+="];\n"}if(registerFuncs){out+="\nvar registerFuncs = [";for(var i=0;i<registerFuncs.length;i++){out+='"'+registerFuncs[i]+'",'}out=out.substring(0,out.length-1)+"];\n\n";for(var i=0;i<registerFuncs.length;i++){out+=eval(registerFuncs[i])+"\n\n"}out=out.substring(0,out.length-2)}return out}function cellsToCSV(){var a="";for(var b=-1;b<cells.length;b++){if(cells[b]){for(var c=0;c<cells[b].length;c++){if(cells[b][c]&&cells[b][c][0]){if(b==-1&&cells[b][c][2]){a+='"'+cells[b][c][2].replace(/\\/g,"\\\\").replace(/"/g,'""')+'",'}else{var d=showCell(b,c);if(isNaN(d)){a+='"'+d.replace(/\\/g,"\\\\").replace(/"/g,'""')+'",'}else{a+=d+","}}}else{a+=","}}a=a.substring(0,a.length-1)+"\n"}else{a+=",\n"}}return a}function cellsToTSV(){var a="// "+trans("Copy / paste this code to other spreadsheet applications (e.g. Excel)")+":\n\n";for(var b=-1;b<cells.length;b++){if(cells[b]){for(var c=0;c<cells[b].length;c++){if(cells[b][c]&&cells[b][c][0]){if(b==-1&&cells[b][c][2]){a+=cells[b][c][2]+tab}else{a+=showCell(b,c)+tab}}else{a+=tab}}a=a.substring(0,a.length-1)+"\n"}else{if(b==-1){a+=tab+"\n"}}}return a}function addHiddenParam(b,a,c){param=document.createElement("input");b.appendChild(param);param.setAttribute("type","hidden");param.setAttribute("name",a);param.setAttribute("value",c)}function saveSGS(){var c="index.php?view="+escape(sgs_view)+"&folder="+escape(sgs_folder);if(sgs_view=="edit"){c+="&form_submit_edit=checked"}else{c+="&form_submit_create=checked"}var b="";var a=0;var g=document.createElement("form");for(var e=0;e<cells.length;e++){if(cells[e]){var h=e;if(cells[-1][0][2]=="id"&&cells[e][0]&&cells[e][0][3]!=""){h=cells[e][0][3]}addHiddenParam(g,"form_fields[]",h);addHiddenParam(g,"form_"+h+"_folder",escape(sgs_folder));a++;for(var f=0;f<cells[-1].length;f++){var d="";if(cells[-1]&&cells[-1][f]){if(cells[-1][f][2]){d=cells[-1][f][2]}else{d=cells[-1][f][0]}}if(d){addHiddenParam(g,"form_"+h+"_"+d,showCell(e,f))}}}}g.action=c+"&limit="+a;g.method="POST";g.style.display="none";document.body.appendChild(g);g.submit()}function loadSheetFromUrl(a){var b=document.createElement("script");b.type="text/javascript";if(window.addEventListener){window.addEventListener("load",function(){load("// dbCells")},false)}else{b.onreadystatechange=function(){if(this.readyState=="loaded"){load("// dbCells")}}}b.src=a;document.getElementsByTagName("head").item(0).appendChild(b)}function resetPath(){window.parent.sendMsg($checknum,"resetPath","")}function saveCode(){window.parent.sendMsg($checknum,"saveFile","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveCodeClose(){window.parent.sendMsg($checknum,"yDelete","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveAs(){window.parent.sendMsg($checknum,"saveAs","")}function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function help(){window.parent.sendMsg($checknum,"help","")}function fullScreen(){window.parent.sendMsg($checknum,"fullScreen","")}function print(){var a=document.getElementById("content").innerHTML;a=a.replace(/(<\/tr>|<\/table>)/g,"$1\n");var b=window.open("","print","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600");b.document.write("<html><head><link media='all' href='"+printstyle+"' rel='stylesheet' type='text/css'/></head>\n");b.document.write("<body>\n"+a+"\n</body></html>");b.document.close();b.window.print()}function insertRow(){for(var a=cells.length-1;a>=currRow;a--){if(cells[a]){for(var b=0;b<cells[a].length;b++){if(!cells[a][b]){continue}if(!cells[a+1]){cells[a+1]=new Array()}cells[a+1][b]=cells[a][b];cells[a][b]=""}}}display()}function deleteRow(){var d=currRow;var c=currRow;if(multiRange.length>0){var f=getMultiRange(multiRange);d=f[0];c=f[2]}for(var e=d;e<=c;e++){for(var a=d;a<cells.length;a++){if(cells[a]){for(var b=0;b<cells[a].length;b++){if(!cells[a+1]){cells[a+1]=new Array()}if(!cells[a+1][b]&&cells[a][b]){cells[a][b]=""}if(!cells[a+1][b]&&!cells[a][b]){continue}cells[a][b]=cells[a+1][b];cells[a+1][b]=""}}}}display()}function insertColumn(){for(var a=0;a<cells.length;a++){if(cells[a]){for(var b=cells[a].length-1;b>=currCol;b--){if(!cells[a][b]){continue}cells[a][b+1]=cells[a][b];cells[a][b]=""}}}display()}function deleteColumn(){var e=currCol;var d=currCol;if(multiRange.length>0){var f=getMultiRange(multiRange);e=f[1];d=f[3]}for(var a=e;a<=d;a++){for(var b=0;b<cells.length;b++){if(cells[b]){for(var c=e;c<cells[b].length;c++){if(!cells[b][c+1]&&cells[b][c]){cells[b][c]=""}if(!cells[b][c+1]&&!cells[b][c]){continue}cells[b][c]=cells[b][c+1];cells[b][c+1]=""}}}}display()}function scroll(){scrollDown();scrollUp();scrollRight();scrollLeft()}function scrollUp(){var a=resolveCell(currRow,currCol);var b=findPosY(a);if(b<(getObj("content").scrollTop+100)&&getObj("content").scrollTop>(b-100)){getObj("content").scrollTop=b-100}var c=findPosX(a);if(c<getObj("content").scrollLeft+200&&getObj("content").scrollLeft>(c-150)){getObj("content").scrollLeft=c-150}}function scrollDown(){var e=resolveCell(currRow,currCol);var f=findPosY(e);var a=return_height();if(e&&(f+e.offsetHeight+100)>a){var b=f+e.offsetHeight+100-a;if(b>getObj("content").scrollTop){getObj("content").scrollTop=b}}var g=findPosX(e);var c=return_width();if(e&&(g+e.offsetWidth+100)>c){var d=g+e.offsetWidth+100-c;if(d>getObj("content").scrollLeft){getObj("content").scrollLeft=d}}}function scrollLeft(){scrollUp()}function scrollRight(){scrollDown()}function removeSelectedCell(){if(multiRange.length>0){var d=getMultiRange(multiRange);for(var c=d[0];c<=d[2];c++){for(var a=d[1];a<=d[3];a++){if(isWritable(getCellsR(c,a,1))){setCellsR(c,a,0,"");setCellsR(c,a,1,"");if(!auto_recalc){var b=resolveCell(c,a);b.innerHTML="<div>&nbsp;</div>"}}}}}else{removeCell(currRow,currCol);if(!auto_recalc&&isWritable(getCellsR(currRow,currCol,1))){var b=resolveCell(currRow,currCol);b.innerHTML="<div>&nbsp;</div>"}}if(auto_recalc){display()}}function cutcopy(c,a){if(!isWriteable){return}if(clipboard_range.length>0){highlightRange(clipboard_range,"","")}else{if(clipboard_mode){var b=resolveCell(clipboard_row,clipboard_col);if(b){b.style.backgroundColor=""}}}clipboard_mode=c;clipboard_row=currRow;clipboard_col=currCol;clipboard_range=getMultiRange(multiRange);if(multiRange.length>0){highlightRange(multiRange,"",a)}else{var b=resolveCell(currRow,currCol);if(b){b.style.backgroundColor=a}}}function paste(){if(clipboard_range.length>0){var d=getMultiRange(clipboard_range);var g=new Array(currRow,currCol,currRow+d[2]-d[0],currCol+d[3]-d[1]);if(multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3])){g=getMultiRange(multiRange)}var a=0;var b=0;if((g[0]>=d[0]&&g[1]>=d[1])||(g[0]>d[0]&&g[1]<d[1])){for(var f=g[2];f>=g[0];f--){a=(f-g[0])%(d[2]-d[0]+1);for(var c=g[3];c>=g[1];c--){b=(c-g[1])%(d[3]-d[1]+1);copyCell(d[0]+a,d[1]+b,f,c);var e=resolveCell(d[0]+a,d[1]+b);if(e){e.style.backgroundColor=""}}}}else{for(var f=g[0];f<=g[2];f++){a=(f-g[0])%(d[2]-d[0]+1);for(var c=g[1];c<=g[3];c++){b=(c-g[1])%(d[3]-d[1]+1);copyCell(d[0]+a,d[1]+b,f,c);var e=resolveCell(d[0]+a,d[1]+b);if(e){e.style.backgroundColor=""}}}}if(clipboard_mode=="cut"){for(var f=d[0];f<=d[2];f++){for(var c=d[1];c<=d[3];c++){if((f<g[0]||f>g[2])||(c<g[1]||c>g[3])){removeCell(f,c)}}}clipboard_mode=""}}else{if(multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3])){g=getMultiRange(multiRange);for(var f=g[2];f>=g[0];f--){for(var c=g[3];c>=g[1];c--){copyCell(clipboard_row,clipboard_col,f,c)}}if(clipboard_mode=="cut"&&(clipboard_row<g[0]||clipboard_row>g[2]||clipboard_col<g[1]||clipboard_col>g[3])){removeCell(clipboard_row,clipboard_col)}}else{copyCell(clipboard_row,clipboard_col,currRow,currCol);if(clipboard_mode=="cut"&&(clipboard_row!=currRow||clipboard_col!=currCol)){removeCell(clipboard_row,clipboard_col)}}if(clipboard_mode=="cut"){clipboard_mode=""}}display()}function sortNum(a){if(isNaN(a)){return a.charAt(0).toLowerCase().charCodeAt(0)}return parseFloat(a)}function sortCells(d,c){if(d[currCol]&&c[currCol]){if(d[currCol][3]==""){return 1}if(c[currCol][3]==""){return -1}d=sortNum(d[currCol][3]);c=sortNum(c[currCol][3]);return d-c}return(d[currCol]?1:-1)}function sort(c){if(multiRange.length>0){var e=getMultiRange(multiRange);var a=new Array();for(var d=e[0];d<=e[2];d++){for(var b=e[1];b<=e[3];b++){if(!a[d]){a[d]=new Array()}if(cells[d]&&cells[d][b]){a[d][b]=cells[d][b]}}}if(c){a=a.sort(sortCells)}else{a=a.sort(sortCells).reverse()}for(var d=e[0];d<=e[2];d++){for(var b=e[1];b<=e[3];b++){if(!cells[d]){cells[d]=new Array()}cells[d][b]=a[d][b]}}}else{if(c){cells=cells.sort(sortCells)}else{cells=cells.sort(sortCells).reverse()}}display()}function buildStatus(j,c){var e="";var a=getCellsR(-1,c,0);var f=getCellsR(-2,c,0);var g=getCellsR(j,c,2);if(g&&j!=-1){e+=g+" - "}if(a){var d=getCellsR(-1,c,2);if(f){e+=f+": "}e+=(d?d:a)+" - "}else{if(f){e+=f+" - "}}var h=getCellsR(j,-1,0);if(h){var b=getCellsR(j,-1,2);e+=(b?b:h)+" - "}getObj("status").innerHTML=e+buildColName(c)+(j+1);if(isMouseDown){markCell(j,c);highlightRange(multiRange,"cell");multiRange[2]=j;multiRange[3]=c;highlightRange(multiRange,"cell_highlight_over")}}function highlightRange(c,d,a){if(c.length==0){return false}var f=getMultiRange(c);for(var e=f[0];e<=f[2];e++){for(var b=f[1];b<=f[3];b++){obj=resolveCell(e,b);if(obj&&d){obj.className=d}else{if(!d&&obj){obj.style.backgroundColor=a}}}}}function getMultiRange(a){if(a.length==0){return new Array()}var d=a[0]>a[2]?a[2]:a[0];var b=a[0]>a[2]?a[0]:a[2];var e=a[1]>a[3]?a[3]:a[1];var c=a[1]>a[3]?a[1]:a[3];return new Array(d,e,b,c)}function mousedown(b,a){if(getObj("styling").disabled){document.onmousedown=new Function("return false;");document.onselectstart=new Function("return false;");isMouseDown=1;highlightRange(multiRange,"cell");multiRange=new Array(b,a,b,a);highlightRange(multiRange,"cell_highlight_over")}}function mouseup(){if(getObj("styling").disabled){document.onmousedown="";document.onselectstart="";isMouseDown=0}}function markCell(b,a){highlightCell(b,a,"cell_highlight_over");highlightCellHeader(b,a);currRow=b;currCol=a;getObj("value").value=getCellsR(b,a,0);getObj("styling").value=getCellsR(b,a,1);getObj("field").value=buildColName(a)+(b+1)}function mouseoverCell(e,b){if(getObj("styling").disabled){if(e==currRow&&b==currCol&&getObj("field").value){editCell(e,b,0)}else{markCell(e,b);buildStatus(e,b)}}else{if(!getObj("value").disabled){var d=getObj("value");var a=buildColName(b)+(e+1);if(d.selectionStart){var c=d.selectionStart;d.value=d.value.substring(0,d.selectionStart)+a+d.value.substring(d.selectionStart);d.selectionStart=c+a.length;d.selectionEnd=c+a.length;d.focus()}else{if(document.selection){d.value+=a}}previewValue()}}}function highlightCell(d,a,b){var c=resolveCell(currRow,currCol);if(c){c.className="cell"}c=resolveCell(d,a);if(c){c.className=b}}function highlightCellHeader(d,b){var c=resolveCell(-1,currCol);if(c){c.className="border"}c=resolveCell(currRow,-1);if(c){c.className="border"}var a=-1;if(d<-1){a=-2}c=resolveCell(a,b);if(c){c.className="border_highlight"}if(d>=-1){c=resolveCell(d,-1);if(c){c.className="border_highlight"}}}function showCell(row,col,calls){if(typeof calls=="undefined"){calls=0}value=getCells(row,col,0);if(calls>25){value="undefined"}else{if(value!=""&&value.charAt(0)=="="){var cmd="";var token="";var openToken="";var sequence="";for(var i=0;i<value.length;i++){token=value.charAt(i);sequence+=token;if(((token=="'"||token=='"')&&openToken=="")||i==value.length-1){if(openToken==""){sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")");sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")}openToken=token;cmd+=sequence;sequence=""}else{if(token==openToken&&value.charAt(i-1)!="\\"){openToken="";cmd+=sequence;sequence=""}}}try{eval("value"+cmd)}catch(err){}}}if(cells[row]&&cells[row][col]){cells[row][col][3]=value}return value}function previewCell(value,calls){if(value==""||value.charAt(0)!="="){return value}if(calls>25){return"undefined"}var cmd="";var token="";var openToken="";var sequence="";for(var i=0;i<value.length;i++){token=value.charAt(i);sequence+=token;if(((token=="'"||token=='"')&&openToken=="")||i==value.length-1){if(openToken==""){sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")");sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")}openToken=token;cmd+=sequence;sequence=""}else{if(token==openToken&&value.charAt(i-1)!="\\"){openToken="";cmd+=sequence;sequence=""}}}var nvalue="";try{eval("nvalue"+cmd)}catch(err){}if(nvalue!=null&&(nvalue+"").length>0){return nvalue}else{return value}}function gotoCell(d){var b=new RegExp("([@A-Z]+)([0-9]+)","g");if(p=b.exec(d)){var a=colstrToColnum(p[1]);var c=p[2]-1;if(a>=-1&&c>=0){getObj("focus").focus();if(a!=currCol||c!=currRow){if(a>=cols||c<=rows){col0=a-(a%cols);row0=c-(c%rows);display()}mouseoverCell(c,a);scroll()}return}}}function editCell(c,a,b){active="content";if(!isWriteable){return}if(!getObj("styling").disabled){cancelCell()}highlightCell(c,a,"cell_highlight");highlightCellHeader(c,a);currRow=c;currCol=a;if(isWritable(getCellsR(c,a,1))){getObj("value").disabled=false}getObj("styling").disabled=false;getObj("save").disabled=false;getObj("cancel").disabled=false;if(getObj("cols")){getObj("cols").disabled=true}if(getObj("rows")){getObj("rows").disabled=true}getObj("field").disabled=true;getObj("styling").value=getCellsR(c,a,1);if(b>32&&agent=="firefox"&&!getObj("value").disabled){getObj("value").value=String.fromCharCode(b)}else{getObj("value").value=getCellsR(c,a,0)}if(!getObj("value").disabled){getObj("value").focus()}else{getObj("styling").focus()}}function copyCell(c,a,b,d){if(!isWritable(getCellsR(b,d,1))){return}if(c!=b||a!=d){setCells(b,d,0,getCellsR(c,a,0));setCells(b,d,1,getCellsR(c,a,1))}}function saveCell(){var b=setCellsR(currRow,currCol,0,getObj("value").value);var a=setCellsR(currRow,currCol,1,getObj("styling").value);if(b||a){if(!auto_recalc){disableEdit();previewValue()}else{display()}}else{cancelCell()}}function disableEdit(){getObj("value").blur();highlightCell(currRow,currCol,"cell_highlight_over");getObj("value").disabled=true;getObj("styling").disabled=true;getObj("save").disabled=true;getObj("cancel").disabled=true;if(getObj("cols")){getObj("cols").disabled=false}if(getObj("rows")){getObj("rows").disabled=false}getObj("field").disabled=false;getObj("multiline").style.display="none";getObj("content").style.overflow="auto"}function cancelCell(){disableEdit();getObj("value").value=getCellsR(currRow,currCol,0);getObj("styling").value=getCellsR(currRow,currCol,1);previewValue()}function removeCell(b,a){if(!isWritable(getCellsR(b,a,1))){return}setCellsR(b,a,0,"");setCellsR(b,a,1,"")}function resolveCell(c,a){var b=getObj(c+"_"+a);if(!b&&marks[c]&&marks[c][a]){b=getObj(marks[c][a][0]+"_"+marks[c][a][1])}return b}function resolveCellArray(d,b){var c=getObj(d+"_"+b);if(!c&&marks[d]&&marks[d][b]){var a=marks[d][b];d=a[0];b=a[1]}return new Array(d,b)}function getSize(c){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=window.document.documentElement.clientWidth;a=window.document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}else{if(self.screen.height&&self.screen.width){b=self.screen.width;a=self.screen.height}}}}if(c){return b}else{return a}}function return_height(){return getSize(0)}function return_width(){return getSize(1)}function getObj(a){return document.getElementById(a)}function getmykey(a){if(typeof(a)=="undefined"){return window.event.keyCode}if(a.keyCode==0&&a.charCode!=0){return a.charCode}if(a.keyCode==0){return a.which}return a.keyCode}function findPosY(b){if(!b){return 0}var a=0;if(b.offsetParent){while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent}}else{if(b.y){a+=b.y}}return a}function findPosX(b){if(!b){return 0}var a=0;if(b.offsetParent){while(b.offsetParent){a+=b.offsetLeft;b=b.offsetParent}}else{if(b.x){a+=b.x}}return a}function strescape(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function htmlEscape(b,a){if(b==null||b.length==0){return(a?"&nbsp;":"")}b=new String(b);if(b.indexOf("html:")==0){b=b.substring(5)}else{b=b.replace(/</g,"&lt;").replace(/>/g,"&gt;");b=b.replace(/'/g,"&#039;").replace(/"/g,"&quot;");b=b.replace(/([^\s$]+@[^\s$]+)/g,"<a href='$1'>$1</a>");b=b.replace(/img:((http[s]?:\/\/[^\s$]+\.(gif|jpg|png))|(graphs\.php\?.*?$))/g,"<img src='$1'>");b=b.replace(/(^|[^'])(http[s]?:\/\/[^\s$]+)/g,"$1<a target='_blank' href='$2'>$2</a>");b=b.replace(/\\n/g,"<br>")}return b}function handleErr(c,b,a){return true}function buildColName(b){var c="";var a="";if(b>=702){c=(Math.floor(b/676)-1)%26;a+=String.fromCharCode(c+65)}if(b>=26){c=(Math.floor(b/26)-1)%26;a+=String.fromCharCode(c+65)}a+=String.fromCharCode(b%26+65);return a}function colstrToColnum(b){var c=0;for(var a=0;a<b.length;a++){c+=26*(b.length-a-1)+(b.charCodeAt(a)-65)}return c}function formatStyle(a,b){if(a.indexOf("text-align:")==-1&&b.length>0&&!isNaN((b+"").replace(/[$%,]/g,"").replace("&euro;",""))){a+="; text-align:right; white-space:nowrap;";if(b<0&&a.indexOf("color:")==-1){a+="color:#FF0000;"}}return a.replace(/(format|readonly|colspan|rowspan):.*?;/ig,"")}function formatValue(b,a){if(a.indexOf("format:")!=-1){if(a.indexOf("format:euro")!=-1){b=formatNumber(b)+" &euro;"}else{if(a.indexOf("format:dollar")!=-1){b="$"+formatNumber(b)}else{if(a.indexOf("format:percent")!=-1){b=(b*100).toFixed(2)+"%"}else{if(a.indexOf("format:number")!=-1){b=formatNumber(b)}else{if(a.indexOf("format:datefulltime")!=-1){b=formatDateFullTime(b)}else{if(a.indexOf("format:datetime")!=-1){b=formatDateTime(b)}else{if(a.indexOf("format:datefull")!=-1){b=formatDateFull(b)}else{if(a.indexOf("format:date")!=-1){b=formatDate(b)}else{if(a.indexOf("format:time")!=-1){b=formatTime(b)}}}}}}}}}}else{if(!isNaN(b)&&b!=0){b=formatNumber(b).replace(/\.00$/,"")}}return b}function formatDate(b){if(isNaN(new Date(b).getHours())){b=b.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")}var a=new Date(b);return(a.getMonth()+1)+"/"+a.getDate()+"/"+a.getFullYear()}function formatDateFull(c){if(isNaN(new Date(c).getHours())){c=c.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")}var b=new Date(c);var a=new Array(trans("January"),trans("February"),trans("March"),trans("April"),trans("May"),trans("June"),trans("July"),trans("August"),trans("September"),trans("October"),trans("November"),trans("December"));var d=new Array(trans("Sunday"),trans("Monday"),trans("Tuesday"),trans("Wednesday"),trans("Thursday"),trans("Friday"),trans("Sunday"));return d[b.getDay()]+", "+a[b.getMonth()]+" "+b.getDate()+" "+b.getFullYear()}function formatTime(d){if(isNaN(new Date(d).getHours())){d=d.replace(/\d+\.\d+\.\d+/,"$2/$1/$3");if(d.length<12){d="01/01/01 "+d}}var c=new Date(d);hour=c.getHours();var b="am";if(hour>11){b="pm"}if(hour>12){hour-=12}if(hour==0){hour=12}return hour+":"+c.getMinutes()+":"+c.getSeconds()+" "+b}function formatDateTime(a){return formatDate(a)+" "+formatTime(a)}function formatDateFullTime(a){return formatDateFull(a)+", "+formatTime(a)}function formatNumber(d){var b="";var a="";if(d<0){a="-";d*=-1}number=Math.floor((d-0).toFixed(2))+"";if(number.length>3){var c=number.length%3;var b=(c==0?"":(number.substring(0,c)));for(i=0;i<Math.floor(number.length/3);i++){if(c==0&&i==0){b+=number.substring(c+3*i,c+3*i+3)}else{b+=","+number.substring(c+3*i,c+3*i+3)}}}else{b+=number}if(d-number!=0){b+=Math.abs(d-number).toFixed(2).replace("0.",".")}return a+b}function param(a){if(a.join){a=a.join(",")}if(a.replace){return escape(a)}return a}function graph(e,f,c,j,d,g,b,h){var a="img:graphs.php?type="+param(e)+"&title="+param(f);a+="&data="+param(c)+"&keys="+param(j);if(typeof d!="undefined"){a+="&xtitle="+param(d)}if(typeof g!="undefined"){a+="&ytitle="+param(g)}if(typeof b!="undefined"){a+="&width="+b}if(typeof h!="undefined"){a+="&height="+h}return a}function graph2(f,g,d,c,k,e,h,b,j){var a="img:graphs.php?type="+param(f)+"&title="+param(g);a+="&data="+param(d)+"&data2="+param(c)+"&keys="+param(k);if(typeof e!="undefined"){a+="&xtitle="+param(e)}if(typeof h!="undefined"){a+="&ytitle="+param(h)}if(typeof b!="undefined"){a+="&width="+b}if(typeof j!="undefined"){a+="&height="+j}return a}function sum(b){var a=0;for(var c=0;c<b.length;c++){a+=b[c]}return a}function min(b){var a=0;if(b.length>0){a=b[0]}for(var c=0;c<b.length;c++){if(b[c]<a){a=b[c]}}return a}function max(b){var a=0;if(b.length>0){a=b[0]}for(var c=0;c<b.length;c++){if(b[c]>a){a=b[c]}}return a}function avg(b){var a=0;if(b.length==0){return 0}for(var c=0;c<b.length;c++){a+=b[c]}return Math.round(1000*(a/b.length))/1000}function count(b){var a=0;return b.length}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};