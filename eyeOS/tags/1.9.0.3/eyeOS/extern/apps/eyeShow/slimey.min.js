function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function getMyFile(){window.parent.sendMsg($checknum,"getFile","")}function save_ed(a){window.parent.sendMsg($checknum,"Save","<arg1>ed</arg1>");alert(a)}
var Slimey=function(a){if(a.rootDir)Slimey.rootDir=a.rootDir;if(a.imagesDir)Slimey.imagesDir=a.imagesDir;if(a.filename)this.filename=a.filename;if(a.slimContent)this.slimContent=a.slimContent;if(a.saveUrl)this.saveUrl=a.saveUrl;this.config=a;Slimey.preloadImages();this.editor=new SlimeyEditor(this);this.navigation=new SlimeyNavigation(this);this.Navbar=new SlimeyNavbar(this);var b=document.createElement("div");b.style.position="absolute";b.style.marginTop="0px";b.style.marginLeft="0px";b.style.marginRight=
"0px";b.style.height="58px";b.style.width="100%";b.appendChild(this.Navbar.container);this.edtoolbar=new SlimeyToolbar(this,[new SlimeySaveTool(this),"-",new SlimeyInsertTextTool(this),new SlimeyInsertImageTool(this),new SlimeyInsertOrderedListTool(this),new SlimeyInsertUnorderedListTool(this),new SlimeyDeleteTool(this),"-",new SlimeyUndoTool(this),new SlimeyRedoTool(this),"-",new SlimeyFontColorTool(this),new SlimeyFontFamilyTool(this),new SlimeyFontSizeTool(this),"-",new SlimeyStyleToggleTool(this,
"bold",lang("bold text"),"fontWeight","bold","normal"),new SlimeyStyleToggleTool(this,"underline",lang("underline text"),"textDecoration","underline","none"),new SlimeyStyleToggleTool(this,"italic",lang("italic text"),"fontStyle","italic","normal"),"-",new SlimeySendToBackTool(this),new SlimeyBringToFrontTool(this),"-",new SlimeyViewSourceTool(this),new SlimeyPreviewTool(this)]);this.navtoolbar=new SlimeyToolbar(this,[new SlimeyAddSlideTool(this),new SlimeyDeleteSlideTool(this),"-",new SlimeyMoveSlideDownTool(this),
new SlimeyMoveSlideUpTool(this)]);this.container=typeof a.container=="string"?document.getElementById(a.container):typeof a.container=="object"?a.container:document.body;this.container.appendChild(b);this.container.appendChild(this.navtoolbar.container);this.container.appendChild(this.edtoolbar.container);this.container.appendChild(this.navigation.container);this.container.appendChild(this.editor.container);a=this.aspect||4/3;var d=this.container.offsetHeight;b=this.container.offsetWidth;this.navtoolbar.container.style.position=
"absolute";this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px";this.navtoolbar.container.style.top="60px";this.navigation.container.style.position="absolute";this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px";this.navigation.container.style.height=d-this.navtoolbar.container.offsetHeight+"px";this.edtoolbar.container.style.position="absolute";this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px";this.edtoolbar.container.style.width=
b-this.navigation.container.offsetWidth+"px";this.edtoolbar.container.style.top="60px";this.editor.container.style.position="absolute";this.editor.container.style.top="95px";this.editor.container.style.left="210px";var c,e;if(self.innerHeight){c=self.innerWidth;e=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){c=document.documentElement.clientWidth;e=document.documentElement.clientHeight}else if(document.body){c=document.body.clientWidth;e=document.body.clientHeight}c=
c-200;e=e-120;if(c>e*a){this.editor.container.style.height=e+"px";this.editor.container.style.width=e*a+"px";this.editor.container.style.left=this.navigation.container.offsetWidth+(b-this.navigation.container.offsetWidth-e*a)/2+"px"}else{this.editor.container.style.height=c/a+"px";this.editor.container.style.width=c+"px";this.editor.container.style.left=this.navigation.container.offsetWidth+0+"px"}this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60;addEventHandler(window,"resize",
this.layout,this)};
Slimey.prototype.layout=function(){var a=this.aspect||4/3,b=this.container.offsetHeight,d=this.container.offsetWidth;this.navtoolbar.container.style.position="absolute";this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px";this.navtoolbar.container.style.top="60px";this.navigation.container.style.position="absolute";this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px";this.navigation.container.style.height=b-this.navtoolbar.container.offsetHeight+"px";
this.edtoolbar.container.style.position="absolute";this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px";this.edtoolbar.container.style.width=d-this.navigation.container.offsetWidth+"px";this.edtoolbar.container.style.top="60px";this.editor.container.style.position="absolute";this.editor.container.style.top="95px";this.editor.container.style.left="210px";var c,e;if(self.innerHeight){c=self.innerWidth;e=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){c=
document.documentElement.clientWidth;e=document.documentElement.clientHeight}else if(document.body){c=document.body.clientWidth;e=document.body.clientHeight}b=c-200;e=e-120;if(b>e*a){this.editor.container.style.height=e+"px";this.editor.container.style.width=e*a+"px";this.editor.container.style.left=this.navigation.container.offsetWidth+(d-this.navigation.container.offsetWidth-e*a)/2+"px"}else{this.editor.container.style.height=b/a+"px";this.editor.container.style.width=b+"px";this.editor.container.style.left=
this.navigation.container.offsetWidth+0+"px"}this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60;this.editor.resized()};Slimey.prototype.submitFile=function(){sc.value=this.slimContent;window.parent.sendMsg($checknum,"saveFile",sc.value)};Slimey.imagesDir="index.php?version=EXTERN_CACHE_VERSION&theme=1&extern=icons/22x22/eyeShow/";Slimey.preloadedImages=[];
Slimey.includeScripts=function(){Slimey.rootDir="index.php?extern=apps/eyeShow/getjs.eyecode&type=dynamic&type=dynamic&params[]=$myPid&params[]=$checknum&params[]=";document.write('<script language="javascript" src="'+Slimey.rootDir+'functions"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+'stack"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+'editor"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+
'navigation"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+'actions"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+'tools"><\/script>');document.write('<script language="javascript" src="'+Slimey.rootDir+'toolbar"><\/script>')};Slimey.preloadImage=function(a){var b=Slimey.preloadedImages,d=b.length;b[d]=new Image;b[d].src=Slimey.imagesDir+a};
Slimey.preloadToolbarImage=function(a){Slimey.preloadImage(a+".png");Slimey.preloadImage(a+"h.png");Slimey.preloadImage(a+"x.png");Slimey.preloadImage(a+"d.png")};
Slimey.preloadImages=function(){if(Image){Slimey.preloadToolbarImage("bold");Slimey.preloadToolbarImage("bringToFront");Slimey.preloadToolbarImage("color");Slimey.preloadToolbarImage("delete");Slimey.preloadToolbarImage("empty");Slimey.preloadToolbarImage("insertImage");Slimey.preloadToolbarImage("insertOList");Slimey.preloadToolbarImage("insertUList");Slimey.preloadToolbarImage("insertText");Slimey.preloadToolbarImage("italic");Slimey.preloadToolbarImage("preview");Slimey.preloadToolbarImage("redo");
Slimey.preloadToolbarImage("save");Slimey.preloadToolbarImage("sendToBack");Slimey.preloadToolbarImage("underline");Slimey.preloadToolbarImage("undo");Slimey.preloadToolbarImage("viewSource");Slimey.preloadImage("newslide.png");Slimey.preloadImage("delslide.png");Slimey.preloadImage("sep.png")}};
Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",d,c,e,g,h,f,i=0;for(a=Base64._utf8_encode(a);i<a.length;){d=a.charCodeAt(i++);c=a.charCodeAt(i++);e=a.charCodeAt(i++);g=d>>2;d=(d&3)<<4|c>>4;h=(c&15)<<2|e>>6;f=e&63;if(isNaN(c))h=f=64;else if(isNaN(e))f=64;b=b+this._keyStr.charAt(g)+this._keyStr.charAt(d)+this._keyStr.charAt(h)+this._keyStr.charAt(f)}return b},decode:function(a){var b="",d,c,e,g,h,f=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,
"");f<a.length;){d=this._keyStr.indexOf(a.charAt(f++));c=this._keyStr.indexOf(a.charAt(f++));g=this._keyStr.indexOf(a.charAt(f++));h=this._keyStr.indexOf(a.charAt(f++));d=d<<2|c>>4;c=(c&15)<<4|g>>2;e=(g&3)<<6|h;b+=String.fromCharCode(d);if(g!=64)b+=String.fromCharCode(c);if(h!=64)b+=String.fromCharCode(e)}return b=Base64._utf8_decode(b)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",d=0;d<a.length;d++){var c=a.charCodeAt(d);if(c<128)b+=String.fromCharCode(c);else{if(c>127&&c<2048)b+=
String.fromCharCode(c>>6|192);else{b+=String.fromCharCode(c>>12|224);b+=String.fromCharCode(c>>6&63|128)}b+=String.fromCharCode(c&63|128)}}return b},_utf8_decode:function(a){for(var b="",d=0,c=c1=c2=0;d<a.length;){c=a.charCodeAt(d);if(c<128){b+=String.fromCharCode(c);d++}else if(c>191&&c<224){c2=a.charCodeAt(d+1);b+=String.fromCharCode((c&31)<<6|c2&63);d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode((c&15)<<12|(c2&63)<<6|c3&63);d+=3}}return b}};
