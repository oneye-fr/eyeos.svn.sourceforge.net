var windowd=document.getElementById("$myPid_eyeChess_Window_Content");M=I=P=N=q=K=J=Btime=0;Bt=1999;Al=-Bt;Ds=[10,-10];BE=120;Rh=[];G=[];R=[];KL=[3,3];j=[0,1,5,3,3,9,63,0];MV=[0,0,[1,10],[21,19,12,8],[11,9],[1,10,11,9],[1,10,11,9],0];for(z=0;z<8;){j[z+8]=j[z]<<=4;if(m=MV[z++]){s=m.length;for(x=0;x<s;)m[s+x]=-m[x++]}}x="g00000000g";y="gggggggggg";b=y+y+"g23456432gg11111111g"+x+x+x+x+"g99999999ggABCDECBAg"+y+y;w=x+x+x+"000111100000123321000123553210";a="000012346900";Y=[];PY=[];bY=[];
for(y=0;y<12;y++)for(x=0;x<10;x++){z=y*10+x;PY[z]=parseInt(a.charAt(y));bY[z]=parseInt(w.charAt(z<60?z:119-z),35)&7;R[z]=parseInt(b.charAt(z),35)}R[BE]=0;d=document;(A=E=d.all)||(event=0);if((DM=d.getElementsByTagName||null)||E){windowd.innerHTML+='<img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" id="PI" name="PI" width="47" height="48" />';A=E||d.getElementsByTagName("img");Ic=A.PI.style}cp=function(c,e){return e[0]-c[0]};
function Z(c,e,l,g,f,i,k,t){var n=-1;l=-l;var r=8-e,o=Al,p=R,C,D=p[f],F,S;if(l<-400)return[l,g,f];p[f]=C=p[g];p[g]=0;if(C)G[r][G[r].length]=[C,f];if(C-e==1&&p[f+Ds[e>>3]]>15)p[f]+=4;if(C-e==6&&(g-f==2||f-g==2)){F=g-4+(g<f)*7;S=g+f>>1;p[F]=0;p[S]=e+2}l=Pz(e,t,l);t=l.length;var u;if(t)if(c){l.sort(cp);c--;n=l[0];var Q=n[1],T=n[2],v;o=-Z(c,r,n[0],Q,T,-k,-i,n[3])[0];for(n=1;n<t;n++){if(o>i)i=o;u=l[n];v=-Z(c,r,u[0],u[1],u[2],-i-1,-i,u[3])[0];if(v>i&&v<k)v=-Z(c,r,u[0],u[1],u[2],-k,-v,u[3])[0];if(v>o){o=
v;Q=u[1];T=u[2];if(v>i)i=v;if(o>k)break}}}else for(o=Al;--t&&k>o;){if(l[t][0]>o)o=l[t][0]}else fy(0);if(F){p[F]=e+2;p[S]=0}p[g]=C;p[f]=D;G[r].length--;return[o,Q,T]}function Sf(c,e,l,g,f){var i=R[g],k=R[g]=R[l];R[l]=0;H();e=Z(c,e,0,BE,BE,Al,Bt,f);R[l]=k;R[g]=i;return e[0]}
function mv(c,e,l){var g=R[e],f=R[c]&7,i=M>>3,k=0,t=0,n=0,r;if(M==P){H();for(r=Pz(M,K,0);n<r.length;n++)t=t||c==r[n][1]&&e==r[n][2];if(!t)return 0;if(Sf(0,8-M,c,e,K)>400)return 0}if(Sf(0,M,c,e,K)>400)k=1;n=c%10;r=e-c;var o=Ds[i];t=e%10;var p=1+(N>>1);Df((M?"     ":(p<10?" ":"")+p+".  ")+"abcdefgh".charAt(n-1)+((c-n)/10-1)+(g?"x":"-")+"abcdefgh".charAt(t-1)+((e-t)/10-1)+(k?"+":" "));Sf(1,8-M,c,e,K)<-400&&fy(k);if((g&7)==6){fy(1);return 0}Rh[N]=[R.toString(),KL.toString(),K];K=0;if(f==1){if(R[e+o]>
15)R[c]+=4-l;if(r==2*o&&(R[e-1]&1||R[e+1]&1))K=c+o;!g&&r%10&&Sh(e,e-o)}if(c==21+i*70||c==28+i*70)KL[i]&=(n<5)+1;if(e==21+i*70||e==28+i*70)KL[!i]&=(n<5)+1;if(f==6){r*r==4&&Sh(c-4+(c<e)*7,c+r/2);KL[i]=0}Sh(c,e);H();N++;M=8-M;return 1}function fy(c){Df(c?"checkmate!":"stalemate!");J=c++}
function H(){var c=99,e;s0=N<32?4-(N>>3):N>64;G[0]=[];G[8]=[];kY=[];for(pY=[[],[]];c>20;c--){a=R[c];if(a&7)G[a&8][G[a&8].length]=[a,c];Y[c]=bY[c]*s0;kY[c]=N>40||(10-2*bY[c])*s0;e=pY[1][119-c]=pY[0][c]=PY[c];if(N<7&&c>40){pY[0][c]=pY[1][119-c]=e+Math.random()*Y[c]|1;Y[24]=Y[94]=29}}}
function Pz(c,e,l){var g,f,i,k,t,n=-1;g=c>>3;var r=c^8,o=Ds[g],p=[],C,D,F=pY[g],S,u=KL[g],Q,T,v=G[c],V=v.length,L=R,U=j;for(Q=0;Q<V;Q++){g=v[Q][1];f=L[g];if(v[Q][0]==f){f&=7;if(f>1){S=(C=f==6)?kY:Y;D=l-S[g];i=MV[f];if(f==3||C){for(t=0;t<8;){f=g+i[t++];k=L[f];if(!k||(k&24)==r)p[++n]=[D+U[k]+S[f],g,f]}if(C&&u){if(u&1&&!(L[g-1]+L[g-2]+L[g-3])&&CH(g-2,r,o,-1))p[++n]=[D+11,g,g-2];if(u&2&&!(L[g+1]+L[g+2])&&CH(g,r,o,1))p[++n]=[D+12,g,g+2]}}else{T=i.length;for(t=0;t<T;){k=0;C=i[t++];for(f=g;!k;){f+=C;k=L[f];
if(!k||(k&24)==r)p[++n]=[D+U[k]+S[f],g,f]}}}}else{D=l-F[g];f=g+o;if(!L[f]){p[++n]=[D+F[f],g,f];if(!F[g]&&!L[f+o])p[++n]=[D+F[f+o],g,f+o,f]}if(e&&(e==f+1||e==f-1))p[++n]=[D+F[f],g,e];for(i=f-1;i<f+2;i+=2){k=L[i]+c;if(k&7&&k&8)p[++n]=[D+U[k]+F[i],g,i]}}}}return p}
function CH(c,e,l,g){for(var f,i,k,t=c+3,n=l+2,r=MV[3],o=R;c<t;c++){for(k=l-2;++k<n;){if((i=o[c+k])&&(i&8)==e&&((i&8)==1||(i&7)==6))return 0;i=0;for(f=c;!i;){f+=k;i=o[f];if(i==e+2+(k!=l)*2||i==e+5)return 0}}for(z=0;z<8;)if(o[c+r[z++]]-e==3)return 0}i=0;for(c-=3;!i;){c-=g;i=o[c];if(i==e+2||i==e+5)return 0}return 1}
function B(c){var e=R[c];if(!J)if(q==c&&I){O("PI",0);O(q,I,1);I=0}else if(e&&M==(e&8)){I&&O(q,I,1);I=e;q=c;O(q,0,1);O("PI",e);E&&dr();d.onmousemove=dr}else if(I)if(mv(q,c,d.FF.h.selectedIndex,y)){O("PI",0);d.onmousemove=null;if(A)Ic.top=Ic.left="0px";I=0;if(!J){c=Z(d.FF.i.selectedIndex+1,M,0,BE,BE,Al,Bt,K);mv(c[1],c[2],0)}}}function Sh(c,e){var l=R[c];R[e]=l;R[c]=0;O(c,0,1);O(e,l,1)}function Df(c){d.FF.b.value+="\n "+c}
function Rf(c){P=c;for(c=0;c<BE;c++)R[c]<16&&O(c,R[c],1);if(P!=M){Tt=Z(d.FF.i.selectedIndex+1,M,0,BE,BE,Al,Bt,K);mv(Tt[1],Tt[2],0)}}function Gb(){if(N){N-=2;var c=Rh[N];R=eval("["+c[0]+"]");KL=eval("["+c[1]+"]");Df(" --undo--");K=c[2];M=N%2;Rf(M);H()}}function dr(c){c=c||event;Ic.left=c.clientX+1+"px";Ic.top=c.clientY-4+"px"}function O(c,e,l){if((A||c!="PI")&&l)c="i"+(P?119-c:c);d.images[c].src="index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=$imagesDir/"+e+".png"}h='<table cellpadding="4" class="eyeChess_t">';
for(y=90;y>10;y-=10){h+="<tr>";for(x=0;x<10;x++){z=y+x;if(x&&x<9)h+='<td class="'+(x+y/10&1?"eyeChess_b":"eyeChess_w")+'"><span onclick="B(P?119-'+z+":"+z+');" style="cursor: pointer;"><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="0" height="48" border="0"><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="47" height="48" name="i'+z+'" border="0" /><img src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=$imagesDir/0.png" width="0" height="48" border="0" /></span></td>\n'}h+=
"</tr>\n"}h+="</table>";windowd.innerHTML+=h;Rf(0);windowd.innerHTML+='<form name="FF"><div style="text-align: center;"><table class="eyeChess_Table" border="0"><tr><td></td><td><textarea name="b" style="margin-top:5px;margin-left:5px;height:457px;" cols="12" rows="24" class="eyeTextarea">$lang:Movements:</textarea></td></tr></table><input type="button" class="eyeButtonClass" value="$lang:Undo" class="eyeButton" style="margin-top: 6px; position:absolute; top:475px; left:400px;" onclick="Gb();" /><div class="eyeChess_Text" style="margin-top: 15px;">$lang:Next pawn becomes: <select name="h" class="eyeSelect"><option selected="selected">$lang:Queen</option><option>$lang:Bishop</option><option>$lang:Knight</option><option>$lang:Rook</option></select> &nbsp; $lang:Computer level: <select class="eyeSelect" name="i"><option>$lang:Easy</option><option selected="selected">$lang:Middling</option><option>$lang:Slow</option></select></div></div></form>';
H();
