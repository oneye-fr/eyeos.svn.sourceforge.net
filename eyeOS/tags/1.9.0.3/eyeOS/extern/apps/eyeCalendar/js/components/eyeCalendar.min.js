weekPlanner_instances=[];function weekPlanner_close(f){if(weekPlanner_instances[f]){clearTimeout(weekPlanner_instances[f].base.timeOut);if(IEversion&&IEversion<8){weekPlanner_instances[f].base.father=null;weekPlanner_instances[f]=null}else{delete weekPlanner_instances[f].base.father;delete weekPlanner_instances[f]}return true}return false}function weekPlanner_show(f,g,a,b,c,e,j,i,k){weekPlanner_instances[f.pid]=new weekPlanner_class(f,g,a,b,c,e,j,i,k)}
function weekPlanner_class(f,g,a,b,c,e,j,i,k){this.pid=f.pid;this.checknum=i;this.dayFrom=f.dayFrom;this.dayEven=f.dayEven;this.hourFrom=f.hourFrom;this.hourEven=f.hourEven;this.hourRowWidth=f.hourWidth;this.dayRowWidth=f.width;this.rowHeight=f.rowHeight;this.parts=f.parts;this.weekDays=getArrayArg(f.weekDays);this.startMonday=f.startMonday;this.selectedCalendar=f.selectedCalendar;this.defaultEvenText=f.defaultEvenText;this.calendarsText=f.calendarsText;this.father=xGetElementById(a);this.plannerWidth=
xWidth(this.father);this.numDays=this.dayEven-this.dayFrom;f=xHeight(this.father);g=this.hourEven-this.hourFrom+1;if(this.rowHeight*g<f)this.rowHeight=f/g;this.pixelPart=IEversion==7?(this.rowHeight-1)/this.parts:(this.rowHeight+1)/this.parts;this.calendarsFather=xGetElementById(this.pid+"_calendarsContainer_Container");this.calendarsFatherWidth=xWidth(this.calendarsFather);if(IEversion==6)this.rowHeight+=2;else if(IEversion==7)this.rowHeight-=2;this.noteHeaderColors=new Array("#AB3F19","#136DBB",
"#2E8200","#504A76","#AB3F19","#7F405C");this.noteBodyColors=new Array("#E46F46","#37A3FF","#6FBA32","#8074C9","#F19A2A","#E26299");this.calendarSelectColors=new Array("#E46F46","#37A3FF","#6FBA32","#8074C9","#F19A2A","#E26299");this.contentHeight=this.rowHeight*(this.hourEven-this.hourFrom+1)+25;this.rowWidth=(this.dayRowWidth-(this.numDays-1+0.2))/this.numDays;this.calendars=new weekPlanner_calendars(this);this.events=new weekPlanner_events(this);this.base=new weekPlanner_base(this);this.notes=
new weekPlanner_notes(this);this.calendars.draw();this.base.draw();this.resizeDays=resizeDays}
function weekPlanner_calendars(f){this.father=f;this.calendarInfo=[];this.cleanCalendars=function g(){var a=document.getElementById(this.father.pid+"_calendarsEntryContainer");a.parentNode.removeChild(a);this.draw()};this.hiddenNotes=function g(a){if(!a.target.num)return false;a=a.target;var b=a.num;if(a.checked==true){this.calendarInfo[b].show=1;this.father.notes.jsEvent_showCalendarNotes(b)}else{if(this.calendarInfo[b].selected==1){a.checked=true;return false}this.calendarInfo[b].show=0;this.father.notes.jsEvent_hiddenCalendarNotes(b)}sendMsgParam=
eyeParam("showed",a.checked);sendMsgParam+=eyeParam("calendar",b);sendMsg(this.father.checknum,"calendarShow",sendMsgParam)};this.selectCalendar=function g(a){if(this.calendarInfo.length>0){var b=xGetElementById(this.father.pid+"_selectedImg");b.parentNode.removeChild(b)}a=a.target;if(a.id=="textContainer")a=a.parentNode;this.genSelectCalendar(true,a,a.num)};this.phpSelectCalendar=function g(a){if(this.calendarInfo.length>0){var b=xGetElementById(this.father.pid+"_selectedImg");b.parentNode.removeChild(b)}this.genSelectCalendar(false,
document.getElementById(this.father.pid+"_contentName_"+a),a)};this.genSelectCalendar=function g(a,b,c){if(this.father.selectedCalendar!="noCalendar")this.calendarInfo[this.father.selectedCalendar].selected=0;this.calendarInfo[c].selected=1;if(this.calendarInfo[c].show==0){var e=document.getElementById(this.father.pid+"_calendarCheck_"+c);e.checked=true;this.calendarInfo[c].show=1;this.father.notes.jsEvent_showCalendarNotes(c);sendMsgParam=eyeParam("showed",e.checked);sendMsgParam+=eyeParam("calendar",
c);sendMsg(this.father.checknum,"calendarShow",sendMsgParam)}this.calendarInfo[c].selected=1;this.father.selectedCalendar=c;e=this.drawSelectRow();b.appendChild(e);if(a==true){sendMsgParam=eyeParam("calendar",c);sendMsg(this.father.checknum,"selectCalendar",sendMsgParam)}};this.drawSelectRow=function g(){var a=document.createElement("div");a.setAttribute("id",this.father.pid+"_selectedImg");a.style.position="absolute";a.style.height="100%";a.style.right="5px";var b=document.createElement("img");b.src=
"index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=images/apps/eyeCalendar/widget/selected.png";b.setAttribute("id",this.father.pid+"_selectedImg_img");a.appendChild(b);return a};this.drawCalendar=function g(a,b,c){var e=this.father.calendarsFather;this.calendarInfo[b]=[];this.calendarInfo[b].show=c;e=document.createElement("div");e.setAttribute("id",b+"_contentEntry");e.style.cssFloat="right";e.style.styleFloat="right";e.style.width=this.father.calendarsFatherWidth-20+"px";e.style.height=
"15px";e.style.marginTop="5px";e.style.zIndex="999";e.style.cursor="pointer";e.num=b;e.pid=this.father.pid;e.evenType="selectCalendar";var j=document.createElement("input");j.setAttribute("id",this.father.pid+"_calendarCheck_"+b);j.style.position="relative";j.style.cssFloat="left";j.style.styleFloat="left";j.style.marginTop="1px";j.style.marginLeft="0px";j.style.marginRight="0px";j.style.cursor="pointer";j.type="checkBox";j.evenType="viewCalendar";j.noPrevent=true;j.num=b;j.pid=this.father.pid;if(c==
1){j.checked=true;j.defaultChecked=true}xAddEventListener(j,"click",mouseClick);c=document.createElement("div");c.setAttribute("id",this.father.pid+"_contentName_"+b);c.style.position="relative";c.style.cssFloat="left";c.style.styleFloat="left";c.style.marginLeft="5px";c.style.width=this.father.calendarsFatherWidth-48+"px";c.style.height=IEversion&&IEversion<7?"16px":"100%";c.style.color="white";if(IEversion&&IEversion<7)c.style.marginTop="4px";c.evenType="selectCalendar";c.pid=this.father.pid;c.num=
b;var i=document.createElement("div");i.style.position="absolute";i.style.width="1px";i.style.height="1px";i.style.backgroundColor="white";i.style.top="0px";i.style.left="0px";c.appendChild(i);i=i.cloneNode(true);i.style.top="";i.style.bottom="0px";c.appendChild(i);i=i.cloneNode(true);i.style.left="";i.style.right="0px";c.appendChild(i);i=i.cloneNode(true);i.style.bottom="";i.style.top="0px";c.appendChild(i);calendarNum=b>5?b%5:b;c.style.backgroundColor=this.father.calendarSelectColors[calendarNum];
i=document.createElement("div");i.setAttribute("id","textContainer");i.style.cssFloat="left";i.style.styleFloat="left";i.style.marginLeft="4px";i.evenType="selectCalendar";i.pid=this.father.pid;a=document.createTextNode(a);i.appendChild(a);xAddEventListener(i,"click",mouseClick);if(this.father.selectedCalendar==b){this.calendarInfo[b].selected=1;b=this.drawSelectRow();c.appendChild(b)}else this.calendarInfo[b].selected=0;c.appendChild(i);e.appendChild(j);e.appendChild(c);xAddEventListener(c,"click",
mouseClick);this.infoContainer.appendChild(e)};this.draw=function g(){var a=this.father.calendarsFather,b=document.createElement("div");b.setAttribute("id",this.father.pid+"_calendarsEntryContainer");b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.height="100%";b.style.width="100%";b.style.backgroundColor="white";var c=document.createElement("div");c.style.position="absolute";c.style.top="5px";c.style.left="10px";c.style.width="auto";c.style.height="10px";c.style.color="#6D6D6D";
var e=document.createTextNode(this.father.calendarsText);c.appendChild(e);b.appendChild(c);this.infoContainer=document.createElement("div");this.infoContainer.style.position="absolute";this.infoContainer.style.left="3px";this.infoContainer.style.top="26px";this.infoContainer.style.width=this.father.calendarsFatherWidth-14+"px";this.infoContainer.style.height="auto";b.appendChild(this.infoContainer);a.appendChild(b)}}
function weekPlanner_base(f,g,a){this.father=f;this.timeOut=null;this.totalParts=0;this.changeDate=function b(c,e,j){for(j=0;j<=this.dayNames.childNodes.length;j++)this.dayNames.childNodes[j].firstChild.data=c[e+j]};this.draw_dayNames=function b(){for(h=this.father.dayFrom;h<=this.father.dayEven-1;h++){var c=document.createElement("div");c.setAttribute("id",this.father.pid+"_dayName_"+h);c.style.position="relative";c.style.cssFloat="left";c.style.styleFloat="left";c.style.width=IEversion==6?this.father.rowWidth+
1+"px":this.father.rowWidth+"px";c.style.height="100%";c.style.textAlign="center";c.style.color="#145689";c.style.lineHeight="200%";if(h!=this.father.dayFrom&&(!IEversion||IEversion>6))c.style.borderLeft="1px transparent solid";else if(h!=this.father.dayFrom)c.style.borderLeft="1px transparent";var e=document.createTextNode(this.father.weekDays[h]);c.appendChild(e);this.dayNames.appendChild(c)}};this.draw_todos=function b(){for(h=this.father.dayFrom;h<=this.father.dayEven-1;h++){var c=document.createElement("div");
c.setAttribute("id",this.father.pid+"_dayTodo_"+h);c.style.position="relative";c.style.cssFloat="left";c.style.styleFloat="left";c.style.width=this.father.rowWidth+"px";c.style.height="100%";c.style.textAlign="center";c.style.color="#145689";if(h!=this.father.dayFrom)c.style.borderLeft="1px #C1C1C1 solid";this.dayTodo.appendChild(c)}};this.draw_bodyDays=function b(){var c=function w(){for(var l=0;l<this.notes.length;l++){var m=this.notes[l].startPartObj.numOfLevels();if(this.notes[l].level==0||m==
1){this.notes[l].style.width="50%";this.notes[l].style.left="0px";this.notes[l].level=0}else{m=90/m*this.notes[l].level;this.notes[l].style.width=90-m+"%";this.notes[l].style.left=m+"%";this.notes[l].style.zIndex=10+this.notes[l].level}}},e=function w(l){this.notes[l.cid]=l;var m=l.startPartObj.addNote(l);l.level=m;for(var y=l.fromParts,A=l.startPart+1;A<y;A++)xGetElementById(l.day+"_part_"+A).addNoteToLevel(l,m)},j=function w(l){delete this.notes[l.cid];this.notes.sort();this.notes.pop();l.startPartObj.delNote(l);
for(var m=l.fromParts,y=l.startPart+1;y<m;y++)xGetElementById(l.day+"_part_"+y).delNoteToLevel(l,l.level)},i=function w(l,m){this.notesLevel[m]&&this.notesLevel[m].moveLevel(m);this.notesLevel[m]=l},k=function w(l,m){this.notesLevel[m]&&delete this.notesLevel[m]},r=function w(l){for(var m=0;m<=this.notesLevel.length;m++)if(typeof this.notesLevel[m]=="undefined"){this.notesLevel[m]=l;return m}l=this.notesLevel.push(l);l--;return l},n=function w(l){for(var m=0;m<=this.notesLevel.length;m++)if(this.notesLevel[m].cid==
l.cid){delete this.notesLevel[m];this.notesLevel.sort();this.notesLevel.pop()}},q=function w(){for(var l=0,m=0;m<=this.notesLevel.length;m++)this.notesLevel[m]&&l++;return l},p=document.createElement("div"),u=this.father.dayFrom;p.setAttribute("id",this.father.pid+"_day_"+u);p.className="eyeCalendar_day";p.style.width=this.father.rowWidth+"px";p.notes=[];p.orderNotes=c;p.addNote=e;p.delNote=j;var z=0;for(h=this.father.hourFrom;h<=this.father.hourEven;h++){var t=document.createElement("div");t.setAttribute("id",
this.father.pid+"_hour_"+u+"_"+h);t.className="eyeCalendar_hour";t.style.height=this.father.rowHeight+"px";t.pid=this.father.pid;for(var v=z*4,o=v+4;v<o;v++){var s=document.createElement("div");s.setAttribute("id",u+"_part_"+v);s.className="eyeCalendar_part";s.pid=this.father.pid;s.evenType="default";s.day=u;s.hour=h;s.num=v;s.addNote=r;s.addNoteToLevel=i;s.delNote=n;s.delNoteToLevel=k;s.notesLevel=[];s.numOfLevels=q;t.appendChild(s)}if(h!=this.father.hourFrom)t.style.borderTop="1px #C1C1C1 solid";
o=document.createElement("div");o.setAttribute("id","halfHour");o.style.top=this.father.rowHeight/2+"px";o.className="eyeCalendar_halfHour";t.appendChild(o);p.appendChild(t);z++}this.daysContainer.appendChild(p);for(u=this.father.dayFrom+1;u<=this.father.dayEven-1;u++){p=p.cloneNode(true);p.setAttribute("id",this.father.pid+"_day_"+u);p.style.borderLeft="1px #C1C1C1 solid";p.notes=[];p.orderNotes=c;p.addNote=e;p.delNote=j;t=p.childNodes;for(h=z=0;h<t.length;h++){t[h].setAttribute("id",this.father.pid+
"_hour_"+u+"_"+h);v=z*4;o=v+4;o=t[h].childNodes;for(x=0;x<o.length;x++)if(o[x].id!="halfHour"){o[x].setAttribute("id",u+"_part_"+v);o[x].num=v;o[x].day=u;o[x].hour=h;o[x].evenType="default";o[x].pid=this.father.pid;o[x].addNote=r;o[x].notesLevel=[];o[x].addNoteToLevel=i;o[x].delNote=n;o[x].delNoteToLevel=k;o[x].numOfLevels=q;v++}z++}this.totalParts=v;this.daysContainer.appendChild(p)}};this.draw_bodyDaysIE=function b(){for(d=this.father.dayFrom;d<=this.father.dayEven-1;d++){var c=document.createElement("div");
c.setAttribute("id",this.father.pid+"_day_"+d);c.style.position="relative";c.style.cssFloat="left";c.style.styleFloat="left";c.style.width=this.father.rowWidth+"px";c.style.height="100%";c.pid=this.father.pid;c.onselectstart=function(){return false};if(d!=this.father.dayFrom)c.style.borderLeft="1px #C1C1C1 solid";var e=0;for(h=this.father.hourFrom;h<=this.father.hourEven;h++){for(var j=e*4,i=j+4;j<i;j++){var k=document.createElement("div");k.setAttribute("id",d+"_part_"+j);k.style.position="relative";
k.style.cssFloat="left";k.style.styleFloat="left";k.style.width="100%";k.style.height=this.father.rowHeight/4+"px";k.pid=this.father.pid;k.day=d;k.hour=h;k.num=j;k.style.zIndex="1";k.notesInPart=[];if(j==i-1)k.style.borderBottom="1px #C1C1C1 solid";k.evenType="default";c.appendChild(k)}c.appendChild(k);e++}this.totalParts=j;this.daysContainer.appendChild(c)}};this.draw_dayHours=function b(){for(h=this.father.hourFrom;h<=this.father.hourEven;h++){var c=document.createElement("div");c.setAttribute("id",
"hour");c.style.position="relative";c.style.cssFloat="left";c.style.styleFloat="left";c.style.width="100%";c.style.height=IEversion&&IEversion<7?String(this.father.rowHeight+1)+"px":this.father.rowHeight+"px";c.style.borderTop="1px #E6E6E6 solid";c.style.textAlign="center";c.style.color="#585858";if(IEversion)c.onselectstart=function(){return false};var e=document.createTextNode(h+":00");c.appendChild(e);this.hoursBase.appendChild(c)}};this.goToFirstNote=function b(){if(!this.father.firstTop)this.father.firstTop=
xTop(this.hourLine);this.fatherDays.scrollTop=this.father.firstTop};this.drawCurrentHour=function b(){var c=new Date,e=c.getHours(),j=c.getMinutes();c=c.getSeconds();if(e>this.father.hourEven)return false;var i=e*51;i+=j*0.83;i=parseInt(i);this.hourLine=document.createElement("div");this.hourLine.setAttribute("id",this.father.pid+"_currentHour");this.hourLine.style.position="absolute";this.hourLine.style.top=i+"px";this.hourLine.style.left="0px";this.hourLine.style.width="100%";this.hourLine.style.height=
"1px";if(IEversion==6){this.hourLine.style.visibility="hidden";this.hourLine.style.display="none"}this.hourLine.style.backgroundColor="#ea614f";i=document.createElement("div");i.setAttribute("id",this.father.pid+"_textContainer");i.style.position="absolute";i.style.marginTop="-2.4%";i.style.left="5px";i.style.color="#ea614f";i.style.fontSize="10px";i.style.zIndex=1;if(j<10)j="0"+j;if(c<10)c="0"+c;e=document.createTextNode(e+":"+j+":"+c);i.appendChild(e);this.hourLine.appendChild(i);this.daysContainer.appendChild(this.hourLine);
this.timeOut=setTimeout("calendar_updateCurrentHour("+this.father.pid+");",1E3)};this.updateCurrentHour=function b(c){var e=new Date,j=e.getHours(),i=e.getMinutes();e=e.getSeconds();var k=(j-this.father.hourFrom)*51;k+=i*0.83;k=parseInt(k);this.hourLine.style.top=k+"px";if(IEversion==6){this.hourLine.style.visibility="visible";this.hourLine.style.display="block"}if(i<10)i="0"+i;if(e<10)e="0"+e;this.hourLine.firstChild.firstChild.data=j+":"+i+":"+e;this.timeOut=setTimeout("calendar_updateCurrentHour("+
c+");",1E3)};this.draw=function b(){this.hoursBase=document.createElement("div");this.hoursBase.setAttribute("id",this.father.pid+"_hoursBase");this.hoursBase.style.position="absolute";this.hoursBase.style.left="0px";this.hoursBase.onselectstart=function(){return false};this.hoursBase.style.top=IEversion&&IEversion<7?"6px":"5px";this.hoursBase.style.width=this.father.hourRowWidth+"px";this.hoursBase.style.height="100%";this.fatherNames=document.createElement("dif");this.fatherNames.setAttribute("id",
this.father.pid+"_fatherNames");this.fatherNames.style.position="absolute";this.fatherNames.style.left=this.father.hourRowWidth+"px";this.fatherNames.style.top="0px";this.fatherNames.style.width="auto";this.fatherNames.style.height="auto";this.fatherDays=document.createElement("dif");this.fatherDays.setAttribute("id",this.father.pid+"_fatherDays");this.fatherDays.style.position="absolute";this.fatherDays.style.left="0px";this.fatherDays.style.top="40px";this.fatherDays.style.width="100%";this.fatherDays.style.height=
xHeight(this.father.father)+"px";this.fatherDays.style.overflowX="hidden";this.fatherDays.style.overflowY="auto";this.daysBase=document.createElement("div");this.daysBase.setAttribute("id",this.father.pid+"_daysBase");this.daysBase.style.position="absolute";this.daysBase.style.left=this.father.hourRowWidth+"px";this.daysBase.style.top="0px";this.daysBase.style.width=this.father.dayRowWidth+"px";this.daysBase.style.height=this.father.contentHeight+"px";if(IEversion)this.daysBase.onselectstart=function(){return false};
this.dayNames=document.createElement("div");this.dayNames.setAttribute("id",this.father.pid+"_dayNames");this.dayNames.style.position="relative";this.dayNames.style.cssFloat="left";this.dayNames.style.styleFloat="left";this.dayNames.style.width="auto";this.dayNames.style.height="20px";if(IEversion)this.dayNames.onselectstart=function(){return false};this.dayTodo=document.createElement("div");this.dayTodo.setAttribute("id",this.father.pid+"_dayTodo");this.dayTodo.style.position="relative";this.dayTodo.style.cssFloat=
"left";this.dayTodo.style.styleFloat="left";this.dayTodo.style.width="auto";this.dayTodo.style.height="15px";this.dayTodo.style.border="1px #999 solid";if(IEversion)this.dayTodo.onselectstart=function(){return false};this.daysContainer=document.createElement("div");this.daysContainer.setAttribute("id",this.father.pid+"_daysContent");this.daysContainer.style.position="relative";this.daysContainer.style.cssFloat="left";this.daysContainer.style.styleFloat="left";this.daysContainer.style.marginTop="5px";
this.daysContainer.style.width="100%";this.daysContainer.style.height="auto";this.daysContainer.style.borderLeft="1px #999 solid";this.daysContainer.style.borderRight="1px #999 solid";this.daysContainer.style.borderTop="1px #999 solid";this.daysContainer.style.borderBottom="1px #999 solid";if(IEversion)this.daysContainer.onselectstart=function(){return false};this.father.evenType="default";xAddEventListener(this.daysContainer,"mousedown",mouseDown);xAddEventListener(this.daysContainer,"mouseup",mouseUp);
this.father.father.appendChild(this.fatherNames);this.father.father.appendChild(this.fatherDays);this.fatherNames.appendChild(this.dayNames);this.draw_dayNames();this.fatherNames.appendChild(this.dayTodo);this.draw_todos();this.fatherDays.appendChild(this.daysBase);this.fatherDays.appendChild(this.hoursBase);this.draw_dayHours();this.daysBase.appendChild(this.daysContainer);this.drawCurrentHour();IEversion&&IEversion<8?this.draw_bodyDaysIE():this.draw_bodyDays()}}
function weekPlanner_notes(f){this.father=f;this.notes=[];this.jsEvent_newNote=function g(a){if(isNaN(a.target.num))return false;this.father.evenType="default";var b=this.father.selectedCalendar;a=a.target;var c=0;Math.floor(a.num/this.father.parts);c=this.notes.length;var e=this.draw_newNote(a.num,2,b,c,1,1);this.father.base.daysContainer.style.cursor="s-resize";var j=document.getElementById(this.father.pid+"_day_"+a.day);j.appendChild(e);e.parts=2;e.fromParts=a.num;e.startPart=a.num;e.day=a.day;
e.startPartObj=xGetElementById(a.day+"_part_"+a.num);this.draw_title(e);this.draw_event(e,this.father.defaultEvenText);if(IEversion&&IEversion<8){e.style.zIndex=0;e.noteBody.style.zIndex=0}else e.noteBody.style.zIndex=1;this.father.tmpNote=e;this.notes.push(e);e.cid=c;e.calendar=b;e.newFather=j;this.father.evenType="resizeNote2";xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver);xRemoveEventListener(this.father.base.daysContainer,"mousedown",mouseDown)};this.draw_contextualMenu=
function g(a){var b=Array();b.sFather=1;if(IEversion&&IEversion<8){b.mFather=this.father.base.daysContainer.id;b.rFather=this.father.base.daysContainer.id}ContextMenu_show(b,a.cid+"_noteMenu",a.id,20,20,0,0,this.father.checknum,0);addContextEntry(a.cid+"_noteMenu",'<img id="'+a.cid+'_noteMenu_delete" style="height: 16px; width: 16px;" src="index.php?version='+EXTERN_CACHE_VERSION+'&theme=1&extern=icons/16x16/delete.png"/> &nbsp;&nbsp;$lang:Delete',a.cid+"_delete","delNote",this.father.checknum,"<id>"+
a.cid+"</id><calendar>"+a.calendar+"</calendar>",a.cid+"_noteMenu_delete")};this.jsEvent_deleteNote=function g(a){a=a.target.parentNode;a.newFather.delNote(a);sendMsgParam=eyeParam("id",a.cid);sendMsgParam+=eyeParam("calendar",a.calendar);sendMsg(this.father.checknum,"delNote",sendMsgParam)};this.jsEvent_resizeNote=function g(a){this.father.tmpNote=a.target.parentNode;this.father.evenType="resizeNote";if(IEversion&&IEversion<8){this.father.tmpNote.style.zIndex=0;this.father.tmpNote.noteBody.style.zIndex=
0}else this.father.tmpNote.noteBody.style.zIndex=1;this.father.base.daysContainer.style.cursor="s-resize";xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver)};this.jsEvent_moveNote=function g(a){this.father.tmpNote=a.target.parentNode;this.father.evenType=a.target.id=="noteTitle"?"moveNote":"moveNoteBody";if(IEversion&&IEversion<8){this.father.tmpNote.style.zIndex=0;this.father.tmpNote.noteBody.style.zIndex=0}else this.father.tmpNote.noteBody.style.zIndex=1;this.father.base.daysContainer.style.cursor=
"move";xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver)};this.jsEvent_editEvent=function g(a){var b=a.target.parentNode;b=b.parentNode;this.father.tmpNote=b;a=a.target.firstChild.data;xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver);xRemoveEventListener(this.father.base.daysContainer,"mouseup",mouseUp);b=this.draw_editPopup(b.cid,a);this.father.father.parentNode.appendChild(b);b.inputText.focus();b.inputText.select()};this.jsEvent_addNoteToPart=function g(a){for(var b=
a.startPart,c=b+a.parts,e=a.day,j=0,i=b;i<c;i++){b=xGetElementById(e+"_part_"+i);b.notesInPart.push(a);if(b.notesInPart.length>j)j=b.notesInPart.length}a.style.width=90/j+"%"};this.jsEvent_noteCreated=function g(a){a=this.father.tmpNote;this.draw_contextualMenu(a);a.newFather.addNote(a);sendMsgParam=eyeParam("hourFrom",a.hourFrom);sendMsgParam+=eyeParam("minFrom",a.minFrom);sendMsgParam+=eyeParam("hourEven",a.hourEven);sendMsgParam+=eyeParam("minEven",a.minEven);sendMsgParam+=eyeParam("day",a.day);
sendMsgParam+=eyeParam("id",a.cid);sendMsgParam+=eyeParam("calendar",a.calendar);sendMsg(this.father.checknum,"addNote",sendMsgParam);xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver);xRemoveEventListener(this.father.base.daysContainer,"mouseup",mouseUp);a=this.draw_editPopup(a.cid);this.father.father.parentNode.appendChild(a);a.inputText.focus();a.inputText.select()};this.draw_editBox=function g(a){var b=document.createElement("div");b.setAttribute("id","eventCotnainer");
b.className="eyeCalendar_hover";b.style.position="relative";b.style.paddingLeft="1px";b.style.paddingRight="1px";b.style.width="auto";b.style.height="auto";b.style.color="white";b.style.cursor="pointer";b.evenType="editEvent";b.style.zIndex="999";b.pid=this.father.pid;a=document.createTextNode(a);b.appendChild(a);xAddEventListener(b,"click",mouseClick);return b};this.jsEvent_setEvent=function g(a){var b=document.getElementById(this.father.tmpNote.cid+"_inputEvent");if(!b)return false;var c=this.draw_editBox(b.value);
xAddEventListener(c,"click",mouseClick);if(this.father.tmpNote.noteBody.firstChild){var e=this.father.tmpNote.noteBody.firstChild;this.father.tmpNote.noteBody.removeChild(e);IEversion&&IEversion<8||delete e}this.father.tmpNote.noteBody.appendChild(c);a=a.target.parentNode;a.parentNode.removeChild(a);a=this.father.tmpNote;sendMsgParam=eyeParam("title",b.value);sendMsgParam+=eyeParam("id",a.cid);sendMsgParam+=eyeParam("calendar",a.calendar);sendMsg(this.father.checknum,"updateTitle",sendMsgParam);this.father.evenType=
"default";xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown);xAddEventListener(this.father.base.daysContainer,"mouseup",mouseUp)};this.jsEvent_noteResized=function g(a){xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver);a=this.father.tmpNote;sendMsgParam=eyeParam("hourFrom",a.hourFrom);sendMsgParam+=eyeParam("minFrom",a.minFrom);sendMsgParam+=eyeParam("hourEven",a.hourEven);sendMsgParam+=eyeParam("minEven",a.minEven);sendMsgParam+=eyeParam("day",a.day);
sendMsgParam+=eyeParam("id",a.cid);sendMsgParam+=eyeParam("calendar",a.calendar);sendMsg(this.father.checknum,"resizeNote",sendMsgParam);this.father.evenType="default"};this.jsEvent_noteMoved=function g(a){xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver);a=this.father.tmpNote;sendMsgParam=eyeParam("hourFrom",a.hourFrom);sendMsgParam+=eyeParam("minFrom",a.minFrom);sendMsgParam+=eyeParam("hourEven",a.hourEven);sendMsgParam+=eyeParam("minEven",a.minEven);sendMsgParam+=eyeParam("day",
a.day);sendMsgParam+=eyeParam("id",a.cid);sendMsgParam+=eyeParam("calendar",a.calendar);sendMsg(this.father.checknum,"moveNote",sendMsgParam);this.father.evenType="default"};this.jsEvent_cancelEvent=function g(a){a=document.getElementById(this.father.tmpNote.cid+"_popupDiv");a.parentNode.removeChild(a);this.father.evenType="default";xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown);xAddEventListener(this.father.base.daysContainer,"mouseup",mouseUp)};this.jsEvent_hiddenCalendarNotes=
function g(a){for(var b=0;b<this.notes.length;b++){var c=this.notes[b];if(c.calendar==a){c.style.visibility="hidden";c.style.display="none"}}};this.jsEvent_showCalendarNotes=function g(a){for(var b=0;b<this.notes.length;b++){var c=this.notes[b];if(c.calendar==a){c.style.visibility="visible";c.style.display="block"}}};this.reCall_resizingNote=function g(a){if(!a.target.num)return false;a=a.target;var b=this.father.tmpNote;if(b.parts!=a.num+1&&a.num>=b.startPart){b.parts=b.parts+a.num-b.fromParts;b.fromParts=
a.num;this.draw_resizeNote(b);this.draw_title(b)}};this.reCall_movingNote=function g(a){if(isNaN(a.target.num))return false;a=a.target;var b=a.day;this.father.tmpNote.day=b;b=document.getElementById(this.father.pid+"_day_"+b);var c=0;Math.floor(a.num/this.father.parts);c=a.num+this.father.tmpNote.parts;c--;if(c<this.father.base.totalParts){this.father.tmpNote.startPart=a.num;this.father.tmpNote.fromParts=a.num+this.father.tmpNote.parts;this.draw_movedNote(b,this.father.tmpNote.startPart);this.draw_title(this.father.tmpNote)}else return false};
this.reCall_movingNoteBody=function g(a){if(isNaN(a.target.num))return false;if(!this.father.tmpNote.lastPart){this.father.tmpNote.lastPart=a.target;return false}var b=a.target.num-this.father.tmpNote.lastPart.num,c=a.target.day;this.father.tmpNote.lastPart=a.target;this.father.tmpNote.startPart+=b;a=document.getElementById(c+"_part_"+this.father.tmpNote.startPart);if(!a||isNaN(a.day))return false;c=a.day;this.father.tmpNote.day=c;c=document.getElementById(this.father.pid+"_day_"+c);b=0;Math.floor(a.num/
this.father.parts);this.father.tmpNote.startPart=a.num;this.father.tmpNote.fromParts=a.num+this.father.tmpNote.parts;this.draw_movedNote(c,this.father.tmpNote.startPart);this.draw_title(this.father.tmpNote)};this.phpEvent_newNote=function g(a,b,c,e,j,i,k,r,n,q,p){b=parseInt(b);c=(c-b)*60+(j-e);e=Math.floor(e/15);b=(b-this.father.hourFrom)*4;b+=e;e=Math.floor(c/15);n=this.draw_newNote(b,e,r,i,n,q);q=b+e;n.parts=e;n.fromParts=q;n.startPart=b;n.startPartObj=xGetElementById(a+"_part_"+b);n.day=a;n.cid=
i;n.calendar=r;p==1&&this.draw_title(n);if(k==" ")k=this.father.defaultEvenText;this.draw_event(n,k);a=document.getElementById(this.father.pid+"_day_"+a);a.appendChild(n);n.newFather=a;this.draw_contextualMenu(n);this.notes.push(n);a.addNote(n)};this.phpEvent_cleanNotes=function g(){for(var a=0;a<this.notes.length;a++){var b=this.notes[a];b.parentNode.removeChild(b)}this.notes=[]};this.phpEvent_deleteNote=function g(a){for(var b=0;b<this.notes.length;b++){var c=this.notes[b];c.cid==a&&c.parentNode.removeChild(c)}};
this.phpEvent_deleteCalendarNotes=function g(a){for(var b=0;b<this.notes.length;b++){var c=this.notes[b];if(c.calendar==a){c.parentNode.removeChild(c);delete this.notes[b]}}};this.draw_title=function g(a){var b=a.firstChild,c=a.parts,e=a.startPart/4,j=parseInt(e);if(this.father.hourFrom!=0){j=parseInt(this.father.hourFrom)+j;e+=parseFloat(this.father.hourFrom)}var i=e-j,k=i*60,r=c/4;r+=e;c=parseInt(r);var n=r-c,q=n*60;if(!(IEversion&&IEversion<8)){delete r;delete n;delete i;delete e}if(j<10)j="0"+
j;if(c<10)c="0"+c;if(k<10)k="0"+k;if(q<10)q="0"+q;if(b.firstChild){e=b.firstChild;e.data=j+":"+k+"-"+c+":"+q}else{e=document.createTextNode(j+":"+k+"-"+c+":"+q);b.appendChild(e)}a.hourFrom=j;a.hourEven=c;a.minFrom=k;a.minEven=q};this.draw_movedNote=function g(a,b){var c=this.father.tmpNote,e=this.father.pixelPart;if(IEversion==6)e+=0.5;b=b*e;b=Math.floor(b);c.style.top=b+"px";a.appendChild(c)};this.draw_newNote=function g(a,b,c,e,j,i){c||(c=1);var k=this.father.pixelPart;k*=b;var r=this.father.pixelPart;
if(IEversion==6){r+=0.5;k+=b>2?b+3:b+2}var n=a*r;a=k-this.father.pixelPart-2;a=document.createElement("div");calendarNum=c>5?c%5:c;r=this.father.noteBodyColors[calendarNum];b=this.father.noteHeaderColors[calendarNum];if(!this.father.firstTop||this.father.firstTop>n){var q=0;q=this.father.pixelPart*7;this.father.firstTop=n-q}a.setAttribute("id",this.father.pid+"_note_"+e);a.style.position="absolute";a.style.top=n+"px";a.style.left="-1px";a.style.width="100%";a.pid=this.father.pid;a.style.height=k+
"px";if(IEversion&&IEversion<8)a.style.zIndex="2";a.pid=this.father.pid;e=document.createElement("div");e.setAttribute("id","noteTitle");e.style.cursor="move";if(j!=1){e.evenType="nothingToDo";e.style.cursor="default"}e.setAttribute("id","noteTitle");e.style.backgroundColor=b;e.style.position="absolute";e.style.top="0px";e.style.height=this.father.pixelPart+"px";e.style.width="100%";e.style.borderRight="1px "+b+" solid";e.style.borderLeft="1px "+b+" solid";e.style.zIndex="4";e.style.color="white";
e.style.fontSize="80%";e.style.textIndent="4px";e.style.fontWeight="bold";e.style.lineHeight="1.4em";if(IEversion)e.onselectstart=function(){return false};a.noteHeader=e;a.appendChild(e);e=document.createElement("div");e.setAttribute("id","noteRemove");e.style.position="absolute";e.style.backgroundRepeat="no-repeat";e.style.backgroundImage="url(index.php?version="+EXTERN_CACHE_VERSION+"&theme=1&extern=images/apps/eyeCalendar/deleteNote.png)";e.style.top="0px";e.style.right="0px";e.style.height=this.father.pixelPart+
"px";e.style.width="10px";e.style.zIndex="4";e.style.cursor="pointer";e.style.color="white";e.evenType="deleteNote";xAddEventListener(e,"click",mouseClick);a.appendChild(e);k=k-this.father.pixelPart;e=document.createElement("div");e.setAttribute("id","noteBody");e.style.position="absolute";e.style.top=this.father.pixelPart+"px";e.style.backgroundColor=r;e.style.height=k+"px";e.style.width="100%";e.style.borderRight="1px "+b+" solid";e.style.zIndex="3";e.style.borderLeft="1px "+b+" solid";e.style.borderRight=
"1px "+b+" solid";if(i==1){e.style.cursor="move";e.evenType="moveNote"}else{e.evenType="nothingToDo";e.style.cursor="default"}a.noteBody=e;a.appendChild(e);i=document.createElement("div");i.setAttribute("id","noteBottom");i.style.cursor="s-resize";if(j!=1){i.evenType="nothingToDo";i.style.cursor="default"}i.style.position="absolute";i.style.bottom="0px";i.style.height="2px";i.style.width="100%";i.style.zIndex="4";i.style.left="1px";i.style.borderBottom="1px "+b+" solid";a.noteBottom=i;a.appendChild(i);
if(this.father.calendars.calendarInfo[c].show==0){a.style.visibility="hidden";a.style.display="none"}return a};this.draw_resizeNote=function g(a){var b=this.father.pixelPart;if(IEversion==6)b+=0.5;b=a.parts*b;a.style.height=b+"px";a.noteBody.style.height=b-this.father.pixelPart+"px"};this.draw_event=function g(a,b){b=this.draw_editBox(b);a.noteBody.appendChild(b)};this.draw_editPopup=function g(a,b){var c=xWidth(this.father.father),e=xHeight(this.father.father)/2-50,j=c/2-100;j+=168;c=document.createElement("div");
c.setAttribute("id",a+"_popupDiv");c.style.position="absolute";c.style.top=e+"px";c.style.left=j+"px";c.style.height="110px";c.style.width="250px";c.style.backgroundColor="white";c.style.border="1px solid gray";c.style.zIndex="999";e=document.createElement("div");e.setAttribute("id","inputText");e.style.marginLeft="15px";e.style.marginTop="10px";e.innerHTML="$lang:Text for this event:";j=document.createElement("input");j.setAttribute("id",a+"_inputEvent");j.type="text";if(b)j.value=b;j.className=
"eyeTextbox";j.style.width="220px";j.style.marginLeft="15px";j.style.marginTop="10px";j.evenType="changeEvent";j.noPrevent=true;j.pid=this.father.pid;xAddEventListener(j,"keypress",keyPress);c.appendChild(e);c.appendChild(j);c.inputText=j;a=document.createElement("button");a.setAttribute("id","buttonEvent");a.className="eyeButtonClass";a.style.position="absolute";a.style.width="70px";a.style.bottom="15px";a.style.right="15px";a.innerHTML="$lang:Accept";a.pid=this.father.pid;a.evenType="changeEvent";
xAddEventListener(a,"click",mouseClick);c.appendChild(a);a=document.createElement("button");a.setAttribute("id","buttonEvent");a.className="eyeButtonClass";a.style.position="absolute";a.style.width="70px";a.style.bottom="15px";a.style.right="100px";a.innerHTML="$lang:Cancel";a.pid=this.father.pid;a.evenType="cancelEvent";xAddEventListener(a,"click",mouseClick);c.appendChild(a);this.father.evenType="editingEvent";return c}}
function weekPlanner_events(f){this.father=f;this.mouseDown=function g(a){var b="";if(this.father&&this.father.evenType){b=this.father.evenType=="default"?a.target.evenType!="default"&&a.target.evenType!=""?a.target.evenType:"default":this.father.evenType;if(b=="editingEvent")if(a.target.evenType=="editEvent"||a.target.evenType=="changeEvent"||a.target.evenType=="cancelEvent"){this.father.evenType="default";return true}else this.father.notes.jsEvent_cancelEvent(a);else if(b=="nothingToDo"){this.father.evenType=
"default";return true}}if(a&&a.target&&a.target.id&&a.target.id!=""){if(a.target.id=="noteTitle"){this.father.notes.jsEvent_moveNote(a);return true}if(a.target.id=="noteBottom"){this.father.notes.jsEvent_resizeNote(a);return true}}if(b=="moveNote"){this.father.notes.jsEvent_moveNote(a);return true}if(b=="default"){this.father.notes.jsEvent_newNote(a);return true}};this.mouseUp=function g(a){if(!this.father.tmpNote)return false;this.father.base.daysContainer.style.cursor="pointer";this.father.tmpNote.noteBody.style.zIndex=
3;if(IEversion&&IEversion<8)this.father.tmpNote.style.zIndex=2;if(this.father.tmpNote.lastPart)if(IEversion&&IEversion<8)this.father.tmpNote.lastPart=null;else delete this.father.tmpNote.lastPart;xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver);xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown);if(this.father.evenType=="resizeNote2"){this.father.evenType="default";this.father.notes.jsEvent_noteCreated(a)}else if(this.father.evenType=="resizeNote"){this.father.evenType=
"default";this.father.notes.jsEvent_noteResized(a)}else if(this.father.evenType=="moveNote"||this.father.evenType=="moveNoteBody"){this.father.evenType="default";this.father.notes.jsEvent_noteMoved(a)}else{this.father.evenType="default";return false}};this.mouseOver=function g(a){var b="";b=this.father&&this.father.evenType&&this.father.evenType=="default"?a.target.evenType!="default"&&a.target.evenType!=""?a.target.evenType:"default":this.father.evenType;if(b=="resizeNote"||b=="resizeNote2")this.father.notes.reCall_resizingNote(a);
else if(b=="moveNote")this.father.notes.reCall_movingNote(a);else b=="moveNoteBody"&&this.father.notes.reCall_movingNoteBody(a)};this.mouseClick=function g(a){var b="";b=this.father&&this.father.evenType&&this.father.evenType=="default"||this.father.evenType=="editingEvent"?a.target.evenType!="default"&&a.target.evenType!=""?a.target.evenType:"default":this.father.evenType;if(b=="changeEvent")this.father.notes.jsEvent_setEvent(a);else if(b=="editEvent")this.father.notes.jsEvent_editEvent(a);else if(b==
"cancelEvent")this.father.notes.jsEvent_cancelEvent(a);else if(b=="selectCalendar")this.father.calendars.selectCalendar(a);else if(b=="viewCalendar")this.father.calendars.hiddenNotes(a);else if(b=="deleteNote")this.father.notes.jsEvent_deleteNote(a);else if(b=="nothingToDo")return false};this.keyPress=function g(a){var b="";b=this.father&&this.father.evenType&&this.father.evenType=="default"||this.father.evenType=="editingEvent"?a.target.evenType!="default"&&a.target.evenType!=""?a.target.evenType:
"default":this.father.evenType;b=="changeEvent"&&a.keyCode==13&&this.father.notes.jsEvent_setEvent(a)}}function mouseDown(f){var g=new xEvent(f);g.target.noPrevent||xPreventDefault(f);if(!g||!g.target||!g.target.id)return false;if(g.target.pid)f=g.target.pid;else{f=calendar_GetPid(g.target);if(!f)return false}weekPlanner_instances[f].events.mouseDown(g)}
function mouseOver(f){xPreventDefault(f);f=new xEvent(f);if(!f||!f.target||!f.target.id)return false;var g;if(f.target.pid)g=f.target.pid;else{g=calendar_GetPid(f.target);if(!g)return false}weekPlanner_instances[g].events.mouseOver(f)}function mouseUp(f){xPreventDefault(f);f=new xEvent(f);if(!f||!f.target||!f.target.id)return false;var g;if(f.target.id!="eyeApps"){if(f.target.pid)g=f.target.pid;else{g=calendar_GetPid(f.target);if(!g)return false}weekPlanner_instances[g].events.mouseUp(f)}}
function mouseClick(f){var g=new xEvent(f);if(!g||!g.target||!g.target.id)return false;g.target.noPrevent||xPreventDefault(f);if(g.target.pid)f=g.target.pid;else{f=calendar_GetPid(g.target);if(!f)return false}weekPlanner_instances[f].events.mouseClick(g)}function keyPress(f){f=new xEvent(f);var g;if(f.target.pid)g=f.target.pid;else{g=calendar_GetPid(f.target);if(!g)return false}weekPlanner_instances[g].events.keyPress(f)}
function calculePart(f,g){f=Math.floor(f*100/g);if(f<=25)return 1;if(f<=50)return 2;if(f<=75)return 3;if(f<=100)return 4}
function resizeDays(){var f=parseInt(this.numDays)+0.1;this.rowWidth=(xWidth(this.base.daysBase)-f)/this.numDays;f="";for(h=this.dayFrom;h<=this.numDays-1;h++){f=xGetElementById(this.pid+"_dayTodo_"+h);f.style.width=this.rowWidth+"px";f=xGetElementById(this.pid+"_dayName_"+h);f.style.width=this.rowWidth+"px";f=xGetElementById(this.pid+"_day_"+h);f.style.width=this.rowWidth+"px"}f=xGetElementById(this.pid+"_fatherDays");f.style.height=f.parentNode.style.height}
function onResizeEyeCalendar(f){weekPlanner_instances[f].resizeDays()}function onChangeDateCalendar(f,g,a,b){weekPlanner_instances[f].base.changeDate(g,a,b)}function onAddNoteCalendar(f,g,a,b,c,e,j,i,k,r,n,q){weekPlanner_instances[f].notes.phpEvent_newNote(g,a,b,c,e,j,i,k,r,n,q)}function onCleanNotesCalendar(f){weekPlanner_instances[f].notes.phpEvent_cleanNotes()}function onCleanCalendars(f){weekPlanner_instances[f].calendars.cleanCalendars()}
function onAddCalendar(f,g,a,b){weekPlanner_instances[f].calendars.drawCalendar(g,a,b)}function onShowNotesCalendar(f,g){weekPlanner_instances[f].notes.jsEvent_showCalendarNotes(g)}function onHiddenNotesCalendar(f,g){weekPlanner_instances[f].notes.jsEvent_hiddenCalendarNotes(g)}function onDeleteCalendarNotes(f,g){weekPlanner_instances[f].notes.phpEvent_deleteCalendarNotes(g)}function onDeleteNote(f,g){weekPlanner_instances[f].notes.phpEvent_deleteNote(g)}
function onSelectCalendar(f,g){weekPlanner_instances[f].calendars.phpSelectCalendar(g)}function onGoToFirstNote(f){weekPlanner_instances[f].base.goToFirstNote()}function calendar_updateCurrentHour(f){weekPlanner_instances[f]&&weekPlanner_instances[f].base.updateCurrentHour(f)}function calendar_GetPid(f){f=f.parentNode;for(var g=0;g<5;g++){if(f.pid)return f.pid;f=f.parentNode}}function init_calendar(){sendMsg(eyeCalendarChecknum,"Launch","")}init_calendar();
