tinyMCEPopup.requireLangPack();var ed;
function init(){ed=tinyMCEPopup.editor;tinyMCEPopup.resizeToInnerSize();document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table");document.getElementById("bordercolor_pickcontainer").innerHTML=getColorPickerHTML("bordercolor_pick","bordercolor");document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");var a=ed.dom.getParent(ed.selection.getNode(),"td,th"),b=document.forms[0],
e=ed.dom.parseStyle(ed.dom.getAttrib(a,"style")),c=a.nodeName.toLowerCase(),d=ed.dom.getAttrib(a,"align"),f=ed.dom.getAttrib(a,"valign"),g=trimSize(getStyle(a,"width","width")),h=trimSize(getStyle(a,"height","height")),i=convertRGBToHex(getStyle(a,"bordercolor","borderLeftColor")),j=convertRGBToHex(getStyle(a,"bgcolor","backgroundColor")),k=ed.dom.getAttrib(a,"class"),l=getStyle(a,"background","backgroundImage").replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1"),m=ed.dom.getAttrib(a,"id"),n=ed.dom.getAttrib(a,
"lang"),o=ed.dom.getAttrib(a,"dir");a=ed.dom.getAttrib(a,"scope");addClassesToList("class","table_cell_styles");TinyMCE_EditableSelects.init();b.bordercolor.value=i;b.bgcolor.value=j;b.backgroundimage.value=l;b.width.value=g;b.height.value=h;b.id.value=m;b.lang.value=n;b.style.value=ed.dom.serializeStyle(e);selectByValue(b,"align",d);selectByValue(b,"valign",f);selectByValue(b,"class",k,true,true);selectByValue(b,"celltype",c);selectByValue(b,"dir",o);selectByValue(b,"scope",a);if(isVisible("backgroundimagebrowser"))document.getElementById("backgroundimage").style.width=
"180px";updateColor("bordercolor_pick","bordercolor");updateColor("bgcolor_pick","bgcolor")}
function updateAction(){var a,b=ed,e,c,d=document.forms[0];tinyMCEPopup.restoreSelection();a=ed.selection.getNode();e=ed.dom.getParent(a,"td,th");c=ed.dom.getParent(a,"tr");a=ed.dom.getParent(a,"table");ed.execCommand("mceBeginUndoLevel");switch(getSelectValue(d,"action")){case "cell":c=getSelectValue(d,"celltype");d=getSelectValue(d,"scope");function f(g){if(g){updateCell(e);ed.addVisual();ed.nodeChanged();b.execCommand("mceEndUndoLevel");tinyMCEPopup.close()}}if(ed.getParam("accessibility_warnings",
1)){c=="th"&&d==""?tinyMCEPopup.confirm(ed.getLang("table_dlg.missing_scope","",true),f):f(1);return}updateCell(e);break;case "row":d=c.firstChild;if(d.nodeName!="TD"&&d.nodeName!="TH")d=nextCell(d);do d=updateCell(d,true);while((d=nextCell(d))!=null);break;case "all":c=a.getElementsByTagName("tr");for(a=0;a<c.length;a++){d=c[a].firstChild;if(d.nodeName!="TD"&&d.nodeName!="TH")d=nextCell(d);do d=updateCell(d,true);while((d=nextCell(d))!=null)}break}ed.addVisual();ed.nodeChanged();b.execCommand("mceEndUndoLevel");
tinyMCEPopup.close()}function nextCell(a){for(;(a=a.nextSibling)!=null;)if(a.nodeName=="TD"||a.nodeName=="TH")return a;return null}
function updateCell(a,b){var e=ed,c=document.forms[0],d=a.nodeName.toLowerCase(),f=getSelectValue(c,"celltype"),g=e.getDoc();e=ed.dom;b||a.setAttribute("id",c.id.value);a.setAttribute("align",c.align.value);a.setAttribute("vAlign",c.valign.value);a.setAttribute("lang",c.lang.value);a.setAttribute("dir",getSelectValue(c,"dir"));a.setAttribute("style",ed.dom.serializeStyle(ed.dom.parseStyle(c.style.value)));a.setAttribute("scope",c.scope.value);ed.dom.setAttrib(a,"class",getSelectValue(c,"class"));
ed.dom.setAttrib(a,"width","");ed.dom.setAttrib(a,"height","");ed.dom.setAttrib(a,"bgColor","");ed.dom.setAttrib(a,"borderColor","");ed.dom.setAttrib(a,"background","");a.style.width=getCSSSize(c.width.value);a.style.height=getCSSSize(c.height.value);if(c.bordercolor.value!=""){a.style.borderColor=c.bordercolor.value;a.style.borderStyle=a.style.borderStyle==""?"solid":a.style.borderStyle;a.style.borderWidth=a.style.borderWidth==""?"1px":a.style.borderWidth}else a.style.borderColor="";a.style.backgroundColor=
c.bgcolor.value;a.style.backgroundImage=c.backgroundimage.value!=""?"url('"+c.backgroundimage.value+"')":"";if(d!=f){b=g.createElement(f);for(c=0;c<a.childNodes.length;c++)b.appendChild(a.childNodes[c].cloneNode(1));for(c=0;c<a.attributes.length;c++)ed.dom.setAttrib(b,a.attributes[c].name,ed.dom.getAttrib(a,a.attributes[c].name));a.parentNode.replaceChild(b,a);a=b}e.setAttrib(a,"style",e.serializeStyle(e.parseStyle(a.style.cssText)));return a}
function changedBackgroundImage(){var a=document.forms[0],b=ed.dom.parseStyle(a.style.value);b["background-image"]="url('"+a.backgroundimage.value+"')";a.style.value=ed.dom.serializeStyle(b)}function changedSize(){var a=document.forms[0],b=ed.dom.parseStyle(a.style.value),e=a.width.value;b.width=e!=""?getCSSSize(e):"";e=a.height.value;b.height=e!=""?getCSSSize(e):"";a.style.value=ed.dom.serializeStyle(b)}
function changedColor(){var a=document.forms[0],b=ed.dom.parseStyle(a.style.value);b["background-color"]=a.bgcolor.value;b["border-color"]=a.bordercolor.value;a.style.value=ed.dom.serializeStyle(b)}
function changedStyle(){var a=document.forms[0],b=ed.dom.parseStyle(a.style.value);a.backgroundimage.value=b["background-image"]?b["background-image"].replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1"):"";if(b.width)a.width.value=trimSize(b.width);if(b.height)a.height.value=trimSize(b.height);if(b["background-color"]){a.bgcolor.value=b["background-color"];updateColor("bgcolor_pick","bgcolor")}if(b["border-color"]){a.bordercolor.value=b["border-color"];updateColor("bordercolor_pick","bordercolor")}}
tinyMCEPopup.onInit.add(init);
