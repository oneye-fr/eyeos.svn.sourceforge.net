tinyMCEPopup.requireLangPack();
var doc,defaultDocTypes='XHTML 1.0 Transitional=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">,XHTML 1.0 Frameset=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">,XHTML 1.0 Strict=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">,XHTML 1.1=<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">,HTML 4.01 Transitional=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">,HTML 4.01 Strict=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">,HTML 4.01 Frameset=<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">',defaultEncodings=
"Western european (iso-8859-1)=iso-8859-1,Central European (iso-8859-2)=iso-8859-2,Unicode (UTF-8)=utf-8,Chinese traditional (Big5)=big5,Cyrillic (iso-8859-5)=iso-8859-5,Japanese (iso-2022-jp)=iso-2022-jp,Greek (iso-8859-7)=iso-8859-7,Korean (iso-2022-kr)=iso-2022-kr,ASCII (us-ascii)=us-ascii",defaultMediaTypes="all=all,screen=screen,print=print,tty=tty,tv=tv,projection=projection,handheld=handheld,braille=braille,aural=aural",defaultFontNames="Arial=arial,helvetica,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,times new roman,times,serif;Tahoma=tahoma,arial,helvetica,sans-serif;Times New Roman=times new roman,times,serif;Verdana=verdana,arial,helvetica,sans-serif;Impact=impact;WingDings=wingdings",
defaultFontSizes="10px,11px,12px,13px,14px,15px,16px";
function init(){var a=document.forms.fullpage,c=a.elements,e,b,d,g,i=tinyMCEPopup.editor,l=tinyMCEPopup.dom;g=i.getParam("fullpage_doctypes",defaultDocTypes).split(",");for(b=0;b<g.length;b++){d=g[b].split("=");d.length>1&&addSelectValue(a,"doctypes",d[0],d[1])}g=i.getParam("fullpage_fonts",defaultFontNames).split(";");for(b=0;b<g.length;b++){d=g[b].split("=");d.length>1&&addSelectValue(a,"fontface",d[0],d[1])}g=i.getParam("fullpage_fontsizes",defaultFontSizes).split(",");for(b=0;b<g.length;b++)addSelectValue(a,
"fontsize",g[b],g[b]);g=i.getParam("fullpage_media_types",defaultMediaTypes).split(",");for(b=0;b<g.length;b++){d=g[b].split("=");if(d.length>1){addSelectValue(a,"element_style_media",d[0],d[1]);addSelectValue(a,"element_link_media",d[0],d[1])}}g=i.getParam("fullpage_encodings",defaultEncodings).split(",");for(b=0;b<g.length;b++){d=g[b].split("=");if(d.length>1){addSelectValue(a,"docencoding",d[0],d[1]);addSelectValue(a,"element_script_charset",d[0],d[1]);addSelectValue(a,"element_link_charset",d[0],
d[1])}}document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");document.getElementById("link_color_pickcontainer").innerHTML=getColorPickerHTML("link_color_pick","link_color");document.getElementById("visited_color_pickcontainer").innerHTML=getColorPickerHTML("visited_color_pick","visited_color");document.getElementById("active_color_pickcontainer").innerHTML=getColorPickerHTML("active_color_pick","active_color");document.getElementById("textcolor_pickcontainer").innerHTML=
getColorPickerHTML("textcolor_pick","textcolor");document.getElementById("stylesheet_browsercontainer").innerHTML=getBrowserHTML("stylesheetbrowser","stylesheet","file","fullpage");document.getElementById("link_href_pickcontainer").innerHTML=getBrowserHTML("link_href_browser","element_link_href","file","fullpage");document.getElementById("script_src_pickcontainer").innerHTML=getBrowserHTML("script_src_browser","element_script_src","file","fullpage");document.getElementById("bgimage_pickcontainer").innerHTML=
getBrowserHTML("bgimage_browser","bgimage","image","fullpage");if(isVisible("stylesheetbrowser"))document.getElementById("stylesheet").style.width="220px";if(isVisible("link_href_browser"))document.getElementById("element_link_href").style.width="230px";if(isVisible("bgimage_browser"))document.getElementById("bgimage").style.width="210px";l.add(document.body,"iframe",{id:"documentIframe",src:'javascript:""',style:{display:"none"}});doc=l.get("documentIframe").contentWindow.document;h=tinyMCEPopup.getWindowArg("head_html");
h=h.replace(/<script>/gi,'<script type="text/javascript">');h=h.replace(/type=([\"\'])?/gi,"type=$1-mce-");h=h.replace(/(src=|href=)/g,"mce_$1");doc.write(h+"</body></html>");doc.close();xmlVer=getReItem(/<\?\s*?xml.*?version\s*?=\s*?"(.*?)".*?\?>/gi,h,1);xmlEnc=getReItem(/<\?\s*?xml.*?encoding\s*?=\s*?"(.*?)".*?\?>/gi,h,1);docType=getReItem(/<\!DOCTYPE.*?>/gi,h.replace(/\n/g,""),0).replace(/ +/g," ");a.langcode.value=getReItem(/lang="(.*?)"/gi,h,1);if(e=doc.getElementsByTagName("title")[0])c.metatitle.value=
e.textContent||e.text;tinymce.each(doc.getElementsByTagName("meta"),function(f){var j=(f.getAttribute("name",2)||"").toLowerCase(),k=f.getAttribute("content",2);f=f.getAttribute("httpEquiv",2)||"";e=c["meta"+j];if(j=="robots")selectByValue(a,"metarobots",tinymce.trim(k),true,true);else{switch(f.toLowerCase()){case "content-type":tmp=getReItem(/charset\s*=\s*(.*)\s*/gi,k,1);if(tmp!="")xmlEnc=tmp;return}if(e)e.value=k}});selectByValue(a,"doctypes",docType,true,true);selectByValue(a,"docencoding",xmlEnc,
true,true);selectByValue(a,"langdir",doc.body.getAttribute("dir",2)||"",true,true);if(xmlVer!="")c.xml_pi.checked=true;tinymce.each(doc.getElementsByTagName("link"),function(f){var j=f.getAttribute("media",2)||"";if((f.getAttribute("type",2)||"")=="-mce-text/css"&&(j==""||j=="screen"||j=="all")&&(f.getAttribute("rel",2)||"")=="stylesheet"){a.stylesheet.value=f.getAttribute("mce_href",2)||"";return false}});tinymce.each(doc.getElementsByTagName("style"),function(f){f=parseStyleElement(f);for(x=0;x<
f.length;x++){if(f[x].rule.indexOf("a:visited")!=-1&&f[x].data.color)a.visited_color.value=f[x].data.color;if(f[x].rule.indexOf("a:link")!=-1&&f[x].data.color)a.link_color.value=f[x].data.color;if(f[x].rule.indexOf("a:active")!=-1&&f[x].data.color)a.active_color.value=f[x].data.color}});a.textcolor.value=tinyMCEPopup.dom.getAttrib(doc.body,"text");a.active_color.value=tinyMCEPopup.dom.getAttrib(doc.body,"alink");a.link_color.value=tinyMCEPopup.dom.getAttrib(doc.body,"link");a.visited_color.value=
tinyMCEPopup.dom.getAttrib(doc.body,"vlink");a.bgcolor.value=tinyMCEPopup.dom.getAttrib(doc.body,"bgcolor");a.bgimage.value=tinyMCEPopup.dom.getAttrib(doc.body,"background");b=tinyMCEPopup.dom.parseStyle(tinyMCEPopup.dom.getAttrib(doc.body,"style"));b["font-family"]?selectByValue(a,"fontface",b["font-family"],true,true):selectByValue(a,"fontface",i.getParam("fullpage_default_fontface",""),true,true);b["font-size"]?selectByValue(a,"fontsize",b["font-size"],true,true):selectByValue(a,"fontsize",i.getParam("fullpage_default_fontsize",
""),true,true);if(b.color)a.textcolor.value=convertRGBToHex(b.color);if(b["background-image"])a.bgimage.value=b["background-image"].replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1");if(b["background-color"])a.bgcolor.value=b["background-color"];if(b.margin){tmp=b.margin.replace(/[^0-9 ]/g,"");tmp=tmp.split(/ +/);a.topmargin.value=tmp.length>0?tmp[0]:"";a.rightmargin.value=tmp.length>1?tmp[1]:tmp[0];a.bottommargin.value=tmp.length>2?tmp[2]:tmp[0];a.leftmargin.value=tmp.length>3?tmp[3]:tmp[0]}if(b["margin-left"])a.leftmargin.value=
b["margin-left"].replace(/[^0-9]/g,"");if(b["margin-right"])a.rightmargin.value=b["margin-right"].replace(/[^0-9]/g,"");if(b["margin-top"])a.topmargin.value=b["margin-top"].replace(/[^0-9]/g,"");if(b["margin-bottom"])a.bottommargin.value=b["margin-bottom"].replace(/[^0-9]/g,"");a.style.value=tinyMCEPopup.dom.serializeStyle(b);updateColor("textcolor_pick","textcolor");updateColor("bgcolor_pick","bgcolor");updateColor("visited_color_pick","visited_color");updateColor("active_color_pick","active_color");
updateColor("link_color_pick","link_color")}function getReItem(a,c,e){if((a=a.exec(c))&&a.length>e)return a[e];return""}
function updateAction(){var a=document.forms[0],c,e,b,d,g;c=true;b=doc.getElementsByTagName("head")[0];c=doc.getElementsByTagName("script");for(e=0;e<c.length;e++)tinyMCEPopup.dom.getAttrib(c[e],"mce_type")==""&&c[e].setAttribute("mce_type","text/javascript");c=doc.getElementsByTagName("link");for(e=0;e<c.length;e++){d=c[e];g=tinyMCEPopup.dom.getAttrib(d,"media");if(tinyMCEPopup.dom.getAttrib(d,"mce_type")=="text/css"&&(g==""||g=="screen"||g=="all")&&tinyMCEPopup.dom.getAttrib(d,"rel")=="stylesheet"){a.stylesheet.value==
""?d.parentNode.removeChild(d):d.setAttribute("mce_href",a.stylesheet.value);break}}if(a.stylesheet.value!=""){d=doc.createElement("link");d.setAttribute("type","text/css");d.setAttribute("mce_href",a.stylesheet.value);d.setAttribute("rel","stylesheet");b.appendChild(d)}setMeta(b,"keywords",a.metakeywords.value);setMeta(b,"description",a.metadescription.value);setMeta(b,"author",a.metaauthor.value);setMeta(b,"copyright",a.metacopyright.value);setMeta(b,"robots",getSelectValue(a,"metarobots"));setMeta(b,
"Content-Type",getSelectValue(a,"docencoding"));doc.body.dir=getSelectValue(a,"langdir");doc.body.style.cssText=a.style.value;doc.body.setAttribute("vLink",a.visited_color.value);doc.body.setAttribute("link",a.link_color.value);doc.body.setAttribute("text",a.textcolor.value);doc.body.setAttribute("aLink",a.active_color.value);doc.body.style.fontFamily=getSelectValue(a,"fontface");doc.body.style.fontSize=getSelectValue(a,"fontsize");doc.body.style.backgroundColor=a.bgcolor.value;if(a.leftmargin.value!=
"")doc.body.style.marginLeft=a.leftmargin.value+"px";if(a.rightmargin.value!="")doc.body.style.marginRight=a.rightmargin.value+"px";if(a.bottommargin.value!="")doc.body.style.marginBottom=a.bottommargin.value+"px";if(a.topmargin.value!="")doc.body.style.marginTop=a.topmargin.value+"px";c=doc.getElementsByTagName("html")[0];c.setAttribute("lang",a.langcode.value);c.setAttribute("xml:lang",a.langcode.value);doc.body.style.backgroundImage=a.bgimage.value!=""?"url('"+a.bgimage.value+"')":"";c=tinyMCEPopup.editor.plugins.fullpage._createSerializer();
c.setRules("-title,meta[http-equiv|name|content],base[href|target],link[href|rel|type|title|media],style[type],script[type|language|src],html[lang|xml::lang|xmlns],body[style|dir|vlink|link|text|alink],head");c=c.serialize(doc.documentElement);c=c.substring(0,c.lastIndexOf("</body>"));c=c.indexOf("<title>")==-1?c.replace(/<head.*?>/,"$&\n<title>"+tinyMCEPopup.dom.encode(a.metatitle.value)+"</title>"):c.replace(/<title>(.*?)<\/title>/,"<title>"+tinyMCEPopup.dom.encode(a.metatitle.value)+"</title>");
if((e=getSelectValue(a,"doctypes"))!="")c=e+"\n"+c;if(a.xml_pi.checked){b='<?xml version="1.0"';if((e=getSelectValue(a,"docencoding"))!="")b+=' encoding="'+e+'"';b+="?>\n";c=b+c}c=c.replace(/type=\"\-mce\-/gi,'type="');tinyMCEPopup.editor.plugins.fullpage.head=c;tinyMCEPopup.editor.plugins.fullpage._setBodyAttribs(tinyMCEPopup.editor,{});tinyMCEPopup.close()}function changedStyleField(a){}
function setMeta(a,c,e){var b,d;b=a.getElementsByTagName("meta");for(d=0;d<b.length;d++){if(c=="Content-Type"&&tinyMCEPopup.dom.getAttrib(b[d],"http-equiv")==c){e==""?b[d].parentNode.removeChild(b[d]):b[d].setAttribute("content","text/html; charset="+e);return}if(tinyMCEPopup.dom.getAttrib(b[d],"name")==c){e==""?b[d].parentNode.removeChild(b[d]):b[d].setAttribute("content",e);return}}if(e!=""){b=doc.createElement("meta");if(c=="Content-Type")b.httpEquiv=c;else b.setAttribute("name",c);b.setAttribute("content",
e);a.appendChild(b)}}function parseStyleElement(a){var c=a.innerHTML,e;c=c.replace(/<!--/gi,"");c=c.replace(/--\>/gi,"");c=c.replace(/[\n\r]/gi,"");c=c.replace(/\s+/gi," ");a=[];c=c.split(/{|}/);for(e=0;e<c.length;e+=2)if(c[e]!="")a[a.length]={rule:tinymce.trim(c[e]),data:tinyMCEPopup.dom.parseStyle(c[e+1])};return a}
function serializeStyleElement(a){var c,e,b;e="<!--\n";for(c=0;c<a.length;c++){e+=a[c].rule+" {\n";b=tinyMCE.serializeStyle(a[c].data);if(b!="")b+=";";e+=b.replace(/;/g,";\n");e+="}\n";if(c!=a.length-1)e+="\n"}e+="\n--\>";return e}tinyMCEPopup.onInit.add(init);
