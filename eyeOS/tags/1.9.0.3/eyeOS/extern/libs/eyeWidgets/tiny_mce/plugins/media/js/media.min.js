tinyMCEPopup.requireLangPack();var oldWidth,oldHeight,ed,url;if(url=tinyMCEPopup.getParam("media_external_list_url"))document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(url)+'"><\/script>');
function init(){var a="",b,c,e="flash",f;ed=tinyMCEPopup.editor;tinyMCEPopup.resizeToInnerSize();b=document.forms[0];f=ed.selection.getNode();if(/mceItem(Flash|ShockWave|WindowsMedia|QuickTime|RealMedia)/.test(ed.dom.getAttrib(f,"class"))){a=f.title;switch(ed.dom.getAttrib(f,"class")){case "mceItemFlash":e="flash";break;case "mceItemFlashVideo":e="flv";break;case "mceItemShockWave":e="shockwave";break;case "mceItemWindowsMedia":e="wmp";break;case "mceItemQuickTime":e="qt";break;case "mceItemRealMedia":e=
"rmp";break}document.forms[0].insert.value=ed.getLang("update","Insert",true)}document.getElementById("filebrowsercontainer").innerHTML=getBrowserHTML("filebrowser","src","media","media");document.getElementById("qtsrcfilebrowsercontainer").innerHTML=getBrowserHTML("qtsrcfilebrowser","qt_qtsrc","media","media");document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");c=getMediaListHTML("medialist","src","media","media");if(c=="")document.getElementById("linklistrow").style.display=
"none";else document.getElementById("linklistcontainer").innerHTML=c;if(isVisible("filebrowser"))document.getElementById("src").style.width="230px";if(a!=""){a=tinyMCEPopup.editor.plugins.media._parse(a);switch(e){case "flash":setBool(a,"flash","play");setBool(a,"flash","loop");setBool(a,"flash","menu");setBool(a,"flash","swliveconnect");setStr(a,"flash","quality");setStr(a,"flash","scale");setStr(a,"flash","salign");setStr(a,"flash","wmode");setStr(a,"flash","base");setStr(a,"flash","flashvars");
break;case "qt":setBool(a,"qt","loop");setBool(a,"qt","autoplay");setBool(a,"qt","cache");setBool(a,"qt","controller");setBool(a,"qt","correction");setBool(a,"qt","enablejavascript");setBool(a,"qt","kioskmode");setBool(a,"qt","autohref");setBool(a,"qt","playeveryframe");setBool(a,"qt","tarsetcache");setStr(a,"qt","scale");setStr(a,"qt","starttime");setStr(a,"qt","endtime");setStr(a,"qt","tarset");setStr(a,"qt","qtsrcchokespeed");setStr(a,"qt","volume");setStr(a,"qt","qtsrc");break;case "shockwave":setBool(a,
"shockwave","sound");setBool(a,"shockwave","progress");setBool(a,"shockwave","autostart");setBool(a,"shockwave","swliveconnect");setStr(a,"shockwave","swvolume");setStr(a,"shockwave","swstretchstyle");setStr(a,"shockwave","swstretchhalign");setStr(a,"shockwave","swstretchvalign");break;case "wmp":setBool(a,"wmp","autostart");setBool(a,"wmp","enabled");setBool(a,"wmp","enablecontextmenu");setBool(a,"wmp","fullscreen");setBool(a,"wmp","invokeurls");setBool(a,"wmp","mute");setBool(a,"wmp","stretchtofit");
setBool(a,"wmp","windowlessvideo");setStr(a,"wmp","balance");setStr(a,"wmp","baseurl");setStr(a,"wmp","captioningid");setStr(a,"wmp","currentmarker");setStr(a,"wmp","currentposition");setStr(a,"wmp","defaultframe");setStr(a,"wmp","playcount");setStr(a,"wmp","rate");setStr(a,"wmp","uimode");setStr(a,"wmp","volume");break;case "rmp":setBool(a,"rmp","autostart");setBool(a,"rmp","loop");setBool(a,"rmp","autogotourl");setBool(a,"rmp","center");setBool(a,"rmp","imagestatus");setBool(a,"rmp","maintainaspect");
setBool(a,"rmp","nojava");setBool(a,"rmp","prefetch");setBool(a,"rmp","shuffle");setStr(a,"rmp","console");setStr(a,"rmp","controls");setStr(a,"rmp","numloop");setStr(a,"rmp","scriptcallbacks");break}setStr(a,null,"src");setStr(a,null,"id");setStr(a,null,"name");setStr(a,null,"vspace");setStr(a,null,"hspace");setStr(a,null,"bgcolor");setStr(a,null,"align");setStr(a,null,"width");setStr(a,null,"height");if((c=ed.dom.getAttrib(f,"width"))!="")a.width=b.width.value=c;if((c=ed.dom.getAttrib(f,"height"))!=
"")a.height=b.height.value=c;oldWidth=a.width?parseInt(a.width):0;oldHeight=a.height?parseInt(a.height):0}else oldWidth=oldHeight=0;selectByValue(b,"media_type",e);changedType(e);updateColor("bgcolor_pick","bgcolor");TinyMCE_EditableSelects.init();generatePreview()}
function insertMedia(){var a,b=document.forms[0];tinyMCEPopup.restoreSelection();if(!AutoValidator.validate(b)){tinyMCEPopup.alert(ed.getLang("invalid_data"));return false}b.width.value=b.width.value==""?100:b.width.value;b.height.value=b.height.value==""?100:b.height.value;a=ed.selection.getNode();if(a!=null&&/mceItem(Flash|ShockWave|WindowsMedia|QuickTime|RealMedia)/.test(ed.dom.getAttrib(a,"class"))){switch(b.media_type.options[b.media_type.selectedIndex].value){case "flash":a.className="mceItemFlash";
break;case "flv":a.className="mceItemFlashVideo";break;case "shockwave":a.className="mceItemShockWave";break;case "qt":a.className="mceItemQuickTime";break;case "wmp":a.className="mceItemWindowsMedia";break;case "rmp":a.className="mceItemRealMedia";break}if(a.width!=b.width.value||a.height!=b.height.value)ed.execCommand("mceRepaint");a.title=serializeParameters();a.width=b.width.value;a.height=b.height.value;a.style.width=b.width.value+(b.width.value.indexOf("%")==-1?"px":"");a.style.height=b.height.value+
(b.height.value.indexOf("%")==-1?"px":"");a.align=b.align.options[b.align.selectedIndex].value}else{a='<img src="'+tinyMCEPopup.getWindowArg("plugin_url")+'/img/trans.gif"';switch(b.media_type.options[b.media_type.selectedIndex].value){case "flash":a+=' class="mceItemFlash"';break;case "flv":a+=' class="mceItemFlashVideo"';break;case "shockwave":a+=' class="mceItemShockWave"';break;case "qt":a+=' class="mceItemQuickTime"';break;case "wmp":a+=' class="mceItemWindowsMedia"';break;case "rmp":a+=' class="mceItemRealMedia"';
break}a+=' title="'+serializeParameters()+'"';a+=' width="'+b.width.value+'"';a+=' height="'+b.height.value+'"';a+=' align="'+b.align.options[b.align.selectedIndex].value+'"';a+=" />";ed.execCommand("mceInsertContent",false,a)}tinyMCEPopup.close()}function updatePreview(){var a=document.forms[0],b;a.width.value=a.width.value||"320";a.height.value=a.height.value||"240";b=getType(a.src.value);selectByValue(a,"media_type",b);changedType(b);generatePreview()}
function getMediaListHTML(){if(typeof tinyMCEMediaList!="undefined"&&tinyMCEMediaList.length>0){var a="";a+='<select id="linklist" name="linklist" style="width: 250px" onchange="this.form.src.value=this.options[this.selectedIndex].value;updatePreview();">';a+='<option value="">---</option>';for(var b=0;b<tinyMCEMediaList.length;b++)a+='<option value="'+tinyMCEMediaList[b][1]+'">'+tinyMCEMediaList[b][0]+"</option>";a+="</select>";return a}return""}
function getType(a){var b,c,e,f,d;c=document.forms[0];b=ed.getParam("media_types","flash=swf;flv=flv;shockwave=dcr;qt=mov,qt,mpg,mp3,mp4,mpeg;shockwave=dcr;wmp=avi,wmv,wm,asf,asx,wmx,wvx;rmp=rm,ra,ram").split(";");if(a.match(/watch\?v=(.+)(.*)/)){c.width.value="425";c.height.value="350";c.src.value="http://www.youtube.com/v/"+a.match(/v=(.*)(.*)/)[0].split("=")[1];return"flash"}if(a.indexOf("http://video.google.com/videoplay?docid=")==0){c.width.value="425";c.height.value="326";c.src.value="http://video.google.com/googleplayer.swf?docId="+
a.substring(40)+"&hl=en";return"flash"}for(c=0;c<b.length;c++){e=b[c].split("=");f=e[1].split(",");for(d=0;d<f.length;d++)if(a.indexOf("."+f[d])!=-1)return e[0]}return null}function switchType(a){a=getType(a);var b=document,c=b.forms[0];if(a){selectByValue(b.forms[0],"media_type",a);changedType(a);if(a=="qt"&&c.src.value.toLowerCase().indexOf("rtsp://")!=-1){alert(ed.getLang("media_qt_stream_warn"));if(c.qt_qtsrc.value=="")c.qt_qtsrc.value=c.src.value}}}
function changedType(a){var b=document;b.getElementById("flash_options").style.display="none";b.getElementById("flv_options").style.display="none";b.getElementById("qt_options").style.display="none";b.getElementById("shockwave_options").style.display="none";b.getElementById("wmp_options").style.display="none";b.getElementById("rmp_options").style.display="none";if(a)b.getElementById(a+"_options").style.display="block"}
function serializeParameters(){var a=document.forms[0],b="";switch(a.media_type.options[a.media_type.selectedIndex].value){case "flash":b+=getBool("flash","play",true);b+=getBool("flash","loop",true);b+=getBool("flash","menu",true);b+=getBool("flash","swliveconnect",false);b+=getStr("flash","quality");b+=getStr("flash","scale");b+=getStr("flash","salign");b+=getStr("flash","wmode");b+=getStr("flash","base");b+=getStr("flash","flashvars");break;case "qt":b+=getBool("qt","loop",false);b+=getBool("qt",
"autoplay",true);b+=getBool("qt","cache",false);b+=getBool("qt","controller",true);b+=getBool("qt","correction",false,"none","full");b+=getBool("qt","enablejavascript",false);b+=getBool("qt","kioskmode",false);b+=getBool("qt","autohref",false);b+=getBool("qt","playeveryframe",false);b+=getBool("qt","targetcache",false);b+=getStr("qt","scale");b+=getStr("qt","starttime");b+=getStr("qt","endtime");b+=getStr("qt","target");b+=getStr("qt","qtsrcchokespeed");b+=getStr("qt","volume");b+=getStr("qt","qtsrc");
break;case "shockwave":b+=getBool("shockwave","sound");b+=getBool("shockwave","progress");b+=getBool("shockwave","autostart");b+=getBool("shockwave","swliveconnect");b+=getStr("shockwave","swvolume");b+=getStr("shockwave","swstretchstyle");b+=getStr("shockwave","swstretchhalign");b+=getStr("shockwave","swstretchvalign");break;case "wmp":b+=getBool("wmp","autostart",true);b+=getBool("wmp","enabled",false);b+=getBool("wmp","enablecontextmenu",true);b+=getBool("wmp","fullscreen",false);b+=getBool("wmp",
"invokeurls",true);b+=getBool("wmp","mute",false);b+=getBool("wmp","stretchtofit",false);b+=getBool("wmp","windowlessvideo",false);b+=getStr("wmp","balance");b+=getStr("wmp","baseurl");b+=getStr("wmp","captioningid");b+=getStr("wmp","currentmarker");b+=getStr("wmp","currentposition");b+=getStr("wmp","defaultframe");b+=getStr("wmp","playcount");b+=getStr("wmp","rate");b+=getStr("wmp","uimode");b+=getStr("wmp","volume");break;case "rmp":b+=getBool("rmp","autostart",false);b+=getBool("rmp","loop",false);
b+=getBool("rmp","autogotourl",true);b+=getBool("rmp","center",false);b+=getBool("rmp","imagestatus",true);b+=getBool("rmp","maintainaspect",false);b+=getBool("rmp","nojava",false);b+=getBool("rmp","prefetch",false);b+=getBool("rmp","shuffle",false);b+=getStr("rmp","console");b+=getStr("rmp","controls");b+=getStr("rmp","numloop");b+=getStr("rmp","scriptcallbacks");break}b+=getStr(null,"id");b+=getStr(null,"name");b+=getStr(null,"src");b+=getStr(null,"align");b+=getStr(null,"bgcolor");b+=getInt(null,
"vspace");b+=getInt(null,"hspace");b+=getStr(null,"width");b+=getStr(null,"height");return b=b.length>0?b.substring(0,b.length-1):b}function setBool(a,b,c){if(typeof a[c]!="undefined")document.forms[0].elements[b+"_"+c].checked=a[c]!="false"}function setStr(a,b,c){var e=document.forms[0],f=e.elements[(b!=null?b+"_":"")+c];if(typeof a[c]!="undefined")if(f.type=="text")f.value=a[c];else selectByValue(e,(b!=null?b+"_":"")+c,a[c])}
function getBool(a,b,c,e,f){a=document.forms[0].elements[a+"_"+b].checked;e=typeof e=="undefined"?"true":"'"+jsEncode(e)+"'";f=typeof f=="undefined"?"false":"'"+jsEncode(f)+"'";return a==c?"":b+(a?":"+e+",":":'"+f+"',")}function getStr(a,b,c){a=document.forms[0].elements[(a!=null?a+"_":"")+b];a=a.type=="text"?a.value:a.options[a.selectedIndex].value;if(b=="src")a=tinyMCEPopup.editor.convertURL(a,"src",null);return b==c||a==""?"":b+":'"+jsEncode(a)+"',"}
function getInt(a,b,c){a=document.forms[0].elements[(a!=null?a+"_":"")+b];a=a.type=="text"?a.value:a.options[a.selectedIndex].value;return b==c||a==""?"":b+":"+a.replace(/[^0-9]+/g,"")+","}function jsEncode(a){a=a.replace(new RegExp("\\\\","g"),"\\\\");a=a.replace(new RegExp('"',"g"),'\\"');return a=a.replace(new RegExp("'","g"),"\\'")}
function generatePreview(a){var b=document.forms[0],c=document.getElementById("prev"),e="",f,d,g,h,i,j;c.innerHTML="<!-- x ---\>";d=parseInt(b.width.value);j=parseInt(b.height.value);if(b.width.value!=""&&b.height.value!="")if(b.constrain.checked)if(a=="width"&&oldWidth!=0){a=d/oldWidth;j=Math.round(a*j);b.height.value=j}else if(a=="height"&&oldHeight!=0){a=j/oldHeight;d=Math.round(a*d);b.width.value=d}if(b.width.value!="")oldWidth=d;if(b.height.value!="")oldHeight=j;d=serializeParameters();switch(b.media_type.options[b.media_type.selectedIndex].value){case "flash":f=
"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";i="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0";h="application/x-shockwave-flash";break;case "shockwave":f="clsid:166B1BCA-3F9C-11CF-8075-444553540000";i="http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0";h="application/x-director";break;case "qt":f="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B";i="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0";h="video/quicktime";break;
case "wmp":f=ed.getParam("media_wmp6_compatible")?"clsid:05589FA1-C356-11CE-BF01-00AA0055595A":"clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6";i="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701";h="application/x-mplayer2";break;case "rmp":f="clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA";i="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701";h="audio/x-pn-realaudio-plugin";break}if(d=="")c.innerHTML="";else{d=tinyMCEPopup.editor.plugins.media._parse(d);
if(d.src){d.src=tinyMCEPopup.editor.documentBaseURI.toAbsolute(d.src);d.width=!d.width?100:d.width;d.height=!d.height?100:d.height;d.id=!d.id?"obj":d.id;d.name=!d.name?"eobj":d.name;d.align=!d.align?"":d.align;if(!tinymce.isIE||document.location.protocol!="https:"){e+='<object classid="'+f+'" codebase="'+i+'" width="'+d.width+'" height="'+d.height+'" id="'+d.id+'" name="'+d.name+'" align="'+d.align+'">';for(g in d){e+='<param name="'+g+'" value="'+d[g]+'">';if(g=="src"&&d[g].indexOf("://")!=-1)e+=
'<param name="url" value="'+d[g]+'" />'}}e+='<embed type="'+h+'" ';for(g in d)e+=g+'="'+d[g]+'" ';e+="></embed>";if(!tinymce.isIE||document.location.protocol!="https:")e+="</object>";c.innerHTML="<!-- x ---\>"+e}else c.innerHTML=""}}tinyMCEPopup.onInit.add(init);
