function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function getMyFile(){window.parent.sendMsg($checknum,"getFile","")}function save_ed(a){window.parent.sendMsg($checknum,"Save","<arg1>ed</arg1>"),alert(a)}var Slimey;Slimey=function(a){a.rootDir&&(Slimey.rootDir=a.rootDir),a.imagesDir&&(Slimey.imagesDir=a.imagesDir),a.filename&&(this.filename=a.filename),a.slimContent&&(this.slimContent=a.slimContent),a.saveUrl&&(this.saveUrl=a.saveUrl),this.config=a,Slimey.preloadImages(),this.editor=new SlimeyEditor(this),this.navigation=new SlimeyNavigation(this),this.Navbar=new SlimeyNavbar(this);var b=document.createElement("div");b.style.position="absolute",b.style.marginTop="0px",b.style.marginLeft="0px",b.style.marginRight="0px",b.style.height="58px",b.style.width="100%",b.appendChild(this.Navbar.container),this.edtoolbar=new SlimeyToolbar(this,[new SlimeySaveTool(this),"-",new SlimeyInsertTextTool(this),new SlimeyInsertOrderedListTool(this),new SlimeyInsertUnorderedListTool(this),new SlimeyDeleteTool(this),"-",new SlimeyUndoTool(this),new SlimeyRedoTool(this),"-",new SlimeyFontColorTool(this),new SlimeyFontFamilyTool(this),new SlimeyFontSizeTool(this),"-",new SlimeyStyleToggleTool(this,"bold",lang("bold text"),"fontWeight","bold","normal"),new SlimeyStyleToggleTool(this,"underline",lang("underline text"),"textDecoration","underline","none"),new SlimeyStyleToggleTool(this,"italic",lang("italic text"),"fontStyle","italic","normal"),"-",new SlimeySendToBackTool(this),new SlimeyBringToFrontTool(this),"-",new SlimeyViewSourceTool(this),new SlimeyPreviewTool(this)]),this.navtoolbar=new SlimeyToolbar(this,[new SlimeyAddSlideTool(this),new SlimeyDeleteSlideTool(this),"-",new SlimeyMoveSlideDownTool(this),new SlimeyMoveSlideUpTool(this)]),typeof a.container=="string"?this.container=document.getElementById(a.container):typeof a.container=="object"?this.container=a.container:this.container=document.body,this.container.appendChild(b),this.container.appendChild(this.navtoolbar.container),this.container.appendChild(this.edtoolbar.container),this.container.appendChild(this.navigation.container),this.container.appendChild(this.editor.container);var c=this.aspect||4/3,d=this.container.offsetHeight,e=this.container.offsetWidth;this.navtoolbar.container.style.position="absolute",this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px",this.navtoolbar.container.style.top="60px",this.navigation.container.style.position="absolute",this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px",this.navigation.container.style.height=d-this.navtoolbar.container.offsetHeight+"px",this.edtoolbar.container.style.position="absolute",this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.width=e-this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.top="60px",this.editor.container.style.position="absolute",this.editor.container.style.top="95px",this.editor.container.style.left="210px";var f,g;self.innerHeight?(f=self.innerWidth,g=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(f=document.documentElement.clientWidth,g=document.documentElement.clientHeight):document.body&&(f=document.body.clientWidth,g=document.body.clientHeight);var h=f-200,i=g-120;h>i*c?(this.editor.container.style.height=i+"px",this.editor.container.style.width=i*c+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+(e-this.navigation.container.offsetWidth-i*c)/2+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60):(this.editor.container.style.height=h/c+"px",this.editor.container.style.width=h+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+0+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60),addEventHandler(window,"resize",this.layout,this)},Slimey.prototype.layout=function(){var a,b,c,d,e=this.aspect||4/3,f=this.container.offsetHeight,g=this.container.offsetWidth;this.navtoolbar.container.style.position="absolute",this.navtoolbar.container.style.width=this.navigation.container.offsetWidth+"px",this.navtoolbar.container.style.top="60px",this.navigation.container.style.position="absolute",this.navigation.container.style.top=this.navtoolbar.container.offsetHeight+60+"px",this.navigation.container.style.height=f-this.navtoolbar.container.offsetHeight+"px",this.edtoolbar.container.style.position="absolute",this.edtoolbar.container.style.left=this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.width=g-this.navigation.container.offsetWidth+"px",this.edtoolbar.container.style.top="60px",this.editor.container.style.position="absolute",this.editor.container.style.top="95px",this.editor.container.style.left="210px",self.innerHeight?(a=self.innerWidth,b=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body&&(a=document.body.clientWidth,b=document.body.clientHeight),c=a-200,d=b-120,c>d*e?(this.editor.container.style.height=d+"px",this.editor.container.style.width=d*e+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+(g-this.navigation.container.offsetWidth-d*e)/2+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60):(this.editor.container.style.height=c/e+"px",this.editor.container.style.width=c+"px",this.editor.container.style.left=this.navigation.container.offsetWidth+0+"px",this.editor.container.style.top=this.edtoolbar.container.offsetHeight+60),this.editor.resized()},Slimey.prototype.submitFile=function(){sc.value=this.slimContent,window.parent.sendMsg($checknum,"saveFile",sc.value)},Slimey.imagesDir="index.php?theme="+USERTHEME+"&extern=icons/22x22/eyeShow/",Slimey.preloadedImages=[],Slimey.includeScripts=function(){Slimey.rootDir="index.php?extern=apps/eyeShow/getjs.eyecode&type=dynamic&type=dynamic&params[]=$myPid&params[]=$checknum&params[]=",document.write('<script language="javascript" src="'+Slimey.rootDir+'functions"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'stack"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'editor"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'navigation"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'actions"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'tools"></script>'),document.write('<script language="javascript" src="'+Slimey.rootDir+'toolbar"></script>')},Slimey.preloadImage=function(a){var b=Slimey.preloadedImages,c=b.length;b[c]=new Image,b[c].src=Slimey.imagesDir+a},Slimey.preloadToolbarImage=function(a){Slimey.preloadImage(a+".png"),Slimey.preloadImage(a+"h.png"),Slimey.preloadImage(a+"x.png"),Slimey.preloadImage(a+"d.png")},Slimey.preloadImages=function(){if(!Image)return;Slimey.preloadToolbarImage("bold"),Slimey.preloadToolbarImage("bringToFront"),Slimey.preloadToolbarImage("color"),Slimey.preloadToolbarImage("delete"),Slimey.preloadToolbarImage("empty"),Slimey.preloadToolbarImage("insertImage"),Slimey.preloadToolbarImage("insertOList"),Slimey.preloadToolbarImage("insertUList"),Slimey.preloadToolbarImage("insertText"),Slimey.preloadToolbarImage("italic"),Slimey.preloadToolbarImage("preview"),Slimey.preloadToolbarImage("redo"),Slimey.preloadToolbarImage("save"),Slimey.preloadToolbarImage("sendToBack"),Slimey.preloadToolbarImage("underline"),Slimey.preloadToolbarImage("undo"),Slimey.preloadToolbarImage("viewSource"),Slimey.preloadImage("newslide.png"),Slimey.preloadImage("delslide.png"),Slimey.preloadImage("sep.png")},Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;a=Base64._utf8_encode(a);while(j<a.length)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(b&3)<<4|c>>4,g=(c&15)<<2|d>>6,h=d&63,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(j<a.length)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(f&15)<<4|g>>2,d=(g&3)<<6|h,i+=String.fromCharCode(b),g!=64&&(i+=String.fromCharCode(c)),h!=64&&(i+=String.fromCharCode(d));return i=Base64._utf8_decode(i),i},_utf8_encode:function(a){var b,c,d;a=a.replace(/\r\n/g,"\n"),b="";for(c=0;c<a.length;c++)d=a.charCodeAt(c),d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(d&63|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(d&63|128));return b},_utf8_decode:function(a){var b="",c=0,d=c1=c2=0;while(c<a.length)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}};