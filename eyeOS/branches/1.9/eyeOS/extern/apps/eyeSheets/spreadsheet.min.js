function trans(a){return strings[a]?strings[a]:"["+a+"]"}function keypress(a){var a,b,c,d,e,f;return!getObj("value")||active=="code"?!0:(a=a?a:window.event,b=getmykey(a),c=!0,active=="position"?(b==13&&(gotoCell(getObj("field").value),active="content",c=!1),c):active=="dimensions"?(b==13&&(rows=parseInt(getObj("rows").value),cols=parseInt(getObj("cols").value),active="content",display(),c=!1),c):(getObj("styling").disabled?(getObj("focus").focus(),active="content",d=a.shiftKey,e=a.altKey,f=a.ctrlKey,f&&(b==88||b==120)||d&&b==46?(cutcopy("cut","#FFDDDD"),c=!1):f&&(b==67||b==99)||f&&b==45?(cutcopy("copy","#DDDDFF"),c=!1):(f&&(b==86||b==118)||d&&b==45)&&clipboard_mode!=""&&(paste(),c=!1),d&&!isShiftDown?(highlightRange(multiRange,"cell"),multiRange=[currRow,currCol,currRow,currCol],isShiftDown=1):!e&&!f&&!d&&multiRange.length>0&&b!=46&&(highlightRange(multiRange,"cell"),multiRange=[],isShiftDown=0,isMouseDown=0),!e&&!f&&b!=0&&(b==33?(currRow-10<=row0&&currRow>10?(row0-=rows,display(),mouseoverCell(currRow-10,currCol),scrollDown()):(mouseoverCell(currRow<10?0:currRow-10,currCol),scrollUp()),c=!1):b==34?(currRow+10<row0+rows?(mouseoverCell(currRow+10,currCol),scrollDown()):(row0+=rows,display(),mouseoverCell(currRow+10,currCol),scrollUp()),c=!1):b==36?(currCol!=col0?mouseoverCell(currRow,col0):currCol+1<cols?currRow>row0?mouseoverCell(row0,currCol):currRow+1>rows&&(row0-=rows,display(),mouseoverCell(currRow-rows,currCol)):(col0-=cols,display(),mouseoverCell(currRow,currCol-cols)),scrollLeft(),c=!1):b==35?(currCol!=col0+cols-1?mouseoverCell(currRow,col0+cols-1):(col0+=cols,display(),mouseoverCell(currRow,currCol+cols)),scrollRight(),c=!1):b==39||b==9?(goRight(),c=!1):b==40?(goDown(),c=!1):b==38&&currRow>-2?(goUp(),c=!1):b==37&&currCol>-1?(goLeft(),c=!1):!d&&b==46&&isWriteable&&confirm(trans("Really empty cell(s) ?"))?(removeSelectedCell(),c=!1):(b<33||b>40)&&b!=46&&b!=45&&b!=16&&b!=17&&b!=18&&(editCell(currRow,currCol,b),b==13&&(c=!1))),isShiftDown&&(highlightRange(multiRange,"cell"),multiRange[2]=currRow,multiRange[3]=currCol,highlightRange(multiRange,"cell_highlight_over"))):b==13?(saveCell(),c=!1):b==27&&(cancelCell(),c=!1),c))}function goLeft(){currCol<=col0&&currCol>0?(col0-=cols,display(),mouseoverCell(currRow,currCol-1),scrollRight()):(mouseoverCell(currRow,currCol-1),scrollLeft())}function goUp(){currRow<=row0&&currRow>0?(row0-=rows,display(),mouseoverCell(currRow-1,currCol),scrollDown()):(mouseoverCell(currRow-1,currCol),scrollUp())}function goRight(){currCol+1<col0+cols?(mouseoverCell(currRow,currCol+1),scrollRight()):(col0+=cols,display(),mouseoverCell(currRow,currCol+1),scrollLeft())}function goDown(){currRow+1<row0+rows?(mouseoverCell(currRow+1,currCol),scrollDown()):(row0+=rows,display(),mouseoverCell(currRow+1,currCol),scrollUp())}function display(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;marks=[],isMouseDown=0,a=0,b=0,getObj("content")&&(a=getObj("content").scrollLeft,b=getObj("content").scrollTop),c="",isWriteable&&(c+='<div class="blockbar">',c+='<div class="blockbarItem" onclick="load(init_data); resetPath();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filenew.png" /><div class="blockbarText">'+trans("New")+"</div></div>",c+='<div class="blockbarItem" onclick="loadCode();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/fileopen.png" /><div class="blockbarText">'+trans("Open")+"</div></div>",c+='<div class="blockbarItem" onclick="saveCode();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filesave.png" /><div class="blockbarText">'+trans("Save")+"</div></div>",c+='<div class="blockbarItem" onclick="saveAs();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/filesaveas.png" /><div class="blockbarText">'+trans("Save As")+"</div></div>",c+='<span class="blockbarline" /></span>',c+='<div class="blockbarItem" onclick="insertRow();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/newrow.png" /><div class="blockbarText">'+trans("Ins. Row")+"</div></div>",c+='<div class="blockbarItem" onclick="insertColumn();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/newcolumn.png" /><div class="blockbarText">'+trans("Ins. Column")+"</div></div>",c+='<div class="blockbarItem" onclick="deleteRow();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/deleterow.png" /><div class="blockbarText">'+trans("Del. Row")+"</div></div>",c+='<div class="blockbarItem" onclick="deleteColumn();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/deletecolumn.png" /><div class="blockbarText">'+trans("Del. Column")+"</div></div>",c+='<span class="blockbarline" /></span>',c+='<div class="blockbarItem" onclick="print();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/agt_print.png" /><div class="blockbarText">'+trans("Print")+"</div></div>",c+='<div class="blockbarItem_right" onclick="help();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/help.png" /><div class="blockbarText">'+trans("Help")+"</div></div>",c+='<div class="blockbarItem_right" onclick="fullScreen();" ><img class="blockbarImg" src="index.php?theme='+USERTHEME+'&extern=icons/22x22/fullScreen.png" /><div class="blockbarText">'+trans("Full Screen")+"</div></div>",c+="</div>"),c+="<textarea id='focus' onfocus='this.blur();'></textarea><div id='header' class='header'><table cellpadding='0' cellspacing='0' style='width:100%;'><tr><td nowrap>",c+="<input type='text' value='' title='"+trans("Position")+"' id='field' style='width:30px; text-align:center;' onfocus='active=\"position\";' onblur='active=\"content\";' accesskey='g'> &nbsp;",c+="</td><td nowrap style='width:100%;'>",c+="<iframe src='about:blank' id='multiline'></iframe>",c+="<input type='text' value='' title='"+trans("Formula")+"' id='value' style='width:100%;' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ",c+="<input type='hidden' title='"+trans("Style")+"' value='' id='styling' disabled onmouseover='previewValue();' onkeyup='previewValue();'> ",c+="</td><td nowrap>",isWriteable&&(c+="&nbsp; <input type='button' value='"+trans("Save")+"' id='save' onclick='saveCell();' disabled>&nbsp;",c+="<input type='button' value='"+trans("X")+"' id='cancel' onclick='cancelCell();' disabled>"),c+="</td></tr></table></div>",d="",agent=="msie"&&(d="style='height:expression((document.body.clientHeight-40)+\"px\");'"),c+="<div id='content' "+d+"><table id='table' cellspacing='0'>",c+="<tr>";if(showColumnGroups){c+="<th id='-2_-1' ondblclick='editCell(-2,-1);' onclick='mouseoverCell(-2,-1);'>"+htmlEscape(showCell(-2,-1,0),!0)+"</th>";for(e=col0;e<cols+col0;e++){f=showCell(-2,e,0);if(f&&(!marks[-2]||!marks[-2][e])){g=getCellStyle(-2,e,"colspan");if(g){marks[-2]||(marks[-2]=[]);for(h=e+1;h<e+g;h++)marks[-2][h]=[-2,e]}c+="<th id='-2_"+e+"' ondblclick='editCell(-2,"+e+",0);' onclick='mouseoverCell(-2,"+e+");' colspan='"+g+"'><div style='"+htmlEscape(formatStyle(getCells(-2,e,1),"_"),!1)+"'>"+htmlEscape(f,!0)+"</div></th>"}else if(!marks[-2]||!marks[-2][e])c+="<th id='-2_"+e+"' ondblclick='editCell(-2,"+e+",0);' onclick='mouseoverCell(-2,"+e+");'>&nbsp;</th>"}}c+="</tr>",c+="<tr><th id='-1_-1' ondblclick='editCell(-1,-1,0);' onclick='mouseoverCell(-1,-1);'>"+htmlEscape(showCell(-1,-1,0),!0)+"</th>";for(e=col0;e<cols+col0;e++)i=showCell(-1,e,0),c+="<th id='-1_"+e+"' ondblclick='editCell(-1,"+e+",0);' onclick='mouseoverCell(-1,"+e+");'><div style='"+htmlEscape(formatStyle(getCells(-1,e,1),"_"),!1)+"'>"+(i?htmlEscape(i,!0)+" - ":"")+buildColName(e)+"</div></th>";c+="</tr>",j=-1,k=!1;for(l=row0;l<rows+row0;l++){c+="<tr>",m=showCell(l,-1,0),c+="<th id='"+l+"_-1' ondblclick='editCell("+l+",-1,0);' onclick='mouseoverCell("+l+",-1);'><div style='"+htmlEscape(formatStyle(getCells(l,-1,1),"_"),!1)+"'>"+(m?htmlEscape(m,!0)+"<br>":"")+(l+1)+"</div></th>";for(n=col0;n<cols+col0;n++)if(view=="values"){if(!marks[l]||!marks[l][n]){d=getCells(l,n,1),o=showCell(l,n,0),g=getCellStyle(l,n,"colspan");if(g){marks[l]||(marks[l]=[]);for(h=n+1;h<n+g;h++)marks[l][h]=[l,n]}p=getCellStyle(l,n,"rowspan");if(p)for(h=l+1;h<l+p;h++)marks[h]||(marks[h]=[]),marks[h][n]=[l,n];o=formatValue(o,d),d=htmlEscape(formatStyle(d,o),!1),c+="<td "+(p?"rowspan='"+p+"'":"")+" "+(g?"colspan='"+g+"'":"")+" id='"+l+"_"+n+"' onmousedown='mousedown("+l+","+n+");' onmouseup='mouseup();' onmouseover='buildStatus("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' ondblclick='editCell("+l+","+n+",0);'><div style='"+d+"'>"+htmlEscape(o,!0)+"</div></td>"}}else view=="formulas"?c+="<td id='"+l+"_"+n+"' onmouseover='buildStatus("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' ondblclick='editCell("+l+","+n+",0);'>"+htmlEscape(getCells(l,n,0),!0)+"</td>":c+="<td id='"+l+"_"+n+"' onmouseover='buildStatus("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' onclick='mouseoverCell("+l+","+n+");' ondblclick='editCell("+l+","+n+",0);'>"+htmlEscape(getCells(l,n,1),!0)+"</td>";c+="</tr>"}c+="<tr id='spacer'><th class='empty'></th>";for(e=col0;e<cols+col0;e++)c+="<th class='empty'><img src='' style='width:"+col_min_width+"; height:0px;'></th>";c+="</tr>",c+="</table></div>",c+="<div class='footer' id='footer' onmouseover='getObj(\"status\").innerHTML=\"\";'>&nbsp;",allowPaging&&(col0-cols<0?c+="<img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/back.png'> ":c+="<a href='#' onclick='col0 -= cols; currCol -= cols; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/back.png'></a> ",c+="<a href='#' onclick='col0 += cols; currCol += cols; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/forward.png'></a> ",row0-rows<0?c+=" <img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/restore.png'> ":c+="<a href='#' onclick='row0 -= rows; currRow -= rows; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/restore.png'></a> ",c+="<a href='#' onclick='row0 += rows; currRow += rows; display(); return false;'><img border='0' src='index.php?theme="+USERTHEME+"&extern=icons/16x16/download.png'></a> "),c+="</div>",c+="<div class='statusText'> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "+trans("Sheet Size")+": <input type='text' value='"+cols+"' style='width:28px; text-align:center;' id='cols' onfocus='active=\"dimensions\";' onblur='active=\"content\";'> x <input type='text' value='"+rows+"' style='width:28px; text-align:center;' id='rows' onfocus='active=\"dimensions\";' onblur='active=\"content\";'></div>",c+="<div id='status' class='status'></div>",getObj("data").innerHTML=c,getObj("content").scrollLeft=a,getObj("content").scrollTop=b,mouseoverCell(currRow,currCol),clipboard_mode!=""&&(q="#DDDDFF",clipboard_mode=="cut"&&(q="#FFDDDD"),clipboard_range.length>0?highlightRange(clipboard_range,"",q):(r=resolveCell(clipboard_row,clipboard_col),r&&(r.style.backgroundColor=q))),getObj("focus").focus()}function showHeaderFooter(a){if(isWriteable)return;a?(getObj("content").style.top="23px",getObj("content").style.bottom="18px",getObj("header").style.display="",getObj("footer").style.display="",getObj("status").style.display=""):(getObj("content").style.top="0px",getObj("content").style.bottom="0px",getObj("header").style.display="none",getObj("footer").style.display="none",getObj("status").style.display="none")}function previewValue(){var a=getObj("value").value;!getObj("value").disabled&&(a.length>25||a.indexOf("\\n")!=-1||a.indexOf("html:")==0)&&(getObj("multiline").style.display="inline",getObj("multiline").contentWindow.update&&getObj("multiline").contentWindow.update()),previewField()}function previewField(){var a,b,c=resolveCell(currRow,currCol);value=previewCell(getObj("value").value,0),value=formatValue(value,getObj("styling").value),a=htmlEscape(formatStyle(getObj("styling").value,value),!1),currRow==-1?(value!=""&&(value+=" - "),value+=buildColName(currCol)):currCol==-1&&(value!=""&&(value+="\\n"),value+=currRow+1),value=htmlEscape(value,!0),b="<div "+(a?"style='"+a+"'":"")+">"+value+"</div>",c.innerHTML=b,b.indexOf("<img")!=-1&&(c.style.height=c.offsetHeight+"px"),(currRow==-1||currCol==-1)&&highlightCellHeader(currRow,currCol)}function previewMultiline(a){getObj("value").value=a.replace(/\n/g,"\\n").replace(/\r/g,""),previewField()}function log(a){var b;getObj("tconsole")||(b=document.createElement("textarea"),b.id="tconsole",document.body.appendChild(b)),getObj("tconsole").value+=getObj("tconsole").value.split("\n").length+": "+a+"\n"}function manual(){window.open("manual.html","manual","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600")}function isWritable(a){return a.indexOf("readonly:true")==-1&&isWriteable?!0:!1}function getCells(a,b,c){return cells[a]&&cells[a][b]&&cells[a][b].length==4?cells[a][b][c]:""}function getCellsR(a,b,c){var d=resolveCellArray(a,b);return getCells(d[0],d[1],c)}function getCells2(a,b,c,d){var e=colstrToColnum(a),f=showCell(b-1,e,d+1),g=parseFloat(f);return g==f?g:f}function getCells3(a,b,c,d,e,f){var g,h,i,j,k=[],l=colstrToColnum(a),m=colstrToColnum(c);if(l>m||b>d)return Array("error");for(g=b;g<=d;g++)for(h=l;h<=m;h++)i=showCell(g-1,h,f+1),j=parseFloat(i),j==i?k[k.length]=j:k[k.length]=i;return k}function getCellStyle(a,b,c){var d=getCells(a,b,1),e=RegExp(c+":(.*?);","i");return(p=e.exec(d))?d=parseInt(p[1]):d=0,d}function setCells(a,b,c,d){return cells[a]||(cells[a]=[]),cells[a][b]||(cells[a][b]=["","","",""]),cells[a][b][c]!=d?(cells[a][b][c]=d,!0):!1}function setCellsR(a,b,c,d){var e=resolveCellArray(a,b);return setCells(e[0],e[1],c,d)}function loadScriptFile(a){var b=document.createElement("script");b.type="text/javascript",b.src=a,document.getElementsByTagName("head").item(0).appendChild(b)}function loadStyleFile(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.getElementsByTagName("head").item(0).appendChild(b)}function load(code){var i;if(code.indexOf("dbCells")==-1){code.indexOf(tab)==-1?cells=loadCSV(code):cells=loadTSV(code);if(!cells)return}else{try{eval(code)}catch(err){return}window.registerFuncs=registerFuncs;if(registerFuncs)for(i=0;i<registerFuncs.length;i++)window[registerFuncs[i]]=eval(registerFuncs[i]);cells=[];try{for(i=0;i<dbCells.length;i++){if(!dbCells[i])continue;cells[dbCells[i][1]]||(cells[dbCells[i][1]]=[]),cells[dbCells[i][1]][dbCells[i][0]]=[dbCells[i][2],dbCells[i][3],dbCells[i][4],""]}}catch(err){return}}typeof cells[-2]!="undefined"?showColumnGroups=!0:showColumnGroups=!1,active="content",getObj("source").style.display="none",getObj("data").style.display="inline",display()}function cancelLoad(){active="content",getObj("source").style.display="none",getObj("data").style.display="inline",display()}function loadCSV(a){var b;a=a.replace(/([^,])""([^,])/g,"$1#quot#$2").replace(/\r/g,""),a=a.replace(/(".*?")/g,function(a){return a.replace(/,/g,"#comm#")}),a=a.replace(/([^,])""([^,])/g,"$1#quot#$2"),a=a.split("\n");for(b=0;b<a.length;b++)a[b]='["'+a[b].replace(/^"|"\s*$/g,"").replace(/"?,"?/g,'","')+'"]',b!=a.length-1&&(a[b]+=",");return a="dbCells = [\n"+a.join("\n")+"\n];\n",a=a.replace(/#comm#/g,",").replace(/#quot#/g,'\\"'),loadDbCells(a)}function loadTSV(a){var b;a=a.replace(/^\/\/.*?\n/g,"").replace(/\r/g,"").split("\n");for(b=0;b<a.length;b++)a[b]='["'+a[b].replace(/"/g,'\\"').replace(/	/g,'","')+'"]',b!=a.length-1&&(a[b]+=",");return a="dbCells = [\n"+a.join("\n")+"\n];\n",a=a.replace(/\[""\],\n/g,""),loadDbCells(a)}function loadDbCells(code){var i,i2;try{eval(code)}catch(err){return!1}cells=[];try{for(i=0;i<dbCells.length;i++)for(i2=0;i2<dbCells[i].length;i2++)dbCells[i][i2]&&(cells[i-1]||(cells[i-1]=[]),cells[i-1][i2]=[dbCells[i][i2]+"","","",""])}catch(err){return!1}return cells}function save(a){var b;active="code",getObj("status").innerHTML="",b="",a=="csv"?b=cellsToCSV():a=="tsv"?b=cellsToTSV():b=cellsToJS(),getObj("data").style.display="none",getObj("source").style.display="inline",getObj("code").value=b}function cellsToJS(){var i,i2,out="";out+="dbCells = [\n";for(i=-2;i<cells.length;i++)if(cells[i]){for(i2=-1;i2<cells[i].length;i2++){if(!cells[i][i2])continue;if(cells[i][i2][0]==""&&cells[i][i2][1]=="")continue;out+="  ["+i2+","+i+',"'+strescape(cells[i][i2][0])+'","'+strescape(cells[i][i2][1])+'"',cells[i][i2][2]&&isNaN(cells[i][i2][2])?out+=',"'+strescape(cells[i][i2][2])+'"':cells[i][i2][2]&&(out+=","+cells[i][i2][2]),out+="], // "+buildColName(i2)+(i+1)+"\n"}out+="\n"}cells.length>0?out=out.substring(0,out.length-2)+"\n];\n":out+="];\n";if(registerFuncs){out+="\nvar registerFuncs = [";for(i=0;i<registerFuncs.length;i++)out+='"'+registerFuncs[i]+'",';out=out.substring(0,out.length-1)+"];\n\n";for(i=0;i<registerFuncs.length;i++)out+=eval(registerFuncs[i])+"\n\n";out=out.substring(0,out.length-2)}return out}function cellsToCSV(){var a,b,c,d="";for(a=-1;a<cells.length;a++)if(cells[a]){for(b=0;b<cells[a].length;b++)cells[a][b]&&cells[a][b][0]?a==-1&&cells[a][b][2]?d+='"'+cells[a][b][2].replace(/\\/g,"\\\\").replace(/"/g,'""')+'",':(c=showCell(a,b),isNaN(c)?d+='"'+c.replace(/\\/g,"\\\\").replace(/"/g,'""')+'",':d+=c+","):d+=",";d=d.substring(0,d.length-1)+"\n"}else d+=",\n";return d}function cellsToTSV(){var a,b,c="// "+trans("Copy / paste this code to other spreadsheet applications (e.g. Excel)")+":\n\n";for(a=-1;a<cells.length;a++)if(cells[a]){for(b=0;b<cells[a].length;b++)cells[a][b]&&cells[a][b][0]?a==-1&&cells[a][b][2]?c+=cells[a][b][2]+tab:c+=showCell(a,b)+tab:c+=tab;c=c.substring(0,c.length-1)+"\n"}else a==-1&&(c+=tab+"\n");return c}function addHiddenParam(a,b,c){param=document.createElement("input"),a.appendChild(param),param.setAttribute("type","hidden"),param.setAttribute("name",b),param.setAttribute("value",c)}function saveSGS(){var a,b,c,d,e,f,g,h="index.php?view="+escape(sgs_view)+"&folder="+escape(sgs_folder);sgs_view=="edit"?h+="&form_submit_edit=checked":h+="&form_submit_create=checked",a="",b=0,c=document.createElement("form");for(d=0;d<cells.length;d++)if(cells[d]){e=d,cells[-1][0][2]=="id"&&cells[d][0]&&cells[d][0][3]!=""&&(e=cells[d][0][3]),addHiddenParam(c,"form_fields[]",e),addHiddenParam(c,"form_"+e+"_folder",escape(sgs_folder)),b++;for(f=0;f<cells[-1].length;f++)g="",cells[-1]&&cells[-1][f]&&(cells[-1][f][2]?g=cells[-1][f][2]:g=cells[-1][f][0]),g&&addHiddenParam(c,"form_"+e+"_"+g,showCell(d,f))}c.action=h+"&limit="+b,c.method="POST",c.style.display="none",document.body.appendChild(c),c.submit()}function loadSheetFromUrl(a){var b=document.createElement("script");b.type="text/javascript",b.onload=b.onreadystatechange=function(a){agent==="msie"?(b.readyState==="loaded"||b.readyState==="complete")&&load("// dbCells"):agent==="opera"?typeof a!="string"&&a.type==="load"&&load("// dbCells"):typeof a!="string"&&(a.type==="load"||a.type==="readystatechange"&&(a.target.readyState==="complete"||a.target.readyState==="loaded"))&&load("// dbCells")},b.src=a,document.getElementsByTagName("head").item(0).appendChild(b)}function resetPath(){window.parent.sendMsg($checknum,"resetPath","")}function saveCode(){window.parent.sendMsg($checknum,"saveFile","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveCodeClose(){window.parent.sendMsg($checknum,"yDelete","<arg1>"+Base64.encode(cellsToJS())+"</arg1>")}function saveAs(){window.parent.sendMsg($checknum,"saveAs","")}function loadCode(){window.parent.sendMsg($checknum,"openFile","")}function help(){window.parent.sendMsg($checknum,"help","")}function fullScreen(){window.parent.sendMsg($checknum,"fullScreen","")}function print(){var a,b=document.getElementById("content").innerHTML;b=b.replace(/(<\/tr>|<\/table>)/g,"$1\n"),a=window.open("","print","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no,width=800,height=600"),a.document.write("<html><head><link media='all' href='"+printstyle+"' rel='stylesheet' type='text/css'/></head>\n"),a.document.write("<body>\n"+b+"\n</body></html>"),a.document.close(),a.window.print()}function insertRow(){var a,b;for(a=cells.length-1;a>=currRow;a--)if(cells[a])for(b=0;b<cells[a].length;b++){if(!cells[a][b])continue;cells[a+1]||(cells[a+1]=[]),cells[a+1][b]=cells[a][b],cells[a][b]=""}display()}function deleteRow(){var a,b,c,d,e=currRow,f=currRow;multiRange.length>0&&(a=getMultiRange(multiRange),e=a[0],f=a[2]);for(b=e;b<=f;b++)for(c=e;c<cells.length;c++)if(cells[c])for(d=0;d<cells[c].length;d++){cells[c+1]||(cells[c+1]=[]),!cells[c+1][d]&&cells[c][d]&&(cells[c][d]="");if(!cells[c+1][d]&&!cells[c][d])continue;cells[c][d]=cells[c+1][d],cells[c+1][d]=""}display()}function insertColumn(){var a,b;for(a=0;a<cells.length;a++)if(cells[a])for(b=cells[a].length-1;b>=currCol;b--){if(!cells[a][b])continue;cells[a][b+1]=cells[a][b],cells[a][b]=""}display()}function deleteColumn(){var a,b,c,d,e=currCol,f=currCol;multiRange.length>0&&(a=getMultiRange(multiRange),e=a[1],f=a[3]);for(b=e;b<=f;b++)for(c=0;c<cells.length;c++)if(cells[c])for(d=e;d<cells[c].length;d++){!cells[c][d+1]&&cells[c][d]&&(cells[c][d]="");if(!cells[c][d+1]&&!cells[c][d])continue;cells[c][d]=cells[c][d+1],cells[c][d+1]=""}display()}function scroll(){scrollDown(),scrollUp(),scrollRight(),scrollLeft()}function scrollUp(){var a,b=resolveCell(currRow,currCol),c=findPosY(b);c<getObj("content").scrollTop+100&&getObj("content").scrollTop>c-100&&(getObj("content").scrollTop=c-100),a=findPosX(b),a<getObj("content").scrollLeft+200&&getObj("content").scrollLeft>a-150&&(getObj("content").scrollLeft=a-150)}function scrollDown(){var a,b,c,d,e=resolveCell(currRow,currCol),f=findPosY(e),g=return_height();e&&f+e.offsetHeight+100>g&&(a=f+e.offsetHeight+100-g,a>getObj("content").scrollTop&&(getObj("content").scrollTop=a)),b=findPosX(e),c=return_width(),e&&b+e.offsetWidth+100>c&&(d=b+e.offsetWidth+100-c,d>getObj("content").scrollLeft&&(getObj("content").scrollLeft=d))}function scrollLeft(){scrollUp()}function scrollRight(){scrollDown()}function removeSelectedCell(){var a,b,c,d;if(multiRange.length>0){a=getMultiRange(multiRange);for(b=a[0];b<=a[2];b++)for(c=a[1];c<=a[3];c++)isWritable(getCellsR(b,c,1))&&(setCellsR(b,c,0,""),setCellsR(b,c,1,""),auto_recalc||(d=resolveCell(b,c),d.innerHTML="<div>&nbsp;</div>"))}else removeCell(currRow,currCol),!auto_recalc&&isWritable(getCellsR(currRow,currCol,1))&&(d=resolveCell(currRow,currCol),d.innerHTML="<div>&nbsp;</div>");auto_recalc&&display()}function cutcopy(a,b){var c;if(!isWriteable)return;clipboard_range.length>0?highlightRange(clipboard_range,"",""):clipboard_mode&&(c=resolveCell(clipboard_row,clipboard_col),c&&(c.style.backgroundColor="")),clipboard_mode=a,clipboard_row=currRow,clipboard_col=currCol,clipboard_range=getMultiRange(multiRange),multiRange.length>0?highlightRange(multiRange,"",b):(c=resolveCell(currRow,currCol),c&&(c.style.backgroundColor=b))}function paste(){var a,b,c,d,e,f,g;if(clipboard_range.length>0){a=getMultiRange(clipboard_range),b=[currRow,currCol,currRow+a[2]-a[0],currCol+a[3]-a[1]],multiRange.length>0&&(multiRange[0]!=multiRange[2]||multiRange[1]!=multiRange[3])&&(b=getMultiRange(multiRange)),c=0,d=0;if(b[0]>=a[0]&&b[1]>=a[1]||b[0]>a[0]&&b[1]<a[1])for(e=b[2];e>=b[0];e--){c=(e-b[0])%(a[2]-a[0]+1);for(f=b[3];f>=b[1];f--)d=(f-b[1])%(a[3]-a[1]+1),copyCell(a[0]+c,a[1]+d,e,f),g=resolveCell(a[0]+c,a[1]+d),g&&(g.style.backgroundColor="")}else for(e=b[0];e<=b[2];e++){c=(e-b[0])%(a[2]-a[0]+1);for(f=b[1];f<=b[3];f++)d=(f-b[1])%(a[3]-a[1]+1),copyCell(a[0]+c,a[1]+d,e,f),g=resolveCell(a[0]+c,a[1]+d),g&&(g.style.backgroundColor="")}if(clipboard_mode=="cut"){for(e=a[0];e<=a[2];e++)for(f=a[1];f<=a[3];f++)(e<b[0]||e>b[2]||f<b[1]||f>b[3])&&removeCell(e,f);clipboard_mode=""}}else{if(multiRange.length<=0||multiRange[0]==multiRange[2]&&multiRange[1]==multiRange[3])copyCell(clipboard_row,clipboard_col,currRow,currCol),clipboard_mode=="cut"&&(clipboard_row!=currRow||clipboard_col!=currCol)&&removeCell(clipboard_row,clipboard_col);else{b=getMultiRange(multiRange);for(e=b[2];e>=b[0];e--)for(f=b[3];f>=b[1];f--)copyCell(clipboard_row,clipboard_col,e,f);clipboard_mode=="cut"&&(clipboard_row<b[0]||clipboard_row>b[2]||clipboard_col<b[1]||clipboard_col>b[3])&&removeCell(clipboard_row,clipboard_col)}clipboard_mode=="cut"&&(clipboard_mode="")}display()}function sortNum(a){return isNaN(a)?a.charAt(0).toLowerCase().charCodeAt(0):parseFloat(a)}function sortCells(a,b){return a[currCol]&&b[currCol]?a[currCol][3]==""?1:b[currCol][3]==""?-1:(a=sortNum(a[currCol][3]),b=sortNum(b[currCol][3]),a-b):a[currCol]?1:-1}function sort(a){var b,c,d,e;if(multiRange.length>0){b=getMultiRange(multiRange),c=[];for(d=b[0];d<=b[2];d++)for(e=b[1];e<=b[3];e++)c[d]||(c[d]=[]),cells[d]&&cells[d][e]&&(c[d][e]=cells[d][e]);a?c=c.sort(sortCells):c=c.sort(sortCells).reverse();for(d=b[0];d<=b[2];d++)for(e=b[1];e<=b[3];e++)cells[d]||(cells[d]=[]),cells[d][e]=c[d][e]}else a?cells=cells.sort(sortCells):cells=cells.sort(sortCells).reverse();display()}function buildStatus(a,b){var c,d,e,f="",g=getCellsR(-1,b,0),h=getCellsR(-2,b,0),i=getCellsR(a,b,2);i&&a!=-1&&(f+=i+" - "),g?(c=getCellsR(-1,b,2),h&&(f+=h+": "),f+=(c?c:g)+" - "):h&&(f+=h+" - "),d=getCellsR(a,-1,0),d&&(e=getCellsR(a,-1,2),f+=(e?e:d)+" - "),getObj("status").innerHTML=f+buildColName(b)+(a+1),isMouseDown&&(markCell(a,b),highlightRange(multiRange,"cell"),multiRange[2]=a,multiRange[3]=b,highlightRange(multiRange,"cell_highlight_over"))}function highlightRange(a,b,c){var d,e,f;if(a.length==0)return!1;d=getMultiRange(a);for(e=d[0];e<=d[2];e++)for(f=d[1];f<=d[3];f++)obj=resolveCell(e,f),obj&&b?obj.className=b:!b&&obj&&(obj.style.backgroundColor=c)}function getMultiRange(a){var b,c,d,e;return a.length==0?[]:(b=a[0]>a[2]?a[2]:a[0],c=a[0]>a[2]?a[0]:a[2],d=a[1]>a[3]?a[3]:a[1],e=a[1]>a[3]?a[1]:a[3],[b,d,c,e])}function mousedown(a,b){getObj("styling").disabled&&(document.onmousedown=function(){return!1},document.onselectstart=function(){return!1},isMouseDown=1,highlightRange(multiRange,"cell"),multiRange=[a,b,a,b],highlightRange(multiRange,"cell_highlight_over"))}function mouseup(){getObj("styling").disabled&&(document.onmousedown="",document.onselectstart="",isMouseDown=0)}function markCell(a,b){highlightCell(a,b,"cell_highlight_over"),highlightCellHeader(a,b),currRow=a,currCol=b,getObj("value").value=getCellsR(a,b,0),getObj("styling").value=getCellsR(a,b,1),getObj("field").value=buildColName(b)+(a+1)}function mouseoverCell(a,b){var c,d,e;getObj("styling").disabled?a==currRow&&b==currCol&&getObj("field").value?editCell(a,b,0):(markCell(a,b),buildStatus(a,b)):getObj("value").disabled||(c=getObj("value"),d=buildColName(b)+(a+1),c.selectionStart?(e=c.selectionStart,c.value=c.value.substring(0,c.selectionStart)+d+c.value.substring(c.selectionStart),c.selectionStart=e+d.length,c.selectionEnd=e+d.length,c.focus()):document.selection&&(c.value+=d),previewValue())}function highlightCell(a,b,c){var d=resolveCell(currRow,currCol);d&&(d.className="cell"),d=resolveCell(a,b),d&&(d.className=c)}function highlightCellHeader(a,b){var c,d=resolveCell(-1,currCol);d&&(d.className="border"),d=resolveCell(currRow,-1),d&&(d.className="border"),c=-1,a<-1&&(c=-2),d=resolveCell(c,b),d&&(d.className="border_highlight"),a>=-1&&(d=resolveCell(a,-1),d&&(d.className="border_highlight"))}function showCell(row,col,calls){var cmd,token,openToken,sequence,i;typeof calls=="undefined"&&(calls=0),value=getCells(row,col,0);if(calls>25)value="undefined";else if(value!=""&&value.charAt(0)=="="){cmd="",token="",openToken="",sequence="";for(i=0;i<value.length;i++)token=value.charAt(i),sequence+=token,(token=="'"||token=='"')&&openToken==""||i==value.length-1?(openToken==""&&(sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")"),sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")),openToken=token,cmd+=sequence,sequence=""):token==openToken&&value.charAt(i-1)!="\\"&&(openToken="",cmd+=sequence,sequence="");try{eval("value"+cmd)}catch(err){}}return cells[row]&&cells[row][col]&&(cells[row][col][3]=value),value}function previewCell(value,calls){var cmd,token,openToken,sequence,i,nvalue;if(value==""||value.charAt(0)!="=")return value;if(calls>25)return"undefined";cmd="",token="",openToken="",sequence="";for(i=0;i<value.length;i++)token=value.charAt(i),sequence+=token,(token=="'"||token=='"')&&openToken==""||i==value.length-1?(openToken==""&&(sequence=sequence.replace(/([A-Z]+)([0-9]+):([A-Z]+)([0-9]+)/g,"getCells3('$1',$2,'$3',$4,0,"+(calls+1)+")"),sequence=sequence.replace(/([A-Z]+)([0-9]+)/g,"getCells2('$1',$2,0,"+(calls+1)+")")),openToken=token,cmd+=sequence,sequence=""):token==openToken&&value.charAt(i-1)!="\\"&&(openToken="",cmd+=sequence,sequence="");nvalue="";try{eval("nvalue"+cmd)}catch(err){}return nvalue!=null&&(nvalue+"").length>0?nvalue:value}function gotoCell(a){var b,c,d=RegExp("([@A-Z]+)([0-9]+)","g");if(p=d.exec(a)){b=colstrToColnum(p[1]),c=p[2]-1;if(b>=-1&&c>=0){getObj("focus").focus();if(b!=currCol||c!=currRow){if(b>=cols||c<=rows)col0=b-b%cols,row0=c-c%rows,display();mouseoverCell(c,b),scroll()}return}}}function editCell(a,b,c){active="content";if(!isWriteable)return;getObj("styling").disabled||cancelCell(),highlightCell(a,b,"cell_highlight"),highlightCellHeader(a,b),currRow=a,currCol=b,isWritable(getCellsR(a,b,1))&&(getObj("value").disabled=!1),getObj("styling").disabled=!1,getObj("save").disabled=!1,getObj("cancel").disabled=!1,getObj("cols")&&(getObj("cols").disabled=!0),getObj("rows")&&(getObj("rows").disabled=!0),getObj("field").disabled=!0,getObj("styling").value=getCellsR(a,b,1),c>32&&agent=="firefox"&&!getObj("value").disabled?getObj("value").value=String.fromCharCode(c):getObj("value").value=getCellsR(a,b,0),getObj("value").disabled?getObj("styling").focus():getObj("value").focus()}function copyCell(a,b,c,d){if(!isWritable(getCellsR(c,d,1)))return;if(a!=c||b!=d)setCells(c,d,0,getCellsR(a,b,0)),setCells(c,d,1,getCellsR(a,b,1))}function saveCell(){var a=setCellsR(currRow,currCol,0,getObj("value").value),b=setCellsR(currRow,currCol,1,getObj("styling").value);a||b?auto_recalc?display():(disableEdit(),previewValue()):cancelCell()}function disableEdit(){getObj("value").blur(),highlightCell(currRow,currCol,"cell_highlight_over"),getObj("value").disabled=!0,getObj("styling").disabled=!0,getObj("save").disabled=!0,getObj("cancel").disabled=!0,getObj("cols")&&(getObj("cols").disabled=!1),getObj("rows")&&(getObj("rows").disabled=!1),getObj("field").disabled=!1,getObj("multiline").style.display="none",getObj("content").style.overflow="auto"}function cancelCell(){disableEdit(),getObj("value").value=getCellsR(currRow,currCol,0),getObj("styling").value=getCellsR(currRow,currCol,1),previewValue()}function removeCell(a,b){if(!isWritable(getCellsR(a,b,1)))return;setCellsR(a,b,0,""),setCellsR(a,b,1,"")}function resolveCell(a,b){var c=getObj(a+"_"+b);return!c&&marks[a]&&marks[a][b]&&(c=getObj(marks[a][b][0]+"_"+marks[a][b][1])),c}function resolveCellArray(a,b){var c,d=getObj(a+"_"+b);return!d&&marks[a]&&marks[a][b]&&(c=marks[a][b],a=c[0],b=c[1]),[a,b]}function getSize(a){var b=0,c=0;return typeof window.innerWidth=="number"?(b=window.innerWidth,c=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(b=window.document.documentElement.clientWidth,c=window.document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(b=document.body.clientWidth,c=document.body.clientHeight):self.screen.height&&self.screen.width&&(b=self.screen.width,c=self.screen.height),a?b:c}function return_height(){return getSize(0)}function return_width(){return getSize(1)}function getObj(a){return document.getElementById(a)}function getmykey(a){return typeof a=="undefined"?window.event.keyCode:a.keyCode==0&&a.charCode!=0?a.charCode:a.keyCode==0?a.which:a.keyCode}function findPosY(a){var b;if(!a)return 0;b=0;if(a.offsetParent)while(a.offsetParent)b+=a.offsetTop,a=a.offsetParent;else a.y&&(b+=a.y);return b}function findPosX(a){var b;if(!a)return 0;b=0;if(a.offsetParent)while(a.offsetParent)b+=a.offsetLeft,a=a.offsetParent;else a.x&&(b+=a.x);return b}function strescape(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function htmlEscape(a,b){return a==null||a.length==0?b?"&nbsp;":"":(a=new String(a),a.indexOf("html:")==0?a=a.substring(5):(a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),a=a.replace(/'/g,"&#039;").replace(/"/g,"&quot;"),a=a.replace(/([^\s$]+@[^\s$]+)/g,"<a href='$1'>$1</a>"),a=a.replace(/img:((http[s]?:\/\/[^\s$]+\.(gif|jpg|png))|(graphs\.php\?.*?$))/g
,"<img src='$1'>"),a=a.replace(/(^|[^'])(http[s]?:\/\/[^\s$]+)/g,"$1<a target='_blank' href='$2'>$2</a>"),a=a.replace(/\\n/g,"<br>")),a)}function handleErr(){return!0}function buildColName(a){var b="",c="";return a>=702&&(b=(Math.floor(a/676)-1)%26,c+=String.fromCharCode(b+65)),a>=26&&(b=(Math.floor(a/26)-1)%26,c+=String.fromCharCode(b+65)),c+=String.fromCharCode(a%26+65),c}function colstrToColnum(a){var b,c=0;for(b=0;b<a.length;b++)c+=26*(a.length-b-1)+(a.charCodeAt(b)-65);return c}function formatStyle(a,b){return a.indexOf("text-align:")==-1&&b.length>0&&!isNaN((b+"").replace(/[$%,]/g,"").replace("&euro;",""))&&(a+="; text-align:right; white-space:nowrap;",b<0&&a.indexOf("color:")==-1&&(a+="color:#FF0000;")),a.replace(/(format|readonly|colspan|rowspan):.*?;/ig,"")}function formatValue(a,b){return b.indexOf("format:")!=-1?b.indexOf("format:euro")!=-1?a=formatNumber(a)+" &euro;":b.indexOf("format:dollar")!=-1?a="$"+formatNumber(a):b.indexOf("format:percent")!=-1?a=(a*100).toFixed(2)+"%":b.indexOf("format:number")!=-1?a=formatNumber(a):b.indexOf("format:datefulltime")!=-1?a=formatDateFullTime(a):b.indexOf("format:datetime")!=-1?a=formatDateTime(a):b.indexOf("format:datefull")!=-1?a=formatDateFull(a):b.indexOf("format:date")!=-1?a=formatDate(a):b.indexOf("format:time")!=-1&&(a=formatTime(a)):!isNaN(a)&&a!=0&&(a=formatNumber(a).replace(/\.00$/,"")),a}function formatDate(a){var b;return isNaN((new Date(a)).getHours())&&(a=a.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")),b=new Date(a),b.getMonth()+1+"/"+b.getDate()+"/"+b.getFullYear()}function formatDateFull(a){var b,c,d;return isNaN((new Date(a)).getHours())&&(a=a.replace(/(\d{1,2})\.(\d{1,2})\.(\d{2,4})/,"$2/$1/$3")),b=new Date(a),c=[trans("January"),trans("February"),trans("March"),trans("April"),trans("May"),trans("June"),trans("July"),trans("August"),trans("September"),trans("October"),trans("November"),trans("December")],d=[trans("Sunday"),trans("Monday"),trans("Tuesday"),trans("Wednesday"),trans("Thursday"),trans("Friday"),trans("Sunday")],d[b.getDay()]+", "+c[b.getMonth()]+" "+b.getDate()+" "+b.getFullYear()}function formatTime(a){var b,c;return isNaN((new Date(a)).getHours())&&(a=a.replace(/\d+\.\d+\.\d+/,"$2/$1/$3"),a.length<12&&(a="01/01/01 "+a)),b=new Date(a),hour=b.getHours(),c="am",hour>11&&(c="pm"),hour>12&&(hour-=12),hour==0&&(hour=12),hour+":"+b.getMinutes()+":"+b.getSeconds()+" "+c}function formatDateTime(a){return formatDate(a)+" "+formatTime(a)}function formatDateFullTime(a){return formatDateFull(a)+", "+formatTime(a)}function formatNumber(a){var b,c="",d="";a<0&&(d="-",a*=-1),number=Math.floor((a-0).toFixed(2))+"";if(number.length>3){b=number.length%3,c=b==0?"":number.substring(0,b);for(i=0;i<Math.floor(number.length/3);i++)b==0&&i==0?c+=number.substring(b+3*i,b+3*i+3):c+=","+number.substring(b+3*i,b+3*i+3)}else c+=number;return a-number!=0&&(c+=Math.abs(a-number).toFixed(2).replace("0.",".")),d+c}function param(a){return a.join&&(a=a.join(",")),a.replace?escape(a):a}function graph(a,b,c,d,e,f,g,h){var i="img:graphs.php?type="+param(a)+"&title="+param(b);return i+="&data="+param(c)+"&keys="+param(d),typeof e!="undefined"&&(i+="&xtitle="+param(e)),typeof f!="undefined"&&(i+="&ytitle="+param(f)),typeof g!="undefined"&&(i+="&width="+g),typeof h!="undefined"&&(i+="&height="+h),i}function graph2(a,b,c,d,e,f,g,h,i){var j="img:graphs.php?type="+param(a)+"&title="+param(b);return j+="&data="+param(c)+"&data2="+param(d)+"&keys="+param(e),typeof f!="undefined"&&(j+="&xtitle="+param(f)),typeof g!="undefined"&&(j+="&ytitle="+param(g)),typeof h!="undefined"&&(j+="&width="+h),typeof i!="undefined"&&(j+="&height="+i),j}function sum(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b];return c}function min(a){var b,c=0;a.length>0&&(c=a[0]);for(b=0;b<a.length;b++)a[b]<c&&(c=a[b]);return c}function max(a){var b,c=0;a.length>0&&(c=a[0]);for(b=0;b<a.length;b++)a[b]>c&&(c=a[b]);return c}function avg(a){var b,c=0;if(a.length==0)return 0;for(b=0;b<a.length;b++)c+=a[b];return Math.round(1e3*(c/a.length))/1e3}function count(a){var b=0;return a.length}var init_data,auto_recalc,cols,rows,row0,col0,col_min_width,cells,marks,view,currRow,currCol,multiRange,clipboard_row,clipboard_col,clipboard_range,clipboard_mode,active,showColumnGroups,allowPaging,registerFuncs,isMouseDown,isShiftDown,sgs_folder,sgs_view,saveMethod,closeMethod,isWriteable,tab,printstyle,Base64,myPid=$myPid,myChecknum=$checknum,USERTHEME="$usertheme",agent=navigator.userAgent.toLowerCase();agent.indexOf("konqueror")!=-1?agent="konqueror":agent.indexOf("safari")!=-1?agent="safari":agent.indexOf("opera")!=-1?agent="opera":agent.indexOf("firefox")!=-1?agent="firefox":agent.indexOf("msie")!=-1&&(agent="msie"),window.onerror=handleErr,agent=="msie"||agent=="safari"?document.onkeydown=keypress:document.onkeypress=keypress,init_data="",auto_recalc=!0,cols=13,rows=30,row0=0,col0=0,col_min_width="90px",cells=[],marks=[],view="values",currRow=0,currCol=0,multiRange=[],clipboard_row=0,clipboard_col=0,clipboard_range=[],clipboard_mode="",active="",showColumnGroups=!1,allowPaging=!0,registerFuncs="",isMouseDown=0,isShiftDown=0,sgs_folder=0,sgs_view="",saveMethod="save('js')",closeMethod="",isWriteable=!0,tab=String.fromCharCode(9),printstyle="index.php?theme="+USERTHEME+"&extern=css/apps/eyeSheets/print.css",Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",c,d,e,f,g,h,i,j=0;a=Base64._utf8_encode(a);while(j<a.length)c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=a.charCodeAt(j++),f=c>>2,g=(c&3)<<4|d>>4,h=(d&15)<<2|e>>6,i=e&63,isNaN(d)?h=i=64:isNaN(e)&&(i=64),b=b+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h)+this._keyStr.charAt(i);return b},decode:function(a){var b="",c,d,e,f,g,h,i,j=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(j<a.length)f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),i=this._keyStr.indexOf(a.charAt(j++)),c=f<<2|g>>4,d=(g&15)<<4|h>>2,e=(h&3)<<6|i,b+=String.fromCharCode(c),h!=64&&(b+=String.fromCharCode(d)),i!=64&&(b+=String.fromCharCode(e));return b=Base64._utf8_decode(b),b},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");var b="";for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(d&63|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(d&63|128))}return b},_utf8_decode:function(a){var b="",c=0,d=c1=c2=0;while(c<a.length)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}};