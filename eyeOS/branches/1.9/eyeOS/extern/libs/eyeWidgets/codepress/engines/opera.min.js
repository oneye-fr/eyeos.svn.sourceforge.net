CodePress={scrolling:!1,autocomplete:!0,initialize:function(){if(typeof editor=="undefined"&&!arguments[0])return;chars="|32|46|62|",cc="â€‰",editor=document.getElementsByTagName("body")[0],document.designMode="on",document.addEventListener("keyup",this.keyHandler,!0),window.addEventListener("scroll",function(){CodePress.scrolling||CodePress.syntaxHighlight("scroll")},!1),completeChars=this.getCompleteChars()},keyHandler:function(a){keyCode=a.keyCode,charCode=a.charCode,(a.ctrlKey||a.metaKey)&&a.shiftKey&&charCode!=90?CodePress.shortcuts(charCode?charCode:keyCode):completeChars.indexOf("|"+String.fromCharCode(charCode)+"|")!=-1&&CodePress.autocomplete?CodePress.complete(String.fromCharCode(charCode)):chars.indexOf("|"+charCode+"|")!=-1||keyCode==13?CodePress.syntaxHighlight("generic"):keyCode==9||a.tabKey?CodePress.snippets(a):keyCode==46||keyCode==8?CodePress.actions.history[CodePress.actions.next()]=editor.innerHTML:(charCode==122||charCode==121||charCode==90)&&a.ctrlKey&&(charCode==121||a.shiftKey?CodePress.actions.redo():CodePress.actions.undo(),a.preventDefault())},findString:function(){var a=window.getSelection(),b=window.document.createRange(),c=window.document.getElementsByTagName("span")[0];b.selectNode(c),a.removeAllRanges(),a.addRange(b),c.parentNode.removeChild(c)},split:function(a,b){return b=="scroll"?(this.scrolling=!0,a):(this.scrolling=!1,mid=a.indexOf("<SPAN>"),mid-2e3<0?(ini=0,end=4e3):mid+2e3>a.length?(ini=a.length-4e3,end=a.length):(ini=mid-2e3,end=mid+2e3),a=a.substring(ini,end),a)},syntaxHighlight:function(a){var b;a!="init"&&(b=document.createElement("span"),window.getSelection().getRangeAt(0).insertNode(b)),o=editor.innerHTML,o=o.replace(/<(?!span|\/span|br).*?>/gi,""),x=z=this.split(o,a),x=x.replace(/\t/g,"        "),arguments[1]&&arguments[2]&&(x=x.replace(arguments[1],arguments[2]));for(i=0;i<Language.syntax.length;i++)x=x.replace(Language.syntax[i].input,Language.syntax[i].output);editor.innerHTML=this.actions.history[this.actions.next()]=a=="scroll"?x:o.split(z).join(x),a!="init"&&this.findString()},getLastWord:function(){var a=CodePress.getRangeAndCaret();return words=a[0].substring(a[1]-40,a[1]),words=words.replace(/[\s\n\r\);\W]/g,"\n").split("\n"),words[words.length-1].replace(/[\W]/gi,"").toLowerCase()},snippets:function(a){var b,c,d,e=Language.snippets,f=this.getLastWord();for(b=0;b<e.length;b++)e[b].input==f&&(c=e[b].output.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),c.indexOf("$0")<0?c+=cc:c=c.replace(/\$0/,cc),c=c.replace(/\n/g,"<br>"),d=RegExp(f+cc,"gi"),a.preventDefault(),this.syntaxHighlight("snippets",d,c))},readOnly:function(){document.designMode=arguments[0]?"off":"on"},complete:function(a){var b,c,d,e;window.getSelection().getRangeAt(0).deleteContents(),b=Language.complete;for(c=0;c<b.length;c++)b[c].input==a&&(d=RegExp("\\"+a+cc),e=b[c].output.replace(/\$0/g,cc),parent.setTimeout(function(){CodePress.syntaxHighlight("complete",d,e)},0))},getCompleteChars:function(){var a,b="";for(a=0;a<Language.complete.length;a++)b+="|"+Language.complete[a].input;return b+"|"},shortcuts:function(){var a,b=arguments[0];b==13?b="[enter]":b==32?b="[space]":b="["+String.fromCharCode(charCode).toLowerCase()+"]";for(a=0;a<Language.shortcuts.length;a++)Language.shortcuts[a].input==b&&this.insertCode(Language.shortcuts[a].output,!1)},getRangeAndCaret:function(){var a=window.getSelection().getRangeAt(0),b=a.cloneRange(),c=a.endContainer,d=a.endOffset;return b.selectNode(c),[b+"",d]},insertCode:function(a,b){var c=window.getSelection().getRangeAt(0),d=window.document.createTextNode(a),e=window.getSelection(),f=c.cloneRange();e.removeAllRanges(),c.deleteContents(),c.insertNode(d),f.selectNode(d),f.collapse(b),e.removeAllRanges(),e.addRange(f)},getCode:function(){var a=editor.innerHTML;return a=a.replace(/<br>/g,"\n"),a=a.replace(/\u2009/g,""),a=a.replace(/<.*?>/g,""),a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&amp;/gi,"&"),a},setCode:function(){var a=arguments[0];a=a.replace(/\u2009/gi,""),a=a.replace(/&/gi,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),editor.innerHTML=a},actions:{pos:-1,history:[],undo:function(){editor.innerHTML.indexOf(cc)==-1&&(window.getSelection().getRangeAt(0).insertNode(document.createTextNode(cc)),this.history[this.pos]=editor.innerHTML),this.pos--,typeof this.history[this.pos]=="undefined"&&this.pos++,editor.innerHTML=this.history[this.pos],CodePress.findString()},redo:function(){this.pos++,typeof this.history[this.pos]=="undefined"&&this.pos--,editor.innerHTML=this.history[this.pos],CodePress.findString()},next:function(){return this.pos>20&&(this.history[this.pos-21]=undefined),++this.pos}}},Language={},window.addEventListener("load",function(){CodePress.initialize("new")},!0);