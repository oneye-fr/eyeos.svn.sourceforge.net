(function(){tinymce.create("tinymce.plugins.VisualChars",{init:function(a){var b=this;b.editor=a,a.addCommand("mceVisualChars",b._toggleVisualChars,b),a.addButton("visualchars",{title:"visualchars.desc",cmd:"mceVisualChars"}),a.onBeforeGetContent.add(function(a,c){b.state&&c.format!="raw"&&!c.draft&&(b.state=!0,b._toggleVisualChars(!1))})},getInfo:function(){return{longname:"Visual characters",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/visualchars",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_toggleVisualChars:function(a){var b,c,d,e,f,g=this,h=g.editor,i=h.getDoc(),j=h.getBody(),k=h.selection;g.state=!g.state,h.controlManager.setActive("visualchars",g.state),a&&(f=k.getBookmark());if(g.state){b=[],tinymce.walk(j,function(a){a.nodeType==3&&a.nodeValue&&a.nodeValue.indexOf("Â ")!=-1&&b.push(a)},"childNodes");for(c=0;c<b.length;c++){d=b[c].nodeValue,d=d.replace(/(\u00a0)/g,'<span data-mce-bogus="1" class="mceItemHidden mceItemNbsp">$1</span>'),e=h.dom.create("div",null,d);while(node=e.lastChild)h.dom.insertAfter(node,b[c]);h.dom.remove(b[c])}}else{b=h.dom.select("span.mceItemNbsp",j);for(c=b.length-1;c>=0;c--)h.dom.remove(b[c],1)}k.moveToBookmark(f)}}),tinymce.PluginManager.add("visualchars",tinymce.plugins.VisualChars)})();