function preinit(){var a;(a=tinyMCEPopup.getParam("external_link_list_url"))&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(a)+'"></script>')}function changeClass(){var a=document.forms[0];a.classes.value=getSelectValue(a,"classlist")}function init(){var a,b,c,d,e,f,g,h;tinyMCEPopup.resizeToInnerSize(),a=document.forms[0],b=tinyMCEPopup.editor,c=b.selection.getNode(),d="insert",document.getElementById("hrefbrowsercontainer").innerHTML=getBrowserHTML("hrefbrowser","href","file","advlink"),document.getElementById("popupurlbrowsercontainer").innerHTML=getBrowserHTML("popupurlbrowser","popupurl","file","advlink"),document.getElementById("targetlistcontainer").innerHTML=getTargetListHTML("targetlist","target"),e=getLinkListHTML("linklisthref","href"),e==""?document.getElementById("linklisthrefrow").style.display="none":document.getElementById("linklisthrefcontainer").innerHTML=e,e=getAnchorListHTML("anchorlist","href"),e==""?document.getElementById("anchorlistrow").style.display="none":document.getElementById("anchorlistcontainer").innerHTML=e,isVisible("hrefbrowser")&&(document.getElementById("href").style.width="260px"),isVisible("popupurlbrowser")&&(document.getElementById("popupurl").style.width="180px"),c=b.dom.getParent(c,"A"),c==null&&(f=b.dom.create("p",null,b.selection.getContent()),f.childNodes.length===1&&(c=f.firstChild)),c!=null&&c.nodeName=="A"&&(d="update"),a.insert.value=tinyMCEPopup.getLang(d,"Insert",!0),setPopupControlsDisabled(!0),d=="update"?(g=b.dom.getAttrib(c,"href"),h=b.dom.getAttrib(c,"onclick"),setFormValue("href",g),setFormValue("title",b.dom.getAttrib(c,"title")),setFormValue("id",b.dom.getAttrib(c,"id")),setFormValue("style",b.dom.getAttrib(c,"style")),setFormValue("rel",b.dom.getAttrib(c,"rel")),setFormValue("rev",b.dom.getAttrib(c,"rev")),setFormValue("charset",b.dom.getAttrib(c,"charset")),setFormValue("hreflang",b.dom.getAttrib(c,"hreflang")),setFormValue("dir",b.dom.getAttrib(c,"dir")),setFormValue("lang",b.dom.getAttrib(c,"lang")),setFormValue("tabindex",b.dom.getAttrib(c,"tabindex",typeof c.tabindex!="undefined"?c.tabindex:"")),setFormValue("accesskey",b.dom.getAttrib(c,"accesskey",typeof c.accesskey!="undefined"?c.accesskey:"")),setFormValue("type",b.dom.getAttrib(c,"type")),setFormValue("onfocus",b.dom.getAttrib(c,"onfocus")),setFormValue("onblur",b.dom.getAttrib(c,"onblur")),setFormValue("onclick",h),setFormValue("ondblclick",b.dom.getAttrib(c,"ondblclick")),setFormValue("onmousedown",b.dom.getAttrib(c,"onmousedown")),setFormValue("onmouseup",b.dom.getAttrib(c,"onmouseup")),setFormValue("onmouseover",b.dom.getAttrib(c,"onmouseover")),setFormValue("onmousemove",b.dom.getAttrib(c,"onmousemove")),setFormValue("onmouseout",b.dom.getAttrib(c,"onmouseout")),setFormValue("onkeypress",b.dom.getAttrib(c,"onkeypress")),setFormValue("onkeydown",b.dom.getAttrib(c,"onkeydown")),setFormValue("onkeyup",b.dom.getAttrib(c,"onkeyup")),setFormValue("target",b.dom.getAttrib(c,"target")),setFormValue("classes",b.dom.getAttrib(c,"class")),h!=null&&h.indexOf("window.open")!=-1?parseWindowOpen(h):parseFunction(h),selectByValue(a,"dir",b.dom.getAttrib(c,"dir")),selectByValue(a,"rel",b.dom.getAttrib(c,"rel")),selectByValue(a,"rev",b.dom.getAttrib(c,"rev")),selectByValue(a,"linklisthref",g),g.charAt(0)=="#"&&selectByValue(a,"anchorlist",g),addClassesToList("classlist","advlink_styles"),selectByValue(a,"classlist",b.dom.getAttrib(c,"class"),!0),selectByValue(a,"targetlist",b.dom.getAttrib(c,"target"),!0)):addClassesToList("classlist","advlink_styles")}function checkPrefix(a){a.value&&Validator.isEmail(a)&&!/^\s*mailto:/i.test(a.value)&&confirm(tinyMCEPopup.getLang("advlink_dlg.is_email"))&&(a.value="mailto:"+a.value),/^\s*www\./i.test(a.value)&&confirm(tinyMCEPopup.getLang("advlink_dlg.is_external"))&&(a.value="http://"+a.value)}function setFormValue(a,b){document.forms[0].elements[a].value=b}function parseWindowOpen(a){var b,c,d,e=document.forms[0];a.indexOf("return false;")!=-1?(e.popupreturn.checked=!0,a=a.replace("return false;","")):e.popupreturn.checked=!1,b=parseLink(a),b!=null&&(e.ispopup.checked=!0,setPopupControlsDisabled(!1),c=parseOptions(b.options),d=b.url,e.popupname.value=b.target,e.popupurl.value=d,e.popupwidth.value=getOption(c,"width"),e.popupheight.value=getOption(c,"height"),e.popupleft.value=getOption(c,"left"),e.popuptop.value=getOption(c,"top"),e.popupleft.value.indexOf("screen")!=-1&&(e.popupleft.value="c"),e.popuptop.value.indexOf("screen")!=-1&&(e.popuptop.value="c"),e.popuplocation.checked=getOption(c,"location")=="yes",e.popupscrollbars.checked=getOption(c,"scrollbars")=="yes",e.popupmenubar.checked=getOption(c,"menubar")=="yes",e.popupresizable.checked=getOption(c,"resizable")=="yes",e.popuptoolbar.checked=getOption(c,"toolbar")=="yes",e.popupstatus.checked=getOption(c,"status")=="yes",e.popupdependent.checked=getOption(c,"dependent")=="yes",buildOnClick())}function parseFunction(a){var b=document.forms[0],c=parseLink(a)}function getOption(a,b){return typeof a[b]=="undefined"?"":a[b]}function setPopupControlsDisabled(a){var b=document.forms[0];b.popupname.disabled=a,b.popupurl.disabled=a,b.popupwidth.disabled=a,b.popupheight.disabled=a,b.popupleft.disabled=a,b.popuptop.disabled=a,b.popuplocation.disabled=a,b.popupscrollbars.disabled=a,b.popupmenubar.disabled=a,b.popupresizable.disabled=a,b.popuptoolbar.disabled=a,b.popupstatus.disabled=a,b.popupreturn.disabled=a,b.popupdependent.disabled=a,setBrowserDisabled("popupurlbrowser",a)}function parseLink(a){var b,c,d,e,f,g,h,i;a=a.replace(RegExp("&#39;","g"),"'"),b=a.replace(RegExp("\\s*([A-Za-z0-9.]*)\\s*\\(.*","gi"),"$1"),c=templates[b];if(c){d=c.match(RegExp("'?\\$\\{[A-Za-z0-9.]*\\}'?","gi")),e="\\s*[A-Za-z0-9.]*\\s*\\(",f="";for(g=0;g<d.length;g++)d[g].indexOf("'${")!=-1?e+="'(.*)'":e+="([0-9]*)",f+="$"+(g+1),d[g]=d[g].replace(RegExp("[^A-Za-z0-9]","gi"),""),g!=d.length-1?(e+="\\s*,\\s*",f+="<delim>"):e+=".*";e+="\\);?",h=[],h._function=b,i=a.replace(RegExp(e,"gi"),f).split("<delim>");for(g=0;g<d.length;g++)h[d[g]]=i[g];return h}return null}function parseOptions(a){var b,c,d,e;if(a==null||a=="")return[];a=a.toLowerCase(),a=a.replace(/;/g,","),a=a.replace(/[^0-9a-z=,]/g,""),b=a.split(","),c=[];for(d=0;d<b.length;d++)e=b[d].split("="),e.length==2&&(c[e[0]]=e[1]);return c}function buildOnClick(){var a,b,c=document.forms[0];if(!c.ispopup.checked){c.onclick.value="";return}a="window.open('",b=c.popupurl.value,a+=b+"','",a+=c.popupname.value+"','",c.popuplocation.checked&&(a+="location=yes,"),c.popupscrollbars.checked&&(a+="scrollbars=yes,"),c.popupmenubar.checked&&(a+="menubar=yes,"),c.popupresizable.checked&&(a+="resizable=yes,"),c.popuptoolbar.checked&&(a+="toolbar=yes,"),c.popupstatus.checked&&(a+="status=yes,"),c.popupdependent.checked&&(a+="dependent=yes,"),c.popupwidth.value!=""&&(a+="width="+c.popupwidth.value+","),c.popupheight.value!=""&&(a+="height="+c.popupheight.value+","),c.popupleft.value!=""&&(c.popupleft.value!="c"?a+="left="+c.popupleft.value+",":a+="left='+(screen.availWidth/2-"+c.popupwidth.value/2+")+',"),c.popuptop.value!=""&&(c.popuptop.value!="c"?a+="top="+c.popuptop.value+",":a+="top='+(screen.availHeight/2-"+c.popupheight.value/2+")+',"),a.charAt(a.length-1)==","&&(a=a.substring(0,a.length-1)),a+="');",c.popupreturn.checked&&(a+="return false;"),c.onclick.value=a,c.href.value==""&&(c.href.value=b)}function setAttrib(a,b,c){var d=document.forms[0],e=d.elements[b.toLowerCase()],f=tinyMCEPopup.editor.dom;if(typeof c=="undefined"||c==null)c="",e&&(c=e.value);b=="style"&&(c=f.serializeStyle(f.parseStyle(c),"a")),f.setAttrib(a,b,c)}function getAnchorListHTML(a,b){var c,d,e,f=tinyMCEPopup.editor,g=f.dom.select("a"),h="";for(d=0,e=g.length;d<e;d++)(c=f.dom.getAttrib(g[d],"name"))!=""&&(h+='<option value="#'+c+'">'+c+"</option>");return h==""?"":(h='<select id="'+a+'" name="'+a+'" class="mceAnchorList"'+' onchange="this.form.'+b+'.value=this.options[this.selectedIndex].value"'+">"+'<option value="">---</option>'+h+"</select>",h)}function insertAction(){var a,b,c=tinyMCEPopup.editor,d=c.selection.getNode();checkPrefix(document.forms[0].href),d=c.dom.getParent(d,"A");if(!document.forms[0].href.value){b=c.selection.getBookmark(),c.dom.remove(d,1),c.selection.moveToBookmark(b),tinyMCEPopup.execCommand("mceEndUndoLevel"),tinyMCEPopup.close();return}if(d==null){c.getDoc().execCommand("unlink",!1,null),tinyMCEPopup.execCommand("mceInsertLink",!1,"#mce_temp_url#",{skip_undo:1}),a=tinymce.grep(c.dom.select("a"),function(a){return c.dom.getAttrib(a,"href")=="#mce_temp_url#"});for(b=0;b<a.length;b++)setAllAttribs(d=a[b])}else setAllAttribs(d);if(d.childNodes.length!=1||d.firstChild.nodeName!="IMG")c.focus(),c.selection.select(d),c.selection.collapse(0),tinyMCEPopup.storeSelection();tinyMCEPopup.execCommand("mceEndUndoLevel"),tinyMCEPopup.close()}function setAllAttribs(a){var b=document.forms[0],c=b.href.value.replace(/ /g,"%20"),d=getSelectValue(b,"targetlist");setAttrib(a,"href",c),setAttrib(a,"title"),setAttrib(a,"target",d=="_self"?"":d),setAttrib(a,"id"),setAttrib(a,"style"),setAttrib(a,"class",getSelectValue(b,"classlist")),setAttrib(a,"rel"),setAttrib(a,"rev"),setAttrib(a,"charset"),setAttrib(a,"hreflang"),setAttrib(a,"dir"),setAttrib(a,"lang"),setAttrib(a,"tabindex"),setAttrib(a,"accesskey"),setAttrib(a,"type"),setAttrib(a,"onfocus"),setAttrib(a,"onblur"),setAttrib(a,"onclick"),setAttrib(a,"ondblclick"),setAttrib(a,"onmousedown"),setAttrib(a,"onmouseup"),setAttrib(a,"onmouseover"),setAttrib(a,"onmousemove"),setAttrib(a,"onmouseout"),setAttrib(a,"onkeypress"),setAttrib(a,"onkeydown"),setAttrib(a,"onkeyup"),tinyMCE.isMSIE5&&(a.outerHTML=a.outerHTML)}function getSelectValue(a,b){var c=a.elements[b];return!c||c.options==null||c.selectedIndex==-1?"":c.options[c.selectedIndex].value}function getLinkListHTML(a,b,c){var d,e;if(typeof tinyMCELinkList=="undefined"||tinyMCELinkList.length==0)return"";d="",d+='<select id="'+a+'" name="'+a+'"',d+=' class="mceLinkList" onfoc2us="tinyMCE.addSelectAccessibility(event, this, window);" onchange="this.form.'+b+".value=",d+="this.options[this.selectedIndex].value;",typeof c!="undefined"&&(d+=c+"('"+b+"',this.options[this.selectedIndex].text,this.options[this.selectedIndex].value);"),d+='"><option value="">---</option>';for(e=0;e<tinyMCELinkList.length;e++)d+='<option value="'+tinyMCELinkList[e][1]+'">'+tinyMCELinkList[e][0]+"</option>";return d+="</select>",d}function getTargetListHTML(a,b){var c,d,e,f=tinyMCEPopup.getParam("theme_advanced_link_targets","").split(";"),g="";g+='<select id="'+a+'" name="'+a+'" onfocus="tinyMCE.addSelectAccessibility(event, this, window);" onchange="this.form.'+b+".value=",g+='this.options[this.selectedIndex].value;">',g+='<option value="_self">'+tinyMCEPopup.getLang("advlink_dlg.target_same")+"</option>",g+='<option value="_blank">'+tinyMCEPopup.getLang("advlink_dlg.target_blank")+" (_blank)</option>",g+='<option value="_parent">'+tinyMCEPopup.getLang("advlink_dlg.target_parent")+" (_parent)</option>",g+='<option value="_top">'+tinyMCEPopup.getLang("advlink_dlg.target_top")+" (_top)</option>";for(c=0;c<f.length;c++){if(f[c]=="")continue;d=f[c].split("=")[0],e=f[c].split("=")[1],g+='<option value="'+d+'">'+e+" ("+d+")</option>"}return g+="</select>",g}var templates;tinyMCEPopup.requireLangPack(),templates={"window.open":"window.open('${url}','${target}','${options}')"},preinit(),tinyMCEPopup.onInit.add(init);