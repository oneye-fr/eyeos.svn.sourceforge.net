function init(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;tinyMCEPopup.resizeToInnerSize(),document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table"),document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor"),a=tinyMCEPopup.editor,b=a.dom,c=b.getParent(a.selection.getStart(),"tr"),d=document.forms[0],e=b.parseStyle(b.getAttrib(c,"style")),f=c.parentNode.nodeName.toLowerCase(),g=b.getAttrib(c,"align"),h=b.getAttrib(c,"valign"),i=trimSize(getStyle(c,"height","height")),j=b.getAttrib(c,"class"),k=convertRGBToHex(getStyle(c,"bgcolor","backgroundColor")),l=getStyle(c,"background","backgroundImage").replace(RegExp("url\\(['\"]?([^'\"]*)['\"]?\\)","gi"),"$1"),m=b.getAttrib(c,"id"),n=b.getAttrib(c,"lang"),o=b.getAttrib(c,"dir"),selectByValue(d,"rowtype",f),b.select("td.mceSelected,th.mceSelected",c).length==0?(addClassesToList("class","table_row_styles"),TinyMCE_EditableSelects.init(),d.bgcolor.value=k,d.backgroundimage.value=l,d.height.value=i,d.id.value=m,d.lang.value=n,d.style.value=b.serializeStyle(e),selectByValue(d,"align",g),selectByValue(d,"valign",h),selectByValue(d,"class",j,!0,!0),selectByValue(d,"dir",o),isVisible("backgroundimagebrowser")&&(document.getElementById("backgroundimage").style.width="180px"),updateColor("bgcolor_pick","bgcolor")):tinyMCEPopup.dom.hide("action")}function updateAction(){var a,b,c,d,e=tinyMCEPopup.editor,f=e.dom,g=document.forms[0],h=getSelectValue(g,"action");if(!AutoValidator.validate(g))return tinyMCEPopup.alert(AutoValidator.getErrorMessages(g).join(". ")+"."),!1;tinyMCEPopup.restoreSelection(),a=f.getParent(e.selection.getStart(),"tr"),b=f.getParent(e.selection.getStart(),"table");if(f.select("td.mceSelected,th.mceSelected",a).length>0){tinymce.each(b.rows,function(a){var b;for(b=0;b<a.cells.length;b++)if(f.hasClass(a.cells[b],"mceSelected")){updateRow(a,!0);return}}),e.addVisual(),e.nodeChanged(),e.execCommand("mceEndUndoLevel"),tinyMCEPopup.close();return}switch(h){case"row":updateRow(a);break;case"all":c=b.getElementsByTagName("tr");for(d=0;d<c.length;d++)updateRow(c[d],!0);break;case"odd":case"even":c=b.getElementsByTagName("tr");for(d=0;d<c.length;d++)(d%2==0&&h=="odd"||d%2!=0&&h=="even")&&updateRow(c[d],!0,!0)}e.addVisual(),e.nodeChanged(),e.execCommand("mceEndUndoLevel"),tinyMCEPopup.close()}function updateRow(a,b,c){var d,e,f,g,h,i=tinyMCEPopup.editor,j=document.forms[0],k=i.dom,l=a.parentNode.nodeName.toLowerCase(),m=getSelectValue(j,"rowtype"),n=i.getDoc();b||k.setAttrib(a,"id",j.id.value),k.setAttrib(a,"align",getSelectValue(j,"align")),k.setAttrib(a,"vAlign",getSelectValue(j,"valign")),k.setAttrib(a,"lang",j.lang.value),k.setAttrib(a,"dir",getSelectValue(j,"dir")),k.setAttrib(a,"style",k.serializeStyle(k.parseStyle(j.style.value))),k.setAttrib(a,"class",getSelectValue(j,"class")),k.setAttrib(a,"background",""),k.setAttrib(a,"bgColor",""),k.setAttrib(a,"height",""),a.style.height=getCSSSize(j.height.value),a.style.backgroundColor=j.bgcolor.value,j.backgroundimage.value!=""?a.style.backgroundImage="url('"+j.backgroundimage.value+"')":a.style.backgroundImage="";if(l!=m&&!c){d=a.cloneNode(1),e=k.getParent(a,"table"),f=m,g=null;for(h=0;h<e.childNodes.length;h++)e.childNodes[h].nodeName.toLowerCase()==f&&(g=e.childNodes[h]);g==null&&(g=n.createElement(f),e.firstChild.nodeName=="CAPTION"?i.dom.insertAfter(g,e.firstChild):e.insertBefore(g,e.firstChild)),g.appendChild(d),a.parentNode.removeChild(a),a=d}k.setAttrib(a,"style",k.serializeStyle(k.parseStyle(a.style.cssText)))}function changedBackgroundImage(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-image"]="url('"+a.backgroundimage.value+"')",a.style.value=b.serializeStyle(c)}function changedStyle(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-image"]?a.backgroundimage.value=c["background-image"].replace(RegExp("url\\('?([^']*)'?\\)","gi"),"$1"):a.backgroundimage.value="",c.height&&(a.height.value=trimSize(c.height)),c["background-color"]&&(a.bgcolor.value=c["background-color"],updateColor("bgcolor_pick","bgcolor"))}function changedSize(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value),d=a.height.value;d!=""?c.height=getCSSSize(d):c.height="",a.style.value=b.serializeStyle(c)}function changedColor(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-color"]=a.bgcolor.value,a.style.value=b.serializeStyle(c)}tinyMCEPopup.requireLangPack(),tinyMCEPopup.onInit.add(init);