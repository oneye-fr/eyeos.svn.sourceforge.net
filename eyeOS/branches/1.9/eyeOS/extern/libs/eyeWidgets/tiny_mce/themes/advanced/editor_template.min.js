(function(a){var b,c=a.DOM,d=a.dom.Event,e=a.extend,f=a.each,g=a.util.Cookie,h=a.explode;a.ThemeManager.requireLangPack("advanced"),a.create("tinymce.themes.AdvancedTheme",{sizes:[8,10,12,14,18,24,36],controls:{bold:["bold_desc","Bold"],italic:["italic_desc","Italic"],underline:["underline_desc","Underline"],strikethrough:["striketrough_desc","Strikethrough"],justifyleft:["justifyleft_desc","JustifyLeft"],justifycenter:["justifycenter_desc","JustifyCenter"],justifyright:["justifyright_desc","JustifyRight"],justifyfull:["justifyfull_desc","JustifyFull"],bullist:["bullist_desc","InsertUnorderedList"],numlist:["numlist_desc","InsertOrderedList"],outdent:["outdent_desc","Outdent"],indent:["indent_desc","Indent"],cut:["cut_desc","Cut"],copy:["copy_desc","Copy"],paste:["paste_desc","Paste"],undo:["undo_desc","Undo"],redo:["redo_desc","Redo"],link:["link_desc","mceLink"],unlink:["unlink_desc","unlink"],image:["image_desc","mceImage"],cleanup:["cleanup_desc","mceCleanup"],help:["help_desc","mceHelp"],code:["code_desc","mceCodeEditor"],hr:["hr_desc","InsertHorizontalRule"],removeformat:["removeformat_desc","RemoveFormat"],sub:["sub_desc","subscript"],sup:["sup_desc","superscript"],forecolor:["forecolor_desc","ForeColor"],forecolorpicker:["forecolor_desc","mceForeColor"],backcolor:["backcolor_desc","HiliteColor"],backcolorpicker:["backcolor_desc","mceBackColor"],charmap:["charmap_desc","mceCharMap"],visualaid:["visualaid_desc","mceToggleVisualAid"],anchor:["anchor_desc","mceInsertAnchor"],newdocument:["newdocument_desc","mceNewDocument"],blockquote:["blockquote_desc","mceBlockQuote"]},stateControls:["bold","italic","underline","strikethrough","bullist","numlist","justifyleft","justifycenter","justifyright","justifyfull","sub","sup","blockquote"],init:function(b,d){var g,h,i,j=this;j.editor=b,j.url=d,j.onResolveName=new a.util.Dispatcher(this),b.forcedHighContrastMode=b.settings.detect_highcontrast&&j._isHighContrast(),b.settings.skin=b.forcedHighContrastMode?"highcontrast":b.settings.skin,j.settings=g=e({theme_advanced_path:!0,theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect",theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code",theme_advanced_buttons3:"hr,removeformat,visualaid,|,sub,sup,|,charmap",theme_advanced_blockformats:"p,address,pre,h1,h2,h3,h4,h5,h6",theme_advanced_toolbar_align:"center",theme_advanced_fonts:"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",theme_advanced_more_colors:1,theme_advanced_row_height:23,theme_advanced_resize_horizontal:1,theme_advanced_resizing_use_cookie:1,theme_advanced_font_sizes:"1,2,3,4,5,6,7",theme_advanced_font_selector:"span",theme_advanced_show_current_color:0,readonly:b.settings.readonly},b.settings),g.font_size_style_values||(g.font_size_style_values="8pt,10pt,12pt,14pt,18pt,24pt,36pt"),a.is(g.theme_advanced_font_sizes,"string")&&(g.font_size_style_values=a.explode(g.font_size_style_values),g.font_size_classes=a.explode(g.font_size_classes||""),i={},b.settings.theme_advanced_font_sizes=g.theme_advanced_font_sizes,f(b.getParam("theme_advanced_font_sizes","","hash"),function(a,b){var c;b==a&&a>=1&&a<=7&&(b=a+" ("+j.sizes[a-1]+"pt)",c=g.font_size_classes[a-1],a=g.font_size_style_values[a-1]||j.sizes[a-1]+"pt"),/^\s*\./.test(a)&&(c=a.replace(/\./g,"")),i[b]=c?{"class":c}:{fontSize:a}}),g.theme_advanced_font_sizes=i),(h=g.theme_advanced_path_location)&&h!="none"&&(g.theme_advanced_statusbar_location=g.theme_advanced_path_location),g.theme_advanced_statusbar_location=="none"&&(g.theme_advanced_statusbar_location=0),b.settings.content_css!==!1&&b.contentCSS.push(b.baseURI.toAbsolute(d+"/skins/"+b.settings.skin+"/content.css")),b.onInit.add(function(){b.settings.readonly||(b.onNodeChange.add(j._nodeChanged,j),b.onKeyUp.add(j._updateUndoStatus,j),b.onMouseUp.add(j._updateUndoStatus,j),b.dom.bind(b.dom.getRoot(),"dragend",function(){j._updateUndoStatus(b)}))}),b.onSetProgressState.add(function(a,b,d){var e,f,g=a.id;b?j.progressTimer=setTimeout(function(){e=a.getContainer(),e=e.insertBefore(c.create("DIV",{style:"position:relative"}),e.firstChild),f=c.get(a.id+"_tbl"),c.add(e,"div",{id:g+"_blocker","class":"mceBlocker",style:{width:f.clientWidth+2,height:f.clientHeight+2}}),c.add(e,"div",{id:g+"_progress","class":"mceProgress",style:{left:f.clientWidth/2,top:f.clientHeight/2}})},d||0):(c.remove(g+"_blocker"),c.remove(g+"_progress"),clearTimeout(j.progressTimer))}),c.loadCSS(g.editor_css?b.documentBaseURI.toAbsolute(g.editor_css):d+"/skins/"+b.settings.skin+"/ui.css"),g.skin_variant&&c.loadCSS(d+"/skins/"+b.settings.skin+"/ui_"+g.skin_variant+".css")},_isHighContrast:function(){var a=c.add(c.getRoot(),"div",{style:"background-color: rgb(171,239,86);"}),b=(c.getStyle(a,"background-color",!0)+"").toLowerCase().replace(/ /g,"");return c.remove(a),b!="rgb(171,239,86)"&&b!="#abef56"},createControl:function(a,b){var c,d;if(d=b.createControl(a))return d;switch(a){case"styleselect":return this._createStyleSelect();case"formatselect":return this._createBlockFormats();case"fontselect":return this._createFontSelect();case"fontsizeselect":return this._createFontSizeSelect();case"forecolor":return this._createForeColorMenu();case"backcolor":return this._createBackColorMenu();case"zoomselect":return this._createZoomSelect()}if(c=this.controls[a])return b.createButton(a,{title:"advanced."+c[0],cmd:c[1],ui:c[2],value:c[3]})},execCommand:function(a,b,c){var d=this["_"+a];return d?(d.call(this,b,c),!0):!1},_importClasses:function(){var a=this.editor,b=a.controlManager.get("styleselect");b.getLength()==0&&f(a.dom.getClasses(),function(c,d){var e="style_"+d;a.formatter.register(e,{inline:"span",attributes:{"class":c["class"]},selector:"*"}),b.add(c["class"],e)})},_createStyleSelect:function(){var a=this,b=a.editor,c=b.controlManager,e=c.createListBox("styleselect",{title:"advanced.style_select",onselect:function(a){var c,d=[];return f(e.items,function(a){d.push(a.value)}),b.focus(),b.undoManager.add(),c=b.formatter.matchAll(d),!a||c[0]==a?c[0]&&b.formatter.remove(c[0]):b.formatter.apply(a),b.undoManager.add(),b.nodeChanged(),!1}});return b.onInit.add(function(){var c=0,d=b.getParam("style_formats");d?f(d,function(a){var d,g=0;f(a,function(){g++}),g>1?(d=a.name=a.name||"style_"+c++,b.formatter.register(d,a),e.add(a.title,d)):e.add(a.title)}):f(b.getParam("theme_advanced_styles","","hash"),function(d,f){var g;d&&(g="style_"+c++,b.formatter.register(g,{inline:"span",classes:d,selector:"*"}),e.add(a.editor.translate(f),g))})}),e.getLength()==0&&e.onPostRender.add(function(b,c){e.NativeListBox?d.add(c.id,"focus",a._importClasses,a):(d.add(c.id+"_text","focus",a._importClasses,a),d.add(c.id+"_text","mousedown",a._importClasses,a),d.add(c.id+"_open","focus",a._importClasses,a),d.add(c.id+"_open","mousedown",a._importClasses,a))}),e},_createFontSelect:function(){var a=this,b=a.editor,c=b.controlManager.createListBox("fontselect",{title:"advanced.fontdefault",onselect:function(a){var d=c.items[c.selectedIndex];if(!a&&d){b.execCommand("FontName",!1,d.value);return}return b.execCommand("FontName",!1,a),c.select(function(b){return a==b}),d&&d.value==a&&c.select(null),!1}});return c&&f(b.getParam("theme_advanced_fonts",a.settings.theme_advanced_fonts,"hash"),function(a,d){c.add(b.translate(d),a,{style:a.indexOf("dings")==-1?"font-family:"+a:""})}),c},_createFontSizeSelect:function(){var a=this,b=a.editor,c=0,d=[],e=b.controlManager.createListBox("fontsizeselect",{title:"advanced.font_size",onselect:function(a){var c=e.items[e.selectedIndex];if(!a&&c){c=c.value,c["class"]?(b.formatter.toggle("fontsize_class",{value:c["class"]}),b.undoManager.add(),b.nodeChanged()):b.execCommand("FontSize",!1,c.fontSize);return}return a["class"]?(b.focus(),b.undoManager.add(),b.formatter.toggle("fontsize_class",{value:a["class"]}),b.undoManager.add(),b.nodeChanged()):b.execCommand("FontSize",!1,a.fontSize),e.select(function(b){return a==b}),c&&(c.value.fontSize==a.fontSize||c.value["class"]&&c.value["class"]==a["class"])&&e.select(null),!1}});return e&&f(a.settings.theme_advanced_font_sizes,function(b,d){var f=b.fontSize;f>=1&&f<=7&&(f=a.sizes[parseInt(f)-1]+"pt"),e.add(d,b,{style:"font-size:"+f,"class":"mceFontSize"+c++ +(" "+(b["class"]||""))})}),e},_createBlockFormats:function(){var a={p:"advanced.paragraph",address:"advanced.address",pre:"advanced.pre",h1:"advanced.h1",h2:"advanced.h2",h3:"advanced.h3",h4:"advanced.h4",h5:"advanced.h5",h6:"advanced.h6",div:"advanced.div",blockquote:"advanced.blockquote",code:"advanced.code",dt:"advanced.dt",dd:"advanced.dd",samp:"advanced.samp"},b=this,c=b.editor.controlManager.createListBox("formatselect",{title:"advanced.block",onselect:function(a){return b.editor.execCommand("FormatBlock",!1,a),!1}});return c&&f(b.editor.getParam("theme_advanced_blockformats",b.settings.theme_advanced_blockformats,"hash"),function(d,e){c.add(b.editor.translate(e!=d?e:a[d]),d,{"class":"mce_formatPreview mce_"+d})}),c},_createZoomSelect:function(){var a=this,b=a.editor,c=b.controlManager.createListBox("zoomselect",{title:"zoom",cmd:"SelectZoom"});return c&&(c.add("50%","50",{style:"font-size:8px;"}),c.add("75%","75",{style:"font-size:9px;"}),c.add("100%","100",{style:"font-size:10px;"}),c.add("125%","125",{style:"font-size:11px;"}),c.add("150%","150",{style:"font-size:12px;"}),c.add("175%","175",{style:"font-size:13px;"}),c.add("200%","200",{style:"font-size:14px;"})),c},_createForeColorMenu:function(){var a,b,c=this,d=c.settings,e={};d.theme_advanced_more_colors&&(e.more_colors_func=function(){c._mceColorPicker(0,{color:a.value,func:function(b){a.setColor(b)}})});if(b=d.theme_advanced_text_colors)e.colors=b;return d.theme_advanced_default_foreground_color&&(e.default_color=d.theme_advanced_default_foreground_color),e.title="advanced.forecolor_desc",e.cmd="ForeColor",e.scope=this,a=c.editor.controlManager.createColorSplitButton("forecolor",e),a},_createBackColorMenu:function(){var a,b,c=this,d=c.settings,e={};d.theme_advanced_more_colors&&(e.more_colors_func=function(){c._mceColorPicker(0,{color:a.value,func:function(b){a.setColor(b)}})});if(b=d.theme_advanced_background_colors)e.colors=b;return d.theme_advanced_default_background_color&&(e.default_color=d.theme_advanced_default_background_color),e.title="advanced.backcolor_desc",e.cmd="HiliteColor",e.scope=this,a=c.editor.controlManager.createColorSplitButton("backcolor",e),a},renderUI:function(b){var e,g,h,i,j,k,l=this,m=l.editor,n=l.settings;m.settings&&(m.settings.aria_label=n.aria_label+m.getLang("advanced.help_shortcut")),e=j=c.create("span",{role:"application","aria-labelledby":m.id+"_voice",id:m.id+"_parent","class":"mceEditor "+m.settings.skin+"Skin"+(n.skin_variant?" "+m.settings.skin+"Skin"+l._ufirst(n.skin_variant):"")}),c.add(e,"span",{"class":"mceVoiceLabel",style:"display:none;",id:m.id+"_voice"},n.aria_label),c.boxModel||(e=c.add(e,"div",{"class":"mceOldBoxModel"})),e=i=c.add(e,"table",{role:"presentation",id:m.id+"_tbl","class":"mceLayout",cellSpacing:0,cellPadding:0}),e=h=c.add(e,"tbody");switch((n.theme_advanced_layout_manager||"").toLowerCase()){case"rowlayout":g=l._rowLayout(n,h,b);break;case"customlayout":g=m.execCallback("theme_advanced_custom_layout",n,h,b,j);break;default:g=l._simpleLayout(n,h,b,j)}return e=b.targetNode,k=i.rows,c.addClass(k[0],"mceFirst"),c.addClass(k[k.length-1],"mceLast"),f(c.select("tr",h),function(a){c.addClass(a.firstChild,"mceFirst"),c.addClass(a.childNodes[a.childNodes.length-1],"mceLast")}),c.get(n.theme_advanced_toolbar_container)?c.get(n.theme_advanced_toolbar_container).appendChild(j):c.insertAfter(j,e),d.add(m.id+"_path_row","click",function(a){a=a.target;if(a.nodeName=="A")return l._sel(a.className.replace(/^.*mcePath_([0-9]+).*$/,"$1")),d.cancel(a)}),m.getParam("accessibility_focus")||d.add(c.add(j,"a",{href:"#"},"<!-- IE -->"),"focus",function(){tinyMCE.get(m.id).focus()}),n.theme_advanced_toolbar_location=="external"&&(b.deltaHeight=0),l.deltaHeight=b.deltaHeight,b.targetNode=null,m.onKeyDown.add(function(b,e){var f=121,g=122;if(e.altKey){if(e.keyCode===f)return a.isWebKit&&window.focus(),l.toolbarGroup.focus(),d.cancel(e);if(e.keyCode===g)return c.get(b.id+"_path_row").focus(),d.cancel(e)}}),m.addShortcut("alt+0","","mceShortcuts",l),{iframeContainer:g,editorContainer:m.id+"_parent",sizeContainer:i,deltaHeight:b.deltaHeight}},getInfo:function(){return{longname:"Advanced theme",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",version:a.majorVersion+"."+a.minorVersion}},resizeBy:function(a,b){var d=c.get(this.editor.id+"_ifr");this.resizeTo(d.clientWidth+a,d.clientHeight+b)},resizeTo:function(a,b,d){var e=this.editor,f=this.settings,h=c.get(e.id+"_tbl"),i=c.get(e.id+"_ifr");a=Math.max(f.theme_advanced_resizing_min_width||100,a),b=Math.max(f.theme_advanced_resizing_min_height||100,b),a=Math.min(f.theme_advanced_resizing_max_width||65535,a),b=Math.min(f.theme_advanced_resizing_max_height||65535,b),c.setStyle(h,"height",""),c.setStyle(i,"height",b),f.theme_advanced_resize_horizontal&&(c.setStyle(h,"width",""),c.setStyle(i,"width",a),a<h.clientWidth&&(a=h.clientWidth,c.setStyle(i,"width",h.clientWidth))),d&&f.theme_advanced_resizing_use_cookie&&g.setHash("TinyMCE_"+e.id+"_size",{cw:a,ch:b})},destroy:function(){var a=this.editor.id;d.clear(a+"_resize"),d.clear(a+"_path_row"),d.clear(a+"_external_close")},_simpleLayout:function(a,e,f,g){var h,i,j,k,l=this,m=l.editor,n=a.theme_advanced_toolbar_location,o=a.theme_advanced_statusbar_location;return a.readonly?(h=c.add(e,"tr"),h=i=c.add(h,"td",{"class":"mceIframeContainer"}),i):(n=="top"&&l._addToolbars(e,f),n=="external"&&(h=k=c.create("div",{style:"position:relative"}),h=c.add(h,"div",{id:m.id+"_external","class":"mceExternalToolbar"}),c.add(h,"a",{id:m.id+"_external_close",href:"javascript:;","class":"mceExternalClose"}),h=c.add(h,"table",{id:m.id+"_tblext",cellSpacing:0,cellPadding:0}),j=c.add(h,"tbody"),g.firstChild.className=="mceOldBoxModel"?g.firstChild.appendChild(k):g.insertBefore(k,g.firstChild),l._addToolbars(j,f),m.onMouseUp.add(function(){var a,e=c.get(m.id+"_external");c.show(e),c.hide(b),a=d.add(m.id+"_external_close","click",function(){c.hide(m.id+"_external"),d.remove(m.id+"_external_close","click",a)}),c.show(e),c.setStyle(e,"top",0-c.getRect(m.id+"_tblext").h-1),c.hide(e),c.show(e),e.style.filter="",b=m.id+"_external",e=null})),o=="top"&&l._addStatusBar(e,f),a.theme_advanced_toolbar_container||(h=c.add(e,"tr"),h=i=c.add(h,"td",{"class":"mceIframeContainer"})),n=="bottom"&&l._addToolbars(e,f),o=="bottom"&&l._addStatusBar(e,f),i)},_rowLayout:function(a,b,d){var e,g,i,j,k=this,l=k.editor,m=l.controlManager,n=a.theme_advanced_containers_default_class||"",o=a.theme_advanced_containers_default_align||"center";return f(h(a.theme_advanced_containers||""),function(f,h){var l=a["theme_advanced_container_"+f]||"";switch(f.toLowerCase()){case"mceeditor":e=c.add(b,"tr"),e=g=c.add(e,"td",{"class":"mceIframeContainer"});break;case"mceelementpath":k._addStatusBar(b,d);break;default:j=(a["theme_advanced_container_"+f+"_align"]||o).toLowerCase(),j="mce"+k._ufirst(j),e=c.add(c.add(b,"tr"),"td",{"class":"mceToolbar "+(a["theme_advanced_container_"+f+"_class"]||n)+" "+j||o}),i=m.createToolbar("toolbar"+h),k._addControls(l,i),c.setHTML(e,i.renderHTML()),d.deltaHeight-=a.theme_advanced_row_height}}),g},_addControls:function(a,b){var c,d=this,e=d.settings,g=d.editor.controlManager;e.theme_advanced_disable&&!d._disabled?(c={},f(h(e.theme_advanced_disable),function(a){c[a]=1}),d._disabled=c):c=d._disabled,f(h(a),function(a){var e;if(c&&c[a])return;if(a=="tablecontrols"){f(["table","|","row_props","cell_props","|","row_before","row_after","delete_row","|","col_before","col_after","delete_col","|","split_cells","merge_cells"],function(a){a=d.createControl(a,g),a&&b.add(a)});return}e=d.createControl(a,g),e&&b.add(e)})},_addToolbars:function(a,b){var d,e,f,g,h,i=this,j=i.editor,k=i.settings,l=j.controlManager,m=[],n=l.createToolbarGroup("toolbargroup",{name:j.getLang("advanced.toolbar"),tab_focus_toolbar:j.getParam("theme_advanced_tab_focus_toolbar")});i.toolbarGroup=n,h=k.theme_advanced_toolbar_align.toLowerCase(),h="mce"+i._ufirst(h),g=c.add(c.add(a,"tr",{role:"presentation"}),"td",{"class":"mceToolbar "+h,role:"presentation"});for(d=1;f=k["theme_advanced_buttons"+d];d++)e=l.createToolbar("toolbar"+d,{"class":"mceToolbarRow"+d}),k["theme_advanced_buttons"+d+"_add"]&&(f+=","+k["theme_advanced_buttons"+d+"_add"]),k["theme_advanced_buttons"+d+"_add_before"]&&(f=k["theme_advanced_buttons"+d+"_add_before"]+","+f),i._addControls(f,e),n.add(e),b.deltaHeight-=k.theme_advanced_row_height;m.push(n.renderHTML()),m.push(c.createHTML("a",{href:"#",accesskey:"z",title:j.getLang("advanced.toolbar_focus"),onfocus:"tinyMCE.getInstanceById('"+j.id+"').focus();"},"<!-- IE -->")),c.setHTML(g,m.join(""))},_addStatusBar:function(a,b){var e,f=this,h=f.editor,i=f.settings,j=c.add(a,"tr");j=e=c.add(j,"td",{"class":"mceStatusbar"}),j=c.add(j,"div",{id:h.id+"_path_row",role:"group","aria-labelledby":h.id+"_path_voice"}),i.theme_advanced_path?(c.add(j,"span",{id:h.id+"_path_voice"},h.translate("advanced.path")),c.add(j,"span",{},": ")):c.add(j,"span",{},"&#160;"),i.theme_advanced_resizing&&(c.add(e,"a",{id:h.id+"_resize",href:"javascript:;",onclick:"return false;","class":"mceResize",tabIndex:"-1"}),i.theme_advanced_resizing_use_cookie&&h.onPostRender.add(function(){var a=g.getHash("TinyMCE_"+h.id+"_size"),b=c.get(h.id+"_tbl");if(!a)return;f.resizeTo(a.cw,a.ch)}),h.onPostRender.add(function(){d.add(h.id+"_resize","click",function(a){a.preventDefault()}),d.add(h.id+"_resize","mousedown",function(a){function q(a){a.preventDefault(),n=l+(a.screenX-j),o=m+(a.screenY-k),f.resizeTo(n,o)}function r(a){d.remove(c.doc,"mousemove",b),d.remove(h.getDoc(),"mousemove",e),d.remove(c.doc,"mouseup",g),d.remove(h.getDoc(),"mouseup",i),n=l+(a.screenX-j),o=m+(a.screenY-k),f.resizeTo(n,o,!0)}var b,e,g,i,j,k,l,m,n,o,p;a.preventDefault(),j=a.screenX,k=a.screenY,p=c.get(f.editor.id+"_ifr"),l=n=p.clientWidth,m=o=p.clientHeight,b=d.add(c.doc,"mousemove",q),e=d.add(h.getDoc(),"mousemove",q),g=d.add(c.doc,"mouseup",r),i=d.add(h.getDoc(),"mouseup",r)})})),b.deltaHeight-=21,j=a=null},_updateUndoStatus:function(a){var b=a.controlManager,c=a.undoManager;b.setDisabled("undo",!c.hasUndo()&&!c.typing),b.setDisabled("redo",!c.hasRedo())},_nodeChanged:function(b,d,e,g,h){function v(a){var b,c=h.parents,d=a;typeof a=="string"&&(d=function(b){return b.nodeName==a});for(b=0;b<c.length;b++)if(d(c[b]))return c[b]}var i,j,k,l,m,n,o,p,q,r,s=this,t=0,u=s.settings;a.each(s.stateControls,function(a){d.setActive(a,b.queryCommandState(s.controls[a][1]))}),d.setActive("visualaid",b.hasVisual),s._updateUndoStatus(b),d.setDisabled("outdent",!b.queryCommandState("Outdent")),i=v("A");if(k=d.get("link"))if(!i||!i.name)k.setDisabled(!i&&g),k.setActive(!!i);if(k=d.get("unlink"))k.setDisabled(!i&&g),k.setActive(!!i&&!i.name);(k=d.get("anchor"))&&k.setActive(!g&&!!i&&i.name),i=v("IMG"),(k=d.get("image"))&&k.setActive(!g&&!!i&&e.className.indexOf("mceItem")==-1);if(k=d.get("styleselect"))s._importClasses(),q=[],f(k.items,function(a){q.push(a.value)}),r=b.formatter.matchAll(q),k.select(r[0]);if(k=d.get("formatselect"))i=v(c.isBlock),i&&k.select(i.nodeName.toLowerCase());v(function(a){return a.nodeName==="SPAN"&&!l&&a.className&&(l=a.className),b.dom.is(a,u.theme_advanced_font_selector)&&(!m&&a.style.fontSize&&(m=a.style.fontSize),!n&&a.style.fontFamily&&(n=a.style.fontFamily.replace(/[\"\']+/g,"").replace(/^([^,]+).*/,"$1").toLowerCase()),!o&&a.style.color&&(o=a.style.color),!p&&a.style.backgroundColor&&(p=a.style.backgroundColor)),!1}),(k=d.get("fontselect"))&&k.select(function(a){return a.replace(/^([^,]+).*/,"$1").toLowerCase()==n});if(k=d.get("fontsizeselect"))u.theme_advanced_runtime_fontsize&&!m&&!l&&(m=b.dom.getStyle(e,"fontSize",!0)),k.select(function(a){if(a.fontSize&&a.fontSize===m)return!0;if(a["class"]&&a["class"]===l)return!0});if(u.theme_advanced_show_current_color){function w(a,b){if(k=d.get(a))b||(b=k.settings.default_color),b!==k.value&&k.displayColor(b)}w("forecolor",o),w("backcolor",p)}if(u.theme_advanced_show_current_color){function w(a,b){if(k=d.get(a))b||(b=k.settings.default_color),b!==k.value&&k.displayColor(b)}w("forecolor",o),w("backcolor",p)}u.theme_advanced_path&&u.theme_advanced_statusbar_location&&(i=c.get(b.id+"_path")||c.add(b.id+"_path_row","span",{id:b.id+"_path"}),s.statusKeyboardNavigation&&(s.statusKeyboardNavigation.destroy(),s.statusKeyboardNavigation=null),c.setHTML(i,""),v(function(b){var d,e=b.nodeName.toLowerCase(),f="";if(b.nodeType!=1||e==="br"||b.getAttribute("data-mce-bogus")||c.hasClass(b,"mceItemHidden")||c.hasClass(b,"mceItemRemoved"))return;a.isIE&&b.scopeName!=="HTML"&&(e=b.scopeName+":"+e),e=e.replace(/mce\:/g,"");switch(e){case"b":e="strong";break;case"i":e="em";break;case"img":if(j=c.getAttrib(b,"src"))f+="src: "+j+" ";break;case"a":if(j=c.getAttrib(b,"name"))f+="name: "+j+" ",e+="#"+j;if(j=c.getAttrib(b,"href"))f+="href: "+j+" ";break;case"font":if(j=c.getAttrib(b,"face"))f+="font: "+j+" ";if(j=c.getAttrib(b,"size"))f+="size: "+j+" ";if(j=c.getAttrib(b,"color"))f+="color: "+j+" ";break;case"span":if(j=c.getAttrib(b,"style"))f+="style: "+j+" "}if(j=c.getAttrib(b,"id"))f+="id: "+j+" ";if(j=b.className){j=j.replace(/\b\s*(webkit|mce|Apple-)\w+\s*\b/g,"");if(j){f+="class: "+j+" ";if(c.isBlock(b)||e=="img"||e=="span")e+="."+j}}e=e.replace(/(html:)/g,""),e={name:e,node:b,title:f},s.onResolveName.dispatch(s,e),f=e.title,e=e.name,d=c.create("a",{href:"javascript:;",role:"button",onmousedown:"return false;",title:f,"class":"mcePath_"+t++},e),i.hasChildNodes()?(i.insertBefore(c.create("span",{"aria-hidden":"true"}," » "),i.firstChild),i.insertBefore(d,i.firstChild)):i.appendChild(d)},b.getBody()),c.select("a",i).length>0&&(s.statusKeyboardNavigation=new a.ui.KeyboardNavigation({root:b.id+"_path_row",items:c.select("a",i),excludeFromTabOrder:!0,onCancel:function(){b.focus()}},c)))},_sel:function(a){this.editor.execCommand("mceSelectNodeDepth",!1,a)},_mceInsertAnchor:function(){var a=this.editor;a.windowManager.open({url:this.url+"/anchor.htm",width:320+parseInt(a.getLang("advanced.anchor_delta_width",0)),height:90+parseInt(a.getLang("advanced.anchor_delta_height",0)),inline:!0},{theme_url:this.url})},_mceCharMap:function(){var a=this.editor;a.windowManager.open({url:this.url+"/charmap.htm",width:550+parseInt(a.getLang("advanced.charmap_delta_width",0)),height:265+parseInt(a.getLang("advanced.charmap_delta_height",0)),inline:!0},{theme_url:this.url})},_mceHelp:function(){var a=this.editor;a.windowManager.open({url:this.url+"/about.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceShortcuts:function(){var a=this.editor;a.windowManager.open({url:this.url+"/shortcuts.htm",width:480,height:380,inline:!0},{theme_url:this.url})},_mceColorPicker:function(a,b){var c=this.editor;b=b||{},c.windowManager.open({url:this.url+"/color_picker.htm",width:375+parseInt(c.getLang("advanced.colorpicker_delta_width",0)),height:250+parseInt(c.getLang("advanced.colorpicker_delta_height",0)),close_previous:!1,inline:!0},{input_color:b.color,func:b.func,theme_url:this.url})},_mceCodeEditor:function(){var a=this.editor;a.windowManager.open({url:this.url+"/source_editor.htm",width:parseInt(a.getParam("theme_advanced_source_editor_width",720)),height:parseInt(a.getParam("theme_advanced_source_editor_height",580)),inline:!0,resizable:!0,maximizable:!0},{theme_url:this.url})},_mceImage:function(){var a=this.editor;if(a.dom.getAttrib(a.selection.getNode(),"class").indexOf("mceItem")!=-1)return;a.windowManager.open({url:this.url+"/image.htm",width:355+parseInt(a.getLang("advanced.image_delta_width",0)),height:275+parseInt(a.getLang("advanced.image_delta_height",0)),inline:!0},{theme_url:this.url})},_mceLink:function(){var a=this.editor;a.windowManager.open({url:this.url+"/link.htm",width:310+parseInt(a.getLang("advanced.link_delta_width",0)),height:200+parseInt(a.getLang("advanced.link_delta_height",0)),inline:!0},{theme_url:this.url})},_mceNewDocument:function(){var a=this.editor;a.windowManager.confirm("advanced.newdocument",function(b){b&&(sendMsg(a.checknum,"New",""),a.execCommand("mceSetContent",!1,""))})},_mceForeColor:function(){var a=this;this._mceColorPicker(0,{color:a.fgColor,func:function(b){a.fgColor=b,a.editor.execCommand("ForeColor",!1,b)}})},_mceBackColor:function(){var a=this;this._mceColorPicker(0,{color:a.bgColor,func:function(b){a.bgColor=b,a.editor.execCommand("HiliteColor",!1,b)}})},_ufirst:function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}}),a.ThemeManager.add("advanced",a.themes.AdvancedTheme)})(tinymce);