function calculePart(a,b){var c=Math.floor(a*100/b);if(c<=25)return 1;if(c<=50)return 2;if(c<=75)return 3;if(c<=100)return 4}function calendar_GetPid(a){var b;a=a.parentNode;for(b=0;b<5;b+=1){if(a.pid)return a.pid;a=a.parentNode}}function calendar_updateCurrentHour(a){weekPlanner_instances[a]&&weekPlanner_instances[a].base.updateCurrentHour(a)}function resizeDays(){var a,b,c,d,e=parseInt(this.numDays,10)+.1;this.rowWidth=(xWidth(this.base.daysBase)-e)/this.numDays,a="";for(d=this.dayFrom;d<=this.numDays-1;d+=1)a=xGetElementById(this.pid+"_dayTodo_"+d),a.style.width=this.rowWidth+"px",a=xGetElementById(this.pid+"_dayName_"+d),a.style.width=this.rowWidth+"px",a=xGetElementById(this.pid+"_day_"+d),a.style.width=this.rowWidth+"px";b=xGetElementById(this.pid+"_fatherDays"),c=b.parentNode.style.height,b.style.height=c}function mouseDown(a){var b,c,d=new xEvent(a);d.target.noPrevent||xPreventDefault(a);if(!d||!d.target||!d.target.id)return!1;if(!d.target.pid){b=calendar_GetPid(d.target);if(!b)return!1}else b=d.target.pid;c=weekPlanner_instances[b],c.events.mouseDown(d)}function mouseOver(a){var b,c,d;xPreventDefault(a),b=new xEvent(a);if(!b||!b.target||!b.target.id)return!1;if(!b.target.pid){c=calendar_GetPid(b.target);if(!c)return!1}else c=b.target.pid;d=weekPlanner_instances[c],d.events.mouseOver(b)}function mouseUp(a){var b,c,d;xPreventDefault(a),b=new xEvent(a);if(!b||!b.target||!b.target.id)return!1;if(b.target.id!=="eyeApps"){if(!b.target.pid){c=calendar_GetPid(b.target);if(!c)return!1}else c=b.target.pid;d=weekPlanner_instances[c],d.events.mouseUp(b)}}function mouseClick(a){var b,c,d=new xEvent(a);if(!d||!d.target||!d.target.id)return!1;d.target.noPrevent||xPreventDefault(a);if(!d.target.pid){b=calendar_GetPid(d.target);if(!b)return!1}else b=d.target.pid;c=weekPlanner_instances[b],c.events.mouseClick(d)}function keyPress(a){var b,c,d=new xEvent(a);if(!d.target.pid){b=calendar_GetPid(d.target);if(!b)return!1}else b=d.target.pid;c=weekPlanner_instances[b],c.events.keyPress(d)}function weekPlanner_base(a){this.father=a,this.timeOut=null,this.totalParts=0,this.changeDate=function(a,b){var c,d,e;for(d=0;d<=this.dayNames.childNodes.length;d+=1)c=b+d,e=this.dayNames.childNodes[d].firstChild,e.data=a[c]},this.draw_dayNames=function(){var a,b,c;for(b=this.father.dayFrom;b<=this.father.dayEven-1;b+=1)a=document.createElement("div"),a.setAttribute("id",this.father.pid+"_dayName_"+b),a.style.position="relative",a.style.cssFloat="left",a.style.styleFloat="left",IEversion===6?a.style.width=this.father.rowWidth+1+"px":a.style.width=this.father.rowWidth+"px",a.style.height="100%",a.style.textAlign="center",a.style.color="#145689",a.style.lineHeight="200%",b!==this.father.dayFrom&&(!IEversion||IEversion>6)?a.style.borderLeft="1px transparent solid":b!==this.father.dayFrom&&(a.style.borderLeft="1px transparent"),c=document.createTextNode(this.father.weekDays[b]),a.appendChild(c),this.dayNames.appendChild(a)},this.draw_todos=function(){var a,b;for(a=this.father.dayFrom;a<=this.father.dayEven-1;a+=1)b=document.createElement("div"),b.setAttribute("id",this.father.pid+"_dayTodo_"+a),b.style.position="relative",b.style.cssFloat="left",b.style.styleFloat="left",b.style.width=this.father.rowWidth+"px",b.style.height="100%",b.style.textAlign="center",b.style.color="#145689",a!==this.father.dayFrom&&(b.style.borderLeft="1px #C1C1C1 solid"),this.dayTodo.appendChild(b)},this.draw_bodyDays=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=function(){for(m=0;m<this.notes.length;m+=1)u=this.notes[m].startPartObj.numOfLevels(),this.notes[m].level===0||u===1?(this.notes[m].style.width="50%",this.notes[m].style.left="0px",this.notes[m].level=0):(a=90/u,h=a*this.notes[m].level,l=90-h,this.notes[m].style.width=l+"%",this.notes[m].style.left=h+"%",this.notes[m].style.zIndex=10+this.notes[m].level)},o=function(a){var b,c,d,e,f,g=a.cid;this.notes[g]=a,c=a.startPartObj.addNote(a),a.level=c,b=a.startPart,b+=a.parts,b-=1,e=a.fromParts,d=a.startPart+1;for(f=d;f<e;f+=1)xGetElementById(a.day+"_part_"+f).addNoteToLevel(a,c)},p=function(a){var b,c,d,e,f=a.cid;delete this.notes[f],this.notes.sort(),this.notes.pop(),a.startPartObj.delNote(a),b=a.startPart,b+=a.parts,b-=1,c=a.fromParts,d=a.startPart+1;for(e=d;e<c;e+=1)xGetElementById(a.day+"_part_"+e).delNoteToLevel(a,a.level)},q=function(a,b){this.notesLevel[b]?(this.notesLevel[b].moveLevel(b),this.notesLevel[b]=a):this.notesLevel[b]=a},r=function(a,b){this.notesLevel[b]&&delete this.notesLevel[b]},s=function(a){var b,c;for(c=0;c<=this.notesLevel.length;c+=1)if(typeof this.notesLevel[c]=="undefined")return this.notesLevel[c]=a,c;return b=this.notesLevel.push(a),b-=1,b},t=function(a){var b;for(b=0;b<=this.notesLevel.length;b+=1)this.notesLevel[b].cid===a.cid&&(delete this.notesLevel[b],this.notesLevel.sort(),this.notesLevel.pop())},u=function(){var a,b=0;for(a=0;a<=this.notesLevel.length;a+=1)this.notesLevel[a]&&(b+=1);return b},v=document.createElement("div"),w=this.father.dayFrom;v.setAttribute("id",this.father.pid+"_day_"+w),v.className="eyeCalendar_day",v.style.width=this.father.rowWidth+"px",v.notes=[],v.orderNotes=n,v.addNote=o,v.delNote=p,i=0;for(c=this.father.hourFrom;c<=this.father.hourEven;c+=1){e=document.createElement("div"),e.setAttribute("id",this.father.pid+"_hour_"+w+"_"+c),e.className="eyeCalendar_hour",e.style.height=this.father.rowHeight+"px",e.pid=this.father.pid,g=i*4,b=g+4;for(g;g<b;g+=1)j=document.createElement("div"),j.setAttribute("id",w+"_part_"+g),j.className="eyeCalendar_part",j.pid=this.father.pid,j.evenType="default",j.day=w,j.hour=c,j.num=g,j.addNote=s,j.addNoteToLevel=q,j.delNote=t,j.delNoteToLevel=r,j.notesLevel=[],j.numOfLevels=u,e.appendChild(j);c!==this.father.hourFrom&&(e.style.borderTop="1px #C1C1C1 solid"),d=document.createElement("div"),d.setAttribute("id","halfHour"),d.style.top=this.father.rowHeight/2+"px",d.className="eyeCalendar_halfHour",e.appendChild(d),v.appendChild(e),i+=1}this.daysContainer.appendChild(v);for(w=this.father.dayFrom+1;w<=this.father.dayEven-1;w+=1){v=v.cloneNode(!0),v.setAttribute("id",this.father.pid+"_day_"+w),v.style.borderLeft="1px #C1C1C1 solid",v.notes=[],v.orderNotes=n,v.addNote=o,v.delNote=p,f=v.childNodes,i=0;for(c=0;c<f.length;c+=1){f[c].setAttribute("id",this.father.pid+"_hour_"+w+"_"+c),g=i*4,b=g+4,k=f[c].childNodes;for(m=0;m<k.length;m+=1)k[m].id==="halfHour"?m=k.length:(k[m].setAttribute("id",w+"_part_"+g),k[m].num=g,k[m].day=w,k[m].hour=c,k[m].evenType="default",k[m].pid=this.father.pid,k[m].addNote=s,k[m].notesLevel=[],k[m].addNoteToLevel=q,k[m].delNote=t,k[m].delNoteToLevel=r,k[m].numOfLevels=u,g+=1);i+=1}this.totalParts=g,this.daysContainer.appendChild(v)}},this.draw_bodyDaysIE=function(){var a,b,c,d,e,f,g,h=function(){return!1};for(a=this.father.dayFrom;a<=this.father.dayEven-1;a+=1){g=document.createElement("div"),g.setAttribute("id",this.father.pid+"_day_"+a),g.style.position="relative",g.style.cssFloat="left",g.style.styleFloat="left",g.style.width=this.father.rowWidth+"px",g.style.height="100%",g.pid=this.father.pid,g.onselectstart=h,a!==this.father.dayFrom&&(g.style.borderLeft="1px #C1C1C1 solid"),e=0;for(c=this.father.hourFrom;c<=this.father.hourEven;c+=1){d=e*4,b=d+4;for(d;d<b;d+=1)f=document.createElement("div"),f.setAttribute("id",a+"_part_"+d),f.style.position="relative",f.style.cssFloat="left",f.style.styleFloat="left",f.style.width="100%",f.style.height=this.father.rowHeight/4+"px",f.pid=this.father.pid,f.day=a,f.hour=c,f.num=d,f.style.zIndex="1",f.notesInPart=[],d===b-1&&(f.style.borderBottom="1px #C1C1C1 solid"),f.evenType="default",g.appendChild(f);g.appendChild(f),e+=1}this.totalParts=d,this.daysContainer.appendChild(g)}},this.draw_dayHours=function(){var a,b,c,d=function(){return!1};for(a=this.father.hourFrom;a<=this.father.hourEven;a+=1)b=document.createElement("div"),b.setAttribute("id","hour"),b.style.position="relative",b.style.cssFloat="left",b.style.styleFloat="left",b.style.width="100%",IEversion&&IEversion<7?b.style.height=this.father.rowHeight+1+""+"px":b.style.height=this.father.rowHeight+"px",b.style.borderTop="1px #E6E6E6 solid",b.style.textAlign="center",b.style.color="#585858",IEversion&&(b.onselectstart=d),c=document.createTextNode(a+":00"),b.appendChild(c),this.hoursBase.appendChild(b)},this.goToFirstNote=function(){this.father.firstTop||(this.father.firstTop=xTop(this.hourLine)),this.fatherDays.scrollTop=this.father.firstTop},this.drawCurrentHour=function(){var a,b,c,d=new Date,e=d.getHours(),f=d.getMinutes(),g=d.getSeconds();if(e>this.father.hourEven)return!1;a=e*51,a+=f*.83,a=parseInt(a,10),this.hourLine=document.createElement("div"),this.hourLine.setAttribute("id",this.father.pid+"_currentHour"),this.hourLine.style.position="absolute",this.hourLine.style.top=a+"px",this.hourLine.style.left="0px",this.hourLine.style.width="100%",this.hourLine.style.height="1px",IEversion===6&&(this.hourLine.style.visibility="hidden",this.hourLine.style.display="none"),this.hourLine.style.backgroundColor="#ea614f",c=document.createElement("div"),c.setAttribute("id",this.father.pid+"_textContainer"),c.style.position="absolute",c.style.marginTop="-2.4%",c.style.left="5px",c.style.color="#ea614f",c.style.fontSize="10px",c.style.zIndex=1,f<10&&(f="0"+f),g<10&&(g="0"+g),b=document.createTextNode(e+":"+f+":"+g),c.appendChild(b),this.hourLine.appendChild(c),this.daysContainer.appendChild(this.hourLine),this.timeOut=setTimeout("calendar_updateCurrentHour("+this.father.pid+");",1e3)},this.updateCurrentHour=function(a){var b=new Date,c=b.getHours(),d=b.getMinutes(),e=b.getSeconds(),f=(c-this.father.hourFrom)*51;f+=d*.83,f=parseInt(f,10),this.hourLine.style.top=f+"px",IEversion===6&&(this.hourLine.style.visibility="visible",this.hourLine.style.display="block"),d<10&&(d="0"+d),e<10&&(e="0"+e),this.hourLine.firstChild.firstChild.data=c+":"+d+":"+e,this.timeOut=setTimeout("calendar_updateCurrentHour("+a+");",1e3)},this.draw=function(){this.hoursBase=document.createElement("div"),this.hoursBase.setAttribute("id",this.father.pid+"_hoursBase"),this.hoursBase.style.position="absolute",this.hoursBase.style.left="0px",this.hoursBase.onselectstart=function(){return!1},IEversion&&IEversion<7?this.hoursBase.style.top="6px":this.hoursBase.style.top="5px",this.hoursBase.style.width=this.father.hourRowWidth+"px",this.hoursBase.style.height="100%",this.fatherNames=document.createElement("dif"),this.fatherNames.setAttribute("id",this.father.pid+"_fatherNames"),this.fatherNames.style.position="absolute",this.fatherNames.style.left=this.father.hourRowWidth+"px",this.fatherNames.style.top="0px",this.fatherNames.style.width="auto",this.fatherNames.style.height="auto",this.fatherDays=document.createElement("dif"),this.fatherDays.setAttribute("id",this.father.pid+"_fatherDays"),this.fatherDays.style.position="absolute",this.fatherDays.style.left="0px",this.fatherDays.style.top="40px",this.fatherDays.style.width="100%",this.fatherDays.style.height=xHeight(this.father.father)+"px",this.fatherDays.style.overflowX="hidden",this.fatherDays.style.overflowY="auto",this.daysBase=document.createElement("div"),this.daysBase.setAttribute("id",this.father.pid+"_daysBase"),this.daysBase.style.position="absolute",this.daysBase.style.left=this.father.hourRowWidth+"px",this.daysBase.style.top="0px",this.daysBase.style.width=this.father.dayRowWidth+"px",this.daysBase.style.height=this.father.contentHeight+"px",IEversion&&(this.daysBase.onselectstart=function(){return!1}),this.dayNames=document.createElement("div"),this.dayNames.setAttribute("id",this.father.pid+"_dayNames"),this.dayNames.style.position="relative",this.dayNames.style.cssFloat="left",this.dayNames.style.styleFloat="left",this.dayNames.style.width="auto",this.dayNames.style.height="20px",IEversion&&(this.dayNames.onselectstart=function(){return!1}),this.dayTodo=document.createElement("div"),this.dayTodo.setAttribute("id",this.father.pid+"_dayTodo"),this.dayTodo.style.position="relative",this.dayTodo.style.cssFloat="left",this.dayTodo.style.styleFloat="left",this.dayTodo.style.width="auto",this.dayTodo.style.height="15px",this.dayTodo.style.border="1px #999 solid",IEversion&&(this.dayTodo.onselectstart=function(){return!1}),this.daysContainer=document.createElement("div"),this.daysContainer.setAttribute("id",this.father.pid+"_daysContent"),this.daysContainer.style.position="relative",this.daysContainer.style.cssFloat="left",this.daysContainer.style.styleFloat="left",this.daysContainer.style.marginTop="5px",this.daysContainer.style.width="100%",this.daysContainer.style.height="auto",this.daysContainer.style.borderLeft="1px #999 solid",this.daysContainer.style.borderRight="1px #999 solid",this.daysContainer.style.borderTop="1px #999 solid",this.daysContainer.style.borderBottom="1px #999 solid",IEversion&&(this.daysContainer.onselectstart=function(){return!1}),this.father.evenType="default",xAddEventListener(this.daysContainer,"mousedown",mouseDown),xAddEventListener(this.daysContainer,"mouseup",mouseUp),this.father.father.appendChild(this.fatherNames),this.father.father.appendChild(this.fatherDays),this.fatherNames.appendChild(this.dayNames),this.draw_dayNames(),this.fatherNames.appendChild(this.dayTodo),this.draw_todos(),this.fatherDays.appendChild(this.daysBase),this.fatherDays.appendChild(this.hoursBase),this.draw_dayHours(),this.daysBase.appendChild(this.daysContainer),this.drawCurrentHour(),IEversion&&IEversion<8?this.draw_bodyDaysIE():this.draw_bodyDays()}}function weekPlanner_calendars(a){this.father=a,this.calendarInfo=[],this.cleanCalendars=function(){var a=document.getElementById(this.father.pid+"_calendarsEntryContainer");a.parentNode.removeChild(a),this.draw()},this.hiddenNotes=function(a){var b,c,d;if(!a.target.num)return!1;b=a.target,c=b.num;if(b.checked===!0)this.calendarInfo[c].show=1,this.father.notes.jsEvent_showCalendarNotes(c);else{if(this.calendarInfo[c].selected===1)return b.checked=!0,!1;this.calendarInfo[c].show=0,this.father.notes.jsEvent_hiddenCalendarNotes(c)}d=eyeParam("showed",b.checked),d+=eyeParam("calendar",c),sendMsg(this.father.checknum,"calendarShow",d)},this.selectCalendar=function(a){var b,c,d,e=this.calendarInfo.length;e>0&&(c=xGetElementById(this.father.pid+"_selectedImg"),c.parentNode.removeChild(c)),d=a.target,d.id==="textContainer"&&(d=d.parentNode),b=d.num,this.genSelectCalendar(!0,d,b)},this.phpSelectCalendar=function(a){var b,c,d=this.calendarInfo.length;d>0&&(c=xGetElementById(this.father.pid+"_selectedImg"),c.parentNode.removeChild(c)),b=document.getElementById(this.father.pid+"_contentName_"+a),this.genSelectCalendar(!1,b,a)},this.genSelectCalendar=function(a,b,c){var d,e,f;this.father.selectedCalendar!=="noCalendar"&&(this.calendarInfo[this.father.selectedCalendar].selected=0),this.calendarInfo[c].selected=1,this.calendarInfo[c].show===0&&(d=document.getElementById(this.father.pid+"_calendarCheck_"+c),d.checked=!0,this.calendarInfo[c].show=1,this.father.notes.jsEvent_showCalendarNotes(c),f=eyeParam("showed",d.checked),f+=eyeParam("calendar",c),sendMsg(this.father.checknum,"calendarShow",f)),this.calendarInfo[c].selected=1,this.father.selectedCalendar=c,e=this.drawSelectRow(),b.appendChild(e),a===!0&&(f=eyeParam("calendar",c),sendMsg(this.father.checknum,"selectCalendar",f))},this.drawSelectRow=function(){var a,b=document.createElement("div");return b.setAttribute("id",this.father.pid+"_selectedImg"),b.style.position="absolute",b.style.height="100%",b.style.right="5px",a=document.createElement("img"),a.src="index.php?theme="+USERTHEME+"&extern=images/apps/eyeCalendar/widget/selected.png",a.setAttribute("id",this.father.pid+"_selectedImg_img"),b.appendChild(a),b},this.drawCalendar=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.father.calendarsFather;this.calendarInfo[b]=[],this.calendarInfo[b].show=c,f=document.createElement("div"),f.setAttribute("id",b+"_contentEntry"),f.style.cssFloat="right",f.style.styleFloat="right",f.style.width=this.father.calendarsFatherWidth-20+"px",f.style.height="15px",f.style.marginTop="5px",f.style.zIndex="999",f.style.cursor="pointer",f.num=b,f.pid=this.father.pid,f.evenType="selectCalendar",e=document.createElement("input"),e.setAttribute("id",this.father.pid+"_calendarCheck_"+b),e.style.position="relative",e.style.cssFloat="left",e.style.styleFloat="left",e.style.marginTop="1px",e.style.marginLeft="0px",e.style.marginRight="0px",e.style.cursor="pointer",e.type="checkBox",e.evenType="viewCalendar",e.noPrevent=!0,e.num=b,e.pid=this.father.pid,c===1&&(e.checked=!0,e.defaultChecked=!0),xAddEventListener(e,"click",mouseClick),g=document.createElement("div"),g.setAttribute("id",this.father.pid+"_contentName_"+b),g.style.position="relative",g.style.cssFloat="left",g.style.styleFloat="left",g.style.marginLeft="5px",g.style.width=this.father.calendarsFatherWidth-48+"px",IEversion&&IEversion<7?g.style.height="16px":g.style.height="100%",g.style.color="white",IEversion&&IEversion<7&&(g.style.marginTop="4px"),g.evenType="selectCalendar",g.pid=this.father.pid,g.num=b,i=document.createElement("div"),i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.backgroundColor="white",i.style.top="0px",i.style.left="0px",g.appendChild(i),i=i.cloneNode(!0),i.style.top="",i.style.bottom="0px",g.appendChild(i),i=i.cloneNode(!0),i.style.left="",i.style.right="0px",g.appendChild(i),i=i.cloneNode(!0),i.style.bottom="",i.style.top="0px",g.appendChild(i),b>5?d=b%5:d=b,g.style.backgroundColor=this.father.calendarSelectColors[d],k=document.createElement("div"),k.setAttribute("id","textContainer"),k.style.cssFloat="left",k.style.styleFloat="left",k.style.marginLeft="4px",k.evenType="selectCalendar",k.pid=this.father.pid,j=document.createTextNode(a),k.appendChild(j),xAddEventListener(k,"click",mouseClick),this.father.selectedCalendar===b?(this.calendarInfo[b].selected=1,h=this.drawSelectRow(),g.appendChild(h)):this.calendarInfo[b].selected=0,g.appendChild(k),f.appendChild(e),f.appendChild(g),xAddEventListener(g,"click",mouseClick),this.infoContainer.appendChild(f)},this.draw=function(){var a,b,c=this.father.calendarsFather,d=document.createElement("div");d.setAttribute("id",this.father.pid+"_calendarsEntryContainer"),d.style.position="absolute",d.style.top="0px",d.style.left="0px",d.style.height="100%",d.style.width="100%",d.style.backgroundColor="white",b=document.createElement("div"),b.style.position="absolute",b.style.top="5px",b.style.left="10px",b.style.width="auto",b.style.height="10px",b.style.color="#6D6D6D",a=document.createTextNode(this.father.calendarsText),b.appendChild(a),d.appendChild(b),this.infoContainer=document.createElement("div"),this.infoContainer.style.position="absolute",this.infoContainer.style.left="3px",this.infoContainer.style.top="26px",this.infoContainer.style.width=this.father.calendarsFatherWidth-14+"px",this.infoContainer.style.height="auto",d.appendChild(this.infoContainer),c.appendChild(d)}}function weekPlanner_close(a){return weekPlanner_instances[a]?(clearTimeout(weekPlanner_instances[a].base.timeOut),IEversion&&IEversion<8?(weekPlanner_instances[a].base.father=null,weekPlanner_instances[a]=null):(delete weekPlanner_instances[a].base.father,delete weekPlanner_instances[a]),!0):!1}function weekPlanner_events(a){this.father=a,this.mouseDown=function(a){var b="";if(this.father&&this.father.evenType){this.father.evenType==="default"?a.target.evenType!=="default"&&a.target.evenType!==""?b=a.target.evenType:b="default":b=this.father.evenType;if(b==="editingEvent"){if(a.target.evenType==="editEvent"||a.target.evenType==="changeEvent"||a.target.evenType==="cancelEvent")return this.father.evenType="default",!0;this.father.notes.jsEvent_cancelEvent(a)}else if(b==="nothingToDo")return this.father.evenType="default",!0}if(a&&a.target&&a.target.id&&a.target.id!==""){if(a.target.id==="noteTitle")return this.father.notes.jsEvent_moveNote(a),!0;if(a.target.id==="noteBottom")return this.father.notes.jsEvent_resizeNote(a),!0}if(b==="moveNote")return this.father.notes.jsEvent_moveNote(a),!0;if(b==="default")return this.father.notes.jsEvent_newNote(a),!0},this.mouseUp=function(a){if(!this.father.tmpNote)return!1;this.father.base.daysContainer.style.cursor="pointer",this.father.tmpNote.noteBody.style.zIndex=3,IEversion&&IEversion<8&&(this.father.tmpNote.style.zIndex=2),this.father.tmpNote.lastPart&&(IEversion&&IEversion<8?this.father.tmpNote.lastPart=null:delete this.father.tmpNote.lastPart),xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver),xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown);if(this.father.evenType==="resizeNote2")this.father.evenType="default",this.father.notes.jsEvent_noteCreated(a);else if(this.father.evenType==="resizeNote")this.father.evenType="default",this.father.notes.jsEvent_noteResized(a);else{if(this.father.evenType!=="moveNote"&&this.father.evenType!=="moveNoteBody")return this.father.evenType="default",!1;this.father.evenType="default",this.father.notes.jsEvent_noteMoved(a)}},this.mouseOver=function(a){var b="";this.father&&this.father.evenType&&this.father.evenType==="default"?a.target.evenType!=="default"&&a.target.evenType!==""?b=a.target.evenType:b="default":b=this.father.evenType,b==="resizeNote"||b==="resizeNote2"?this.father.notes.reCall_resizingNote(a):b==="moveNote"?this.father.notes.reCall_movingNote(a):b==="moveNoteBody"&&this.father.notes.reCall_movingNoteBody(a)},this.mouseClick=function(a){var b="";this.father&&this.father.evenType&&this.father.evenType==="default"||this.father.evenType==="editingEvent"?a.target.evenType!=="default"&&a.target.evenType!==""?b=a.target.evenType:b="default":b=this.father.evenType;if(b==="changeEvent")this.father.notes.jsEvent_setEvent(a);else if(b==="editEvent")this.father.notes.jsEvent_editEvent(a);else if(b==="cancelEvent")this.father.notes.jsEvent_cancelEvent(a);else if(b==="selectCalendar")this.father.calendars.selectCalendar(a);else if(b==="viewCalendar")this.father.calendars.hiddenNotes(a);else if(b==="deleteNote")this.father.notes.jsEvent_deleteNote(a);else if(b==="nothingToDo")return!1},this.keyPress=function(a){var b="";this.father&&this.father.evenType&&this.father.evenType==="default"||this.father.evenType==="editingEvent"?a.target.evenType!=="default"&&a.target.evenType!==""?b=a.target.evenType:b="default":b=this.father.evenType,b==="changeEvent"&&a.keyCode===13&&this.father.notes.jsEvent_setEvent(a)}}function weekPlanner_notes(a){this.father=a,this.notes=[],this.jsEvent_newNote=function(a){var b,c,d,e,f,g,h;if(isNaN(a.target.num))return!1;this.father.evenType="default",b=this.father.selectedCalendar,h=a.target,g=0,g=Math.floor(h.num/this.father.parts),h.num>3?g=h.num-g*this.father.parts:g=h.num,f=h.num,c=this.notes.length,e=this.draw_newNote(f,2,b,c,1,1),this.father.base.daysContainer.style.cursor="s-resize",d=document.getElementById(this.father.pid+"_day_"+h.day),d.appendChild(e),e.parts=2,e.fromParts=h.num,e.startPart=h.num,e.day=h.day,e.startPartObj=xGetElementById(h.day+"_part_"+h.num),this.draw_title(e),this.draw_event(e,this.father.defaultEvenText),IEversion&&IEversion<8?(e.style.zIndex=0,e.noteBody.style.zIndex=0):e.noteBody.style.zIndex=1,this.father.tmpNote=e,this.notes.push(e),e.cid=c,e.calendar=b,e.newFather=d,this.father.evenType="resizeNote2",xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver),xRemoveEventListener(this.father.base.daysContainer,"mousedown",mouseDown)},this.draw_contextualMenu=function(a){var b=[];b.sFather=1,IEversion&&IEversion<8&&(b.mFather=this.father.base.daysContainer.id,b.rFather=this.father.base.daysContainer.id),ContextMenu_show(b,a.cid+"_noteMenu",a.id,20,20,0,0,this.father.checknum,0),addContextEntry(a.cid+"_noteMenu",'<img id="'+a.cid+'_noteMenu_delete" style="height: 16px; width: 16px;" src="index.php?theme='+USERTHEME+'&extern=icons/16x16/delete.png"/> &nbsp;&nbsp;$lang:Delete',a.cid+"_delete","delNote",this.father.checknum,"<id>"+a.cid+"</id><calendar>"+a.calendar+"</calendar>",a.cid+"_noteMenu_delete")},this.jsEvent_deleteNote=function(a){var b,c=a.target.parentNode;c.newFather.delNote(c),b=eyeParam("id",c.cid),b+=eyeParam("calendar",c.calendar),sendMsg(this.father.checknum,"delNote",b)},this.jsEvent_resizeNote=function(a){this.father.tmpNote=a.target.parentNode,this.father.evenType="resizeNote",IEversion&&IEversion<8?(this.father.tmpNote.style.zIndex=0,this.father.tmpNote.noteBody.style.zIndex=0):this.father.tmpNote.noteBody.style.zIndex=1,this.father.base.daysContainer.style.cursor="s-resize",xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver)},this.jsEvent_moveNote=function(a){this.father.tmpNote=a.target.parentNode,a.target.id==="noteTitle"?this.father.evenType="moveNote":this.father.evenType="moveNoteBody",IEversion&&IEversion<8?(this.father.tmpNote.style.zIndex=0,this.father.tmpNote.noteBody.style.zIndex=0):this.father.tmpNote.noteBody.style.zIndex=1,this.father.base.daysContainer.style.cursor="move",xAddEventListener(this.father.base.daysContainer,"mouseover",mouseOver)},this.jsEvent_editEvent=function(a){var b,c,d=a.target.parentNode;d=d.parentNode,this.father.tmpNote=d,c=a.target.firstChild.data,xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver),xRemoveEventListener(this.father.base.daysContainer,"mouseup",mouseUp),b=this.draw_editPopup(d.cid,c),this.father.father.parentNode.appendChild(b),b.inputText.focus(),b.inputText.select()},this.jsEvent_addNoteToPart=function(a){var b,c,d=a.startPart,e=a.parts,f=d+e,g=a.day,h=0;for(c=d;c<f;c+=1)b=xGetElementById(g+"_part_"+c),b.notesInPart.push(a),b.notesInPart.length>h&&(h=b.notesInPart.length);a.style.width=90/h+"%"},this.jsEvent_noteCreated=function(){var a,b,c=this.father.tmpNote;this.draw_contextualMenu(c),c.newFather.addNote(c),b=eyeParam("hourFrom",c.hourFrom),b+=eyeParam("minFrom",c.minFrom),b+=eyeParam("hourEven",c.hourEven),b+=eyeParam("minEven",c.minEven),b+=eyeParam("day",c.day),b+=eyeParam("id",c.cid),b+=eyeParam("calendar",c.calendar),sendMsg(this.father.checknum,"addNote",b),xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver),xRemoveEventListener(this.father.base.daysContainer,"mouseup",mouseUp),a=this.draw_editPopup(c.cid),this.father.father.parentNode.appendChild(a),a.inputText.focus(),a.inputText.select()},this.draw_editBox=function(a){var b=document.createElement("div");return b.setAttribute("id","eventCotnainer"),b.className="eyeCalendar_hover",b.style.position="relative",b.style.paddingLeft="1px",b.style.paddingRight="1px",b.style.width="auto",b.style.height="auto",b.style.color="white",b.style.cursor="pointer",b.evenType="editEvent",b.style.zIndex="999",b.pid=this.father.pid,a=document.createTextNode(a),b.appendChild(a),xAddEventListener(b,"click",mouseClick),b},this.jsEvent_setEvent=function(a){var b,c,d,e,f=this.father.tmpNote.cid,g=document.getElementById(f+"_inputEvent");if(!g)return!1;e=this.draw_editBox(g.value),xAddEventListener(e,"click",mouseClick),this.father.tmpNote.noteBody.firstChild&&this.father.tmpNote.noteBody.removeChild(this.father.tmpNote.noteBody.firstChild),this.father.tmpNote.noteBody.appendChild(e),c=a.target.parentNode,c.parentNode.removeChild(c),b=this.father.tmpNote,d=eyeParam("title",g.value),d+=eyeParam("id",b.cid),d+=eyeParam("calendar",b.calendar),sendMsg(this.father.checknum,"updateTitle",d),this.father.evenType="default",xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown),xAddEventListener(this.father.base.daysContainer,"mouseup",mouseUp)},this.jsEvent_noteResized=function(){var a,b;xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver),a=this.father.tmpNote,b=eyeParam("hourFrom",a.hourFrom),b+=eyeParam("minFrom",a.minFrom),b+=eyeParam("hourEven",a.hourEven),b+=eyeParam("minEven",a.minEven),b+=eyeParam("day",a.day),b+=eyeParam("id",a.cid),b+=eyeParam("calendar",a.calendar),sendMsg(this.father.checknum,"resizeNote",b),this.father.evenType="default"},this.jsEvent_noteMoved=function(){var a,b;xRemoveEventListener(this.father.base.daysContainer,"mouseover",mouseOver),a=this.father.tmpNote,b=eyeParam("hourFrom",a.hourFrom),b+=eyeParam("minFrom",a.minFrom),b+=eyeParam("hourEven",a.hourEven),b+=eyeParam("minEven",a.minEven),b+=eyeParam("day",a.day),b+=eyeParam("id",a.cid),b+=eyeParam("calendar",a.calendar),sendMsg(this.father.checknum,"moveNote",b),this.father.evenType="default"},this.jsEvent_cancelEvent=function(){var a=document.getElementById(this.father.tmpNote.cid+"_popupDiv"),b=a.parentNode;b.removeChild(a),this.father.evenType="default",xAddEventListener(this.father.base.daysContainer,"mousedown",mouseDown),xAddEventListener(this.father.base.daysContainer,"mouseup",mouseUp)},this.jsEvent_hiddenCalendarNotes=function(a){var b,c;for(b=0;b<this.notes.length;b+=1)c=this.notes[b],c.calendar===a&&(c.style.visibility="hidden",c.style.display="none")},this.jsEvent_showCalendarNotes=function(a){var b,c;for(b=0;b<this.notes.length;b+=1)c=this.notes[b],c.calendar===a&&(c.style.visibility="visible",c.style.display="block")},this.reCall_resizingNote=function(a){var b,c;if(!a.target.num)return!1;c=a.target,b=this.father.tmpNote,b.parts!==c.num+1&&c.num>=b.startPart&&(b.parts=b.parts+c.num-b.fromParts,b.fromParts=c.num,this.draw_resizeNote(b),this.draw_title(b))},this.reCall_movingNote=function(a){var b,c,d,e,f;if(isNaN(a.target.num))return!1;f=a.target,b=f.day,this.father.tmpNote.day=b,e=document.getElementById(this.father.pid+"_day_"+b),d=0,d=Math.floor(f.num/this.father.parts),f.num>3?d=f.num-d*this.father.parts:d=f.num,c=f.num+this.father.tmpNote.parts,c-=1;if(c>=this.father.base.totalParts)return!1;this.father.tmpNote.startPart=f.num,this.father.tmpNote.fromParts=f.num+this.father.tmpNote.parts,this.draw_movedNote(e,this.father.tmpNote.startPart),this.draw_title(this.father.tmpNote)},this.reCall_movingNoteBody=function(a){var b,c,d,e,f;if(isNaN(a.target.num))return!1;if(!this.father.tmpNote.lastPart)return this.father.tmpNote.lastPart=a.target,!1;c=a.target.num-this.father.tmpNote.lastPart.num,b=a.target.day,this.father.tmpNote.lastPart=a.target,this.father.tmpNote.startPart+=c,f=document.getElementById(b+"_part_"+this.father.tmpNote.startPart);if(!f||isNaN(f.day))return!1;b=f.day,this.father.tmpNote.day=b,e=document.getElementById(this.father.pid+"_day_"+b),d=0,d=Math.floor(f.num/this.father.parts),f.num>3?d=f.num-d*this.father.parts:d=f.num,this.father.tmpNote.startPart=f.num,this.father.tmpNote.fromParts=f.num+this.father.tmpNote.parts,this.draw_movedNote(e,this.father.tmpNote.startPart),this.draw_title(this.father.tmpNote)},this.phpEvent_newNote=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t;b=parseInt(b,10),o=c-b,p=e-d,s=o*60+p,m=Math.floor(d/15),t=(b-this.father.hourFrom)*4,t+=m,r=Math.floor(s/15),q=this.draw_newNote(t,r,h,f,i,j),l=t+r,q.parts=r,q.fromParts=l,q.startPart=t,q.startPartObj=xGetElementById(a+"_part_"+t),q.day=a,q.cid=f,q.calendar=h,k===1&&this.draw_title(q),g===" "&&(g=this.father.defaultEvenText),this.draw_event(q,g),n=document.getElementById(this.father.pid+"_day_"+a),n.appendChild(q),q.newFather=n,this.draw_contextualMenu(q),this.notes.push(q),n.addNote(q)},this.phpEvent_cleanNotes=function(){var a,b,c;for(a=0;a<this.notes.length;a+=1)b=this.notes[a],c=b.parentNode,c.removeChild(b);this.notes=[]},this.phpEvent_deleteNote=function(a){var b,c;for(b=0;b<this.notes.length;b+=1)c=this.notes[b],c.cid===a&&c.parentNode.removeChild(c)},this.phpEvent_deleteCalendarNotes=function(a){var b,c;for(b=0;b<this.notes.length;b+=1)c=this.notes[b],c.calendar===a&&(c.parentNode.removeChild(c),delete this.notes[b])},this.draw_title=function(a){var b,c,d,e,f,g,h,i=a.firstChild,j=a.parts,k=a.startPart,l=k/4,m=parseInt(l,10);this.father.hourFrom!==0&&(m=parseInt(this.father.hourFrom,10)+m,l+=parseFloat(this.father.hourFrom)),g=l-m,f=g*60,c=j/4,c+=l,b=parseInt(c,10),e=c-b,d=e*60,m<10&&(m="0"+m),b<10&&(b="0"+b),f<10&&(f="0"+f),d<10&&(d="0"+d),i.firstChild?(h=i.firstChild,h.data=m+":"+f+"-"+b+":"+d):(h=document.createTextNode(m+":"+f+"-"+b+":"+d),i.appendChild(h)),a.hourFrom=m,a.hourEven=b,a.minFrom=f,a.minEven=d},this.draw_movedNote=function(a,b){var c,d=this.father.tmpNote,e=this.father.pixelPart;IEversion===6&&(e+=.5),c=b*e,c=Math.floor(c),d.style.top=c+"px",a.appendChild(d)},this.draw_newNote=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;c||(c=1),l=this.father.pixelPart,l*=b,m=this.father.pixelPart,IEversion===6&&(m+=.5,b>2?j=b+3:j=b+2,l+=j),t=a*m,h=l-this.father.pixelPart-2,n=document.createElement("div"),c>5?i=c%5:i=c,g=this.father.noteBodyColors[i],k=this.father.noteHeaderColors[i];if(!this.father.firstTop||this.father.firstTop>t)u=0,u=this.father.pixelPart*7,this.father.firstTop=t-u;return n.setAttribute("id",this.father.pid+"_note_"+d),n.style.position="absolute",n.style.top=t+"px",n.style.left="-1px",n.style.width="100%",n.pid=this.father
.pid,n.style.height=l+"px",IEversion&&IEversion<8&&(n.style.zIndex="2"),n.pid=this.father.pid,r=document.createElement("div"),r.setAttribute("id","noteTitle"),r.style.cursor="move",e!==1&&(r.evenType="nothingToDo",r.style.cursor="default"),r.setAttribute("id","noteTitle"),r.style.backgroundColor=k,r.style.position="absolute",r.style.top="0px",r.style.height=this.father.pixelPart+"px",r.style.width="100%",r.style.borderRight="1px "+k+" solid",r.style.borderLeft="1px "+k+" solid",r.style.zIndex="4",r.style.color="white",r.style.fontSize="80%",r.style.textIndent="4px",r.style.fontWeight="bold",r.style.lineHeight="1.4em",IEversion&&(r.onselectstart=function(){return!1}),n.noteHeader=r,n.appendChild(r),s=document.createElement("div"),s.setAttribute("id","noteRemove"),s.style.position="absolute",s.style.backgroundRepeat="no-repeat",s.style.backgroundImage="url(index.php?theme="+USERTHEME+"&extern=images/apps/eyeCalendar/deleteNote.png)",s.style.top="0px",s.style.right="0px",s.style.height=this.father.pixelPart+"px",s.style.width="10px",s.style.zIndex="4",s.style.cursor="pointer",s.style.color="white",s.evenType="deleteNote",xAddEventListener(s,"click",mouseClick),n.appendChild(s),p=l-this.father.pixelPart,o=document.createElement("div"),o.setAttribute("id","noteBody"),o.style.position="absolute",o.style.top=this.father.pixelPart+"px",o.style.backgroundColor=g,o.style.height=p+"px",o.style.width="100%",o.style.borderRight="1px "+k+" solid",o.style.zIndex="3",o.style.borderLeft="1px "+k+" solid",o.style.borderRight="1px "+k+" solid",f===1?(o.style.cursor="move",o.evenType="moveNote"):(o.evenType="nothingToDo",o.style.cursor="default"),n.noteBody=o,n.appendChild(o),q=document.createElement("div"),q.setAttribute("id","noteBottom"),q.style.cursor="s-resize",e!==1&&(q.evenType="nothingToDo",q.style.cursor="default"),q.style.position="absolute",q.style.bottom="0px",q.style.height="2px",q.style.width="100%",q.style.zIndex="4",q.style.left="1px",q.style.borderBottom="1px "+k+" solid",n.noteBottom=q,n.appendChild(q),this.father.calendars.calendarInfo[c].show===0&&(n.style.visibility="hidden",n.style.display="none"),n},this.draw_resizeNote=function(a){var b,c=this.father.pixelPart;IEversion===6&&(c+=.5),b=a.parts*c,a.style.height=b+"px",a.noteBody.style.height=b-this.father.pixelPart+"px"},this.draw_event=function(a,b){var c=this.draw_editBox(b);a.noteBody.appendChild(c)},this.draw_editPopup=function(a,b){var c,d,e,f=xWidth(this.father.father),g=xHeight(this.father.father),h=g/2-50,i=f/2-100+168,j=document.createElement("div");return j.setAttribute("id",a+"_popupDiv"),j.style.position="absolute",j.style.top=h+"px",j.style.left=i+"px",j.style.height="110px",j.style.width="250px",j.style.backgroundColor="white",j.style.border="1px solid gray",j.style.zIndex="999",e=document.createElement("div"),e.setAttribute("id","inputText"),e.style.marginLeft="15px",e.style.marginTop="10px",e.innerHTML="$lang:Text for this event:",d=document.createElement("input"),d.setAttribute("id",a+"_inputEvent"),d.type="text",b&&(d.value=b),d.className="eyeTextbox",d.style.width="220px",d.style.marginLeft="15px",d.style.marginTop="10px",d.evenType="changeEvent",d.noPrevent=!0,d.pid=this.father.pid,xAddEventListener(d,"keypress",keyPress),j.appendChild(e),j.appendChild(d),j.inputText=d,c=document.createElement("button"),c.setAttribute("id","buttonEvent"),c.className="eyeButtonClass",c.style.position="absolute",c.style.width="70px",c.style.bottom="15px",c.style.right="15px",c.innerHTML="$lang:Accept",c.pid=this.father.pid,c.evenType="changeEvent",xAddEventListener(c,"click",mouseClick),j.appendChild(c),c=document.createElement("button"),c.setAttribute("id","buttonEvent"),c.className="eyeButtonClass",c.style.position="absolute",c.style.width="70px",c.style.bottom="15px",c.style.right="100px",c.innerHTML="$lang:Cancel",c.pid=this.father.pid,c.evenType="cancelEvent",xAddEventListener(c,"click",mouseClick),j.appendChild(c),this.father.evenType="editingEvent",j}}function weekPlanner_class(a,b,c,d,e,f,g,h){var i,j,k,l;this.pid=a.pid,this.checknum=h,this.dayFrom=a.dayFrom,this.dayEven=a.dayEven,this.hourFrom=a.hourFrom,this.hourEven=a.hourEven,this.hourRowWidth=a.hourWidth,this.dayRowWidth=a.width,this.rowHeight=a.rowHeight,this.parts=a.parts,this.weekDays=getArrayArg(a.weekDays),this.startMonday=a.startMonday,this.selectedCalendar=a.selectedCalendar,this.defaultEvenText=a.defaultEvenText,this.calendarsText=a.calendarsText,this.father=xGetElementById(c),this.plannerWidth=xWidth(this.father),this.numDays=this.dayEven-this.dayFrom,i=xHeight(this.father),j=this.hourEven-this.hourFrom+1,l=this.rowHeight*j,l<i&&(this.rowHeight=i/j),IEversion===7?this.pixelPart=(this.rowHeight-1)/this.parts:this.pixelPart=(this.rowHeight+1)/this.parts,this.calendarsFather=xGetElementById(this.pid+"_calendarsContainer_Container"),this.calendarsFatherWidth=xWidth(this.calendarsFather),IEversion===6?this.rowHeight+=2:IEversion===7&&(this.rowHeight-=2),this.noteHeaderColors=["#AB3F19","#136DBB","#2E8200","#504A76","#AB3F19","#7F405C"],this.noteBodyColors=["#E46F46","#37A3FF","#6FBA32","#8074C9","#F19A2A","#E26299"],this.calendarSelectColors=["#E46F46","#37A3FF","#6FBA32","#8074C9","#F19A2A","#E26299"],this.contentHeight=this.rowHeight*(this.hourEven-this.hourFrom+1)+25,k=this.numDays-1+.2,this.rowWidth=(this.dayRowWidth-k)/this.numDays,this.calendars=new weekPlanner_calendars(this),this.events=new weekPlanner_events(this),this.base=new weekPlanner_base(this),this.notes=new weekPlanner_notes(this),this.calendars.draw(),this.base.draw(),this.resizeDays=a.resizeDays}function weekPlanner_show(a,b,c,d,e,f,g,h,i){var j=a.pid;weekPlanner_instances[j]=new weekPlanner_class(a,b,c,d,e,f,g,h,i)}function onResizeEyeCalendar(a){weekPlanner_instances[a].resizeDays()}function onAddCalendar(a,b,c,d){weekPlanner_instances[a].calendars.drawCalendar(b,c,d)}function onAddNoteCalendar(a,b,c,d,e,f,g,h,i,j,k,l){weekPlanner_instances[a].notes.phpEvent_newNote(b,c,d,e,f,g,h,i,j,k,l)}function onChangeDateCalendar(a,b,c,d){weekPlanner_instances[a].base.changeDate(b,c,d)}function onCleanCalendars(a){weekPlanner_instances[a].calendars.cleanCalendars()}function onCleanNotesCalendar(a){weekPlanner_instances[a].notes.phpEvent_cleanNotes()}function onDeleteCalendarNotes(a,b){weekPlanner_instances[a].notes.phpEvent_deleteCalendarNotes(b)}function onDeleteNote(a,b){weekPlanner_instances[a].notes.phpEvent_deleteNote(b)}function onGoToFirstNote(a){weekPlanner_instances[a].base.goToFirstNote()}function onHiddenNotesCalendar(a,b){weekPlanner_instances[a].notes.jsEvent_hiddenCalendarNotes(b)}function onSelectCalendar(a,b){weekPlanner_instances[a].calendars.phpSelectCalendar(b)}function onShowNotesCalendar(a,b){weekPlanner_instances[a].notes.jsEvent_showCalendarNotes(b)}function init_calendar(){sendMsg(eyeCalendarChecknum,"Launch","")}var weekPlanner_instances=[];init_calendar();